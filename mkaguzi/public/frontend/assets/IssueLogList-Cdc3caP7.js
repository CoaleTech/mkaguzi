var G=Object.defineProperty;var z=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var N=(m,r,o)=>r in m?G(m,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):m[r]=o,R=(m,r)=>{for(var o in r||(r={}))J.call(r,o)&&N(m,o,r[o]);if(z)for(var o of z(r))K.call(r,o)&&N(m,o,r[o]);return m};var k=(m,r,o)=>new Promise((h,w)=>{var u=d=>{try{x(o.next(d))}catch(c){w(c)}},f=d=>{try{x(o.throw(d))}catch(c){w(c)}},x=d=>d.done?h(d.value):Promise.resolve(d.value).then(u,f);x((o=o.apply(m,r)).next())});import{ab as W,r as P,j as C,Q as X,l as p,p as g,q as t,s as i,u as b,v as n,z as v,ac as S,ao as L,am as D,F as U,x as $,A as a,ah as Y,aq as Z,H as _,y as ee,B as te}from"./vue-DciwFjI_.js";import{p as se,a as I,c as T}from"./index-qIC3Tfxg.js";import{$ as oe,N as ae,T as le,as as ne,b5 as ie,v as re,O as de,d as ue,n as ge}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const pe={class:"p-6"},ve={class:"flex justify-between items-center mb-6"},me={class:"flex gap-2"},ce={class:"bg-white rounded-lg border p-4 mb-6"},fe={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},xe=["value"],be={class:"flex items-end"},ye={class:"flex items-center gap-2"},_e={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},he={class:"bg-white rounded-lg border p-4"},we={class:"text-2xl font-bold"},ke={class:"bg-white rounded-lg border p-4"},Ce={class:"text-2xl font-bold text-yellow-600"},Se={class:"bg-white rounded-lg border p-4"},Ie={class:"text-2xl font-bold text-blue-600"},Pe={class:"bg-white rounded-lg border p-4"},Le={class:"text-2xl font-bold text-red-600"},Te={class:"bg-white rounded-lg border p-4"},Ae={class:"text-2xl font-bold text-green-600"},Ve={class:"bg-white rounded-lg border shadow-sm"},Be={key:0,class:"divide-y divide-gray-200"},Me=["onClick"],Oe={class:"flex items-start justify-between"},ze={class:"flex-1"},Ne={class:"flex items-center gap-3 mb-2"},Re={class:"font-medium text-gray-900"},De={class:"text-sm text-gray-600 mb-2"},Ue={class:"flex items-center gap-6 text-sm text-gray-500"},$e={class:"flex items-center gap-1"},je={key:0,class:"flex items-center gap-1"},Fe={key:1,class:"flex items-center gap-1"},He={class:"flex items-center gap-6 mt-3 text-sm"},qe={key:0,class:"flex items-center gap-1 text-gray-700"},Ee={key:1,class:"flex items-center gap-1 text-gray-500"},Qe={class:"flex items-center gap-1 text-gray-500"},Ge={class:"text-right"},Je={key:1,class:"p-12 text-center text-gray-500"},Ke={key:2,class:"px-4 py-3 border-t flex items-center justify-between"},We={class:"text-sm text-gray-500"},Xe={class:"flex gap-2"},lt={__name:"IssueLogList",setup(m){const r=W(),o=se(),h=P(!1),w=P(!1),u=P({status:"",priority:"",issue_type:"",assigned_to:""}),f=C(()=>o.issues),x=C(()=>o.issuesTotalCount),d=C(()=>o.issuesPage),c=C(()=>o.issuesPageSize),A=C(()=>Math.ceil(x.value/c.value));X(()=>k(this,null,function*(){yield y()}));function y(){return k(this,null,function*(){h.value=!0;try{const l=R({},u.value);Object.keys(l).forEach(e=>{l[e]||delete l[e]}),yield o.loadIssues(l,d.value,c.value)}finally{h.value=!1}})}function j(){return k(this,null,function*(){u.value={status:"",priority:"",issue_type:"",assigned_to:""},w.value=!1,yield y()})}let V=null;function F(){clearTimeout(V),V=setTimeout(()=>y(),300)}function B(l){return k(this,null,function*(){yield o.loadIssues(u.value,l,c.value)})}function M(){r.push("/inventory-audit/issues/new")}function H(l){r.push(`/inventory-audit/issues/${l}`)}function q(l){return{Open:"yellow","In Progress":"blue",Resolved:"green",Closed:"gray"}[l]||"gray"}function E(l){return{Critical:"red",High:"orange",Medium:"yellow",Low:"blue"}[l]||"gray"}function Q(l){return l.is_sla_breached?"text-red-600":"text-gray-900"}function O(l){return l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}return(l,e)=>(g(),p("div",pe,[t("div",ve,[e[8]||(e[8]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"Stock Take Issue Log"),t("p",{class:"text-gray-600"},"Track and resolve operational issues during audits")],-1)),t("div",me,[i(n(I),{onClick:j,loading:h.value,variant:"outline",size:"sm"},{default:b(()=>[i(n(oe),{class:"w-4 h-4"})]),_:1},8,["loading"]),i(n(I),{onClick:M},{default:b(()=>[i(n(ae),{class:"w-4 h-4 mr-2"}),e[7]||(e[7]=v(" Log Issue ",-1))]),_:1})])]),t("div",ce,[t("div",fe,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),S(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:y},[...e[9]||(e[9]=[D('<option value="">All Statuses</option><option value="Open">Open</option><option value="In Progress">In Progress</option><option value="Resolved">Resolved</option><option value="Closed">Closed</option>',5)])],544),[[L,u.value.status]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),S(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>u.value.priority=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:y},[...e[11]||(e[11]=[D('<option value="">All Priorities</option><option value="Critical">Critical</option><option value="High">High</option><option value="Medium">Medium</option><option value="Low">Low</option>',5)])],544),[[L,u.value.priority]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Issue Type",-1)),S(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>u.value.issue_type=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:y},[e[13]||(e[13]=t("option",{value:""},"All Types",-1)),(g(!0),p(U,null,$(n(o).issueTypeOptions,s=>(g(),p("option",{key:s.value,value:s.value},a(s.label),9,xe))),128))],544),[[L,u.value.issue_type]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assigned To",-1)),S(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>u.value.assigned_to=s),type:"text",placeholder:"Filter by assignee",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onInput:F},null,544),[[Y,u.value.assigned_to]])]),t("div",be,[t("label",ye,[S(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=s=>w.value=s),onChange:y,class:"rounded border-gray-300"},null,544),[[Z,w.value]]),e[16]||(e[16]=t("span",{class:"text-sm text-gray-700"},"SLA Breached Only",-1))])])])]),t("div",_e,[t("div",he,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-500"},"Total Issues",-1)),t("p",we,a(x.value),1)]),t("div",ke,[e[18]||(e[18]=t("p",{class:"text-sm text-gray-500"},"Open",-1)),t("p",Ce,a(f.value.filter(s=>s.status==="Open").length),1)]),t("div",Se,[e[19]||(e[19]=t("p",{class:"text-sm text-gray-500"},"In Progress",-1)),t("p",Ie,a(f.value.filter(s=>s.status==="In Progress").length),1)]),t("div",Pe,[e[20]||(e[20]=t("p",{class:"text-sm text-gray-500"},"SLA Breached",-1)),t("p",Le,a(f.value.filter(s=>s.is_sla_breached).length),1)]),t("div",Te,[e[21]||(e[21]=t("p",{class:"text-sm text-gray-500"},"Resolved",-1)),t("p",Ae,a(f.value.filter(s=>s.status==="Resolved").length),1)])]),t("div",Ve,[f.value.length>0?(g(),p("div",Be,[(g(!0),p(U,null,$(f.value,s=>(g(),p("div",{key:s.name,class:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:Ye=>H(s.name)},[t("div",Oe,[t("div",ze,[t("div",Ne,[t("h4",Re,a(s.issue_title),1),i(n(T),{variant:q(s.status)},{default:b(()=>[v(a(s.status),1)]),_:2},1032,["variant"]),i(n(T),{variant:E(s.priority)},{default:b(()=>[v(a(s.priority),1)]),_:2},1032,["variant"]),s.is_sla_breached?(g(),ee(n(T),{key:0,variant:"red"},{default:b(()=>[i(n(le),{class:"w-3 h-3 mr-1"}),e[22]||(e[22]=v(" SLA Breached ",-1))]),_:1})):_("",!0)]),t("p",De,a(s.issue_id),1),t("div",Ue,[t("span",$e,[i(n(ne),{class:"w-4 h-4"}),v(" "+a(s.issue_type),1)]),s.warehouse?(g(),p("span",je,[i(n(ie),{class:"w-4 h-4"}),v(" "+a(s.warehouse),1)])):_("",!0),s.item_code?(g(),p("span",Fe,[i(n(re),{class:"w-4 h-4"}),v(" "+a(s.item_code),1)])):_("",!0)]),t("div",He,[s.assigned_to?(g(),p("span",qe,[i(n(de),{class:"w-4 h-4"}),e[23]||(e[23]=v(" Assigned: ",-1)),t("strong",null,a(s.assigned_to),1)])):_("",!0),s.reported_by?(g(),p("span",Ee," Reported by: "+a(s.reported_by),1)):_("",!0),t("span",Qe,[i(n(ue),{class:"w-4 h-4"}),v(" "+a(O(s.reported_date)),1)])])]),t("div",Ge,[e[24]||(e[24]=t("p",{class:"text-sm text-gray-500"},"SLA Due",-1)),t("p",{class:te(["font-medium",Q(s)])},a(O(s.sla_due_date)),3)])])],8,Me))),128))])):h.value?_("",!0):(g(),p("div",Je,[i(n(ge),{class:"w-12 h-12 mx-auto mb-3 text-green-300"}),e[26]||(e[26]=t("p",null,"No issues logged",-1)),i(n(I),{variant:"outline",size:"sm",class:"mt-2",onClick:M},{default:b(()=>[...e[25]||(e[25]=[v(" Log First Issue ",-1)])]),_:1})])),A.value>1?(g(),p("div",Ke,[t("p",We," Showing "+a((d.value-1)*c.value+1)+" - "+a(Math.min(d.value*c.value,x.value))+" of "+a(x.value),1),t("div",Xe,[i(n(I),{variant:"outline",size:"sm",disabled:d.value===1,onClick:e[5]||(e[5]=s=>B(d.value-1))},{default:b(()=>[...e[27]||(e[27]=[v(" Previous ",-1)])]),_:1},8,["disabled"]),i(n(I),{variant:"outline",size:"sm",disabled:d.value===A.value,onClick:e[6]||(e[6]=s=>B(d.value+1))},{default:b(()=>[...e[28]||(e[28]=[v(" Next ",-1)])]),_:1},8,["disabled"])])])):_("",!0)])]))}};export{lt as default};
//# sourceMappingURL=IssueLogList-Cdc3caP7.js.map
