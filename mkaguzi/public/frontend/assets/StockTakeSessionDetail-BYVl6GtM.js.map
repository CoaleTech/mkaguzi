{"version":3,"file":"StockTakeSessionDetail-BYVl6GtM.js","sources":["../../../../frontend/src/components/inventory-audit/SignoffSection.vue","../../../../frontend/src/pages/inventory/StockTakeSessionDetail.vue"],"sourcesContent":["<template>\n  <div class=\"signoff-section\">\n    <h4 class=\"text-sm font-medium text-gray-700 mb-3\">{{ title || 'Signoff Status' }}</h4>\n    \n    <div class=\"space-y-3\">\n      <!-- Team Signoff -->\n      <div \n        class=\"flex items-center justify-between p-3 rounded-lg border\"\n        :class=\"getSignoffClass('team')\"\n      >\n        <div class=\"flex items-center gap-3\">\n          <div \n            class=\"w-8 h-8 rounded-full flex items-center justify-center\"\n            :class=\"signoffs.team_signoff ? 'bg-green-100' : 'bg-gray-100'\"\n          >\n            <CheckCircle v-if=\"signoffs.team_signoff\" class=\"w-5 h-5 text-green-600\" />\n            <Circle v-else class=\"w-5 h-5 text-gray-400\" />\n          </div>\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Team Lead</p>\n            <p v-if=\"signoffs.team_signoff\" class=\"text-xs text-gray-500\">\n              {{ signoffs.team_signoff_by_name || signoffs.team_signoff_by }} • {{ formatDate(signoffs.team_signoff_date) }}\n            </p>\n            <p v-else class=\"text-xs text-gray-400\">Pending</p>\n          </div>\n        </div>\n        <Button\n          v-if=\"!signoffs.team_signoff && !readonly && canSignoff('team')\"\n          size=\"sm\"\n          variant=\"outline\"\n          @click=\"$emit('signoff', 'team')\"\n          :loading=\"signingOff === 'team'\"\n        >\n          Sign Off\n        </Button>\n      </div>\n\n      <!-- Supervisor Signoff -->\n      <div \n        class=\"flex items-center justify-between p-3 rounded-lg border\"\n        :class=\"getSignoffClass('supervisor')\"\n      >\n        <div class=\"flex items-center gap-3\">\n          <div \n            class=\"w-8 h-8 rounded-full flex items-center justify-center\"\n            :class=\"signoffs.supervisor_signoff ? 'bg-green-100' : 'bg-gray-100'\"\n          >\n            <CheckCircle v-if=\"signoffs.supervisor_signoff\" class=\"w-5 h-5 text-green-600\" />\n            <Circle v-else class=\"w-5 h-5 text-gray-400\" />\n          </div>\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Supervisor</p>\n            <p v-if=\"signoffs.supervisor_signoff\" class=\"text-xs text-gray-500\">\n              {{ signoffs.supervisor_signoff_by_name || signoffs.supervisor_signoff_by }} • {{ formatDate(signoffs.supervisor_signoff_date) }}\n            </p>\n            <p v-else class=\"text-xs text-gray-400\">\n              {{ signoffs.team_signoff ? 'Pending' : 'Awaiting Team Signoff' }}\n            </p>\n          </div>\n        </div>\n        <Button\n          v-if=\"!signoffs.supervisor_signoff && signoffs.team_signoff && !readonly && canSignoff('supervisor')\"\n          size=\"sm\"\n          variant=\"outline\"\n          @click=\"$emit('signoff', 'supervisor')\"\n          :loading=\"signingOff === 'supervisor'\"\n        >\n          Sign Off\n        </Button>\n      </div>\n\n      <!-- Auditor Signoff -->\n      <div \n        class=\"flex items-center justify-between p-3 rounded-lg border\"\n        :class=\"getSignoffClass('auditor')\"\n      >\n        <div class=\"flex items-center gap-3\">\n          <div \n            class=\"w-8 h-8 rounded-full flex items-center justify-center\"\n            :class=\"signoffs.auditor_signoff ? 'bg-green-100' : 'bg-gray-100'\"\n          >\n            <CheckCircle v-if=\"signoffs.auditor_signoff\" class=\"w-5 h-5 text-green-600\" />\n            <Circle v-else class=\"w-5 h-5 text-gray-400\" />\n          </div>\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Auditor</p>\n            <p v-if=\"signoffs.auditor_signoff\" class=\"text-xs text-gray-500\">\n              {{ signoffs.auditor_signoff_by_name || signoffs.auditor_signoff_by }} • {{ formatDate(signoffs.auditor_signoff_date) }}\n            </p>\n            <p v-else class=\"text-xs text-gray-400\">\n              {{ signoffs.supervisor_signoff ? 'Pending' : 'Awaiting Supervisor Signoff' }}\n            </p>\n          </div>\n        </div>\n        <Button\n          v-if=\"!signoffs.auditor_signoff && signoffs.supervisor_signoff && !readonly && canSignoff('auditor')\"\n          size=\"sm\"\n          variant=\"outline\"\n          @click=\"$emit('signoff', 'auditor')\"\n          :loading=\"signingOff === 'auditor'\"\n        >\n          Sign Off\n        </Button>\n      </div>\n    </div>\n\n    <!-- Progress indicator -->\n    <div class=\"mt-4\">\n      <div class=\"flex items-center justify-between text-xs text-gray-500 mb-1\">\n        <span>Signoff Progress</span>\n        <span>{{ completedCount }}/3</span>\n      </div>\n      <div class=\"w-full bg-gray-200 rounded-full h-2\">\n        <div \n          class=\"h-2 rounded-full transition-all duration-300\"\n          :class=\"progressBarClass\"\n          :style=\"{ width: `${(completedCount / 3) * 100}%` }\"\n        ></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { Button } from \"frappe-ui\"\nimport { CheckCircle, Circle } from \"lucide-vue-next\"\nimport { computed } from \"vue\"\n\nconst props = defineProps({\n\tsignoffs: {\n\t\ttype: Object,\n\t\trequired: true,\n\t\tdefault: () => ({\n\t\t\tteam_signoff: false,\n\t\t\tteam_signoff_by: null,\n\t\t\tteam_signoff_date: null,\n\t\t\tsupervisor_signoff: false,\n\t\t\tsupervisor_signoff_by: null,\n\t\t\tsupervisor_signoff_date: null,\n\t\t\tauditor_signoff: false,\n\t\t\tauditor_signoff_by: null,\n\t\t\tauditor_signoff_date: null,\n\t\t}),\n\t},\n\treadonly: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\ttitle: {\n\t\ttype: String,\n\t\tdefault: \"Signoff Status\",\n\t},\n\tsigningOff: {\n\t\ttype: String,\n\t\tdefault: null,\n\t},\n\tuserRoles: {\n\t\ttype: Array,\n\t\tdefault: () => [],\n\t},\n})\n\ndefineEmits([\"signoff\"])\n\nconst completedCount = computed(() => {\n\tlet count = 0\n\tif (props.signoffs.team_signoff) count++\n\tif (props.signoffs.supervisor_signoff) count++\n\tif (props.signoffs.auditor_signoff) count++\n\treturn count\n})\n\nconst progressBarClass = computed(() => {\n\tif (completedCount.value === 3) return \"bg-green-500\"\n\tif (completedCount.value >= 1) return \"bg-yellow-500\"\n\treturn \"bg-gray-300\"\n})\n\nfunction getSignoffClass(role) {\n\tconst signoff = props.signoffs[`${role}_signoff`]\n\tif (signoff) return \"border-green-200 bg-green-50\"\n\n\t// Check if this is the next pending signoff\n\tif (role === \"team\" && !props.signoffs.team_signoff)\n\t\treturn \"border-yellow-200 bg-yellow-50\"\n\tif (\n\t\trole === \"supervisor\" &&\n\t\tprops.signoffs.team_signoff &&\n\t\t!props.signoffs.supervisor_signoff\n\t)\n\t\treturn \"border-yellow-200 bg-yellow-50\"\n\tif (\n\t\trole === \"auditor\" &&\n\t\tprops.signoffs.supervisor_signoff &&\n\t\t!props.signoffs.auditor_signoff\n\t)\n\t\treturn \"border-yellow-200 bg-yellow-50\"\n\n\treturn \"border-gray-200 bg-gray-50\"\n}\n\nfunction canSignoff(role) {\n\t// Check user roles - this can be customized based on your role structure\n\tif (role === \"team\") {\n\t\treturn (\n\t\t\tprops.userRoles.includes(\"Counter\") ||\n\t\t\tprops.userRoles.includes(\"Team Lead\") ||\n\t\t\tprops.userRoles.includes(\"System Manager\")\n\t\t)\n\t}\n\tif (role === \"supervisor\") {\n\t\treturn (\n\t\t\tprops.userRoles.includes(\"Supervisor\") ||\n\t\t\tprops.userRoles.includes(\"System Manager\")\n\t\t)\n\t}\n\tif (role === \"auditor\") {\n\t\treturn (\n\t\t\tprops.userRoles.includes(\"Internal Auditor\") ||\n\t\t\tprops.userRoles.includes(\"Auditor\") ||\n\t\t\tprops.userRoles.includes(\"System Manager\")\n\t\t)\n\t}\n\treturn false\n}\n\nfunction formatDate(date) {\n\tif (!date) return \"\"\n\treturn new Date(date).toLocaleDateString(\"en-US\", {\n\t\tmonth: \"short\",\n\t\tday: \"numeric\",\n\t\thour: \"2-digit\",\n\t\tminute: \"2-digit\",\n\t})\n}\n</script>\n\n<style scoped>\n.signoff-section {\n  @apply bg-white rounded-lg p-4;\n}\n</style>\n","<template>\n  <div class=\"p-6\">\n    <!-- Header -->\n    <div class=\"flex items-center justify-between mb-6\">\n      <div class=\"flex items-center gap-4\">\n        <Button variant=\"ghost\" @click=\"goBack\">\n          <ArrowLeft class=\"w-5 h-5\" />\n        </Button>\n        <div>\n          <h1 class=\"text-2xl font-bold text-gray-900\">{{ session?.session_name || session?.name || 'Loading...' }}</h1>\n          <p class=\"text-gray-500 mt-1\">Stock Take Session</p>\n        </div>\n      </div>\n      <div class=\"flex items-center gap-2\">\n        <Badge :variant=\"statusVariant\">{{ session?.status }}</Badge>\n        <Button variant=\"outline\" @click=\"editSession\">\n          <Edit class=\"w-4 h-4 mr-2\" />\n          Edit\n        </Button>\n        <Button variant=\"solid\" @click=\"startCount\" v-if=\"session?.status === 'Scheduled'\">\n          <Play class=\"w-4 h-4 mr-2\" />\n          Start Counting\n        </Button>\n        <Button variant=\"solid\" @click=\"submitForReview\" v-if=\"session?.status === 'In Progress'\">\n          <CheckCircle class=\"w-4 h-4 mr-2\" />\n          Submit for Review\n        </Button>\n      </div>\n    </div>\n\n    <div v-if=\"loading\" class=\"flex items-center justify-center py-20\">\n      <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n    </div>\n\n    <div v-else-if=\"session\" class=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n      <!-- Main Content -->\n      <div class=\"lg:col-span-2 space-y-6\">\n        <!-- Session Overview -->\n        <div class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Session Overview</h3>\n          <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <div>\n              <span class=\"text-sm text-gray-500\">Session Type</span>\n              <p class=\"font-medium\">{{ session.session_type }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Warehouse</span>\n              <p class=\"font-medium\">{{ session.warehouse || '-' }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Zone</span>\n              <p class=\"font-medium\">{{ session.zone || '-' }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Bin Location</span>\n              <p class=\"font-medium\">{{ session.bin_location || '-' }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Scheduled Date</span>\n              <p class=\"font-medium\">{{ formatDate(session.scheduled_date) }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Assigned Counters</span>\n              <p class=\"font-medium\">{{ session.assigned_counters || '-' }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Total Items</span>\n              <p class=\"font-medium\">{{ totalItems }}</p>\n            </div>\n            <div>\n              <span class=\"text-sm text-gray-500\">Items Counted</span>\n              <p class=\"font-medium text-green-600\">{{ countedItems }}</p>\n            </div>\n          </div>\n        </div>\n\n        <!-- Linked Audit Plan -->\n        <div v-if=\"session.audit_plan\" class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Linked Audit Plan</h3>\n          <div class=\"flex items-center justify-between\">\n            <div class=\"flex items-center gap-3\">\n              <div class=\"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center\">\n                <ClipboardList class=\"w-5 h-5 text-blue-600\" />\n              </div>\n              <div>\n                <p class=\"font-medium\">{{ session.audit_plan }}</p>\n                <p class=\"text-sm text-gray-500\">Inventory Audit Plan</p>\n              </div>\n            </div>\n            <Button variant=\"outline\" size=\"sm\" @click=\"viewAuditPlan\">\n              <ExternalLink class=\"w-4 h-4 mr-1\" />\n              View Plan\n            </Button>\n          </div>\n        </div>\n\n        <!-- Count Items Table -->\n        <div class=\"bg-white rounded-lg border p-6\">\n          <PhysicalCountTable\n            v-model=\"session.count_items\"\n            :readonly=\"session.status === 'Completed' || session.status === 'Approved'\"\n            @update:modelValue=\"handleCountItemsUpdate\"\n          />\n        </div>\n\n        <!-- Variance Summary -->\n        <div v-if=\"varianceStats.totalVariances > 0\" class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Variance Summary</h3>\n          <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <div class=\"p-4 bg-yellow-50 rounded-lg border border-yellow-200\">\n              <div class=\"flex items-center gap-2 mb-2\">\n                <AlertTriangle class=\"w-5 h-5 text-yellow-600\" />\n                <span class=\"text-sm text-yellow-700\">Total Variances</span>\n              </div>\n              <p class=\"text-2xl font-bold text-yellow-700\">{{ varianceStats.totalVariances }}</p>\n            </div>\n            <div class=\"p-4 bg-red-50 rounded-lg border border-red-200\">\n              <div class=\"flex items-center gap-2 mb-2\">\n                <TrendingDown class=\"w-5 h-5 text-red-600\" />\n                <span class=\"text-sm text-red-700\">Shortages</span>\n              </div>\n              <p class=\"text-2xl font-bold text-red-700\">{{ varianceStats.shortages }}</p>\n            </div>\n            <div class=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n              <div class=\"flex items-center gap-2 mb-2\">\n                <TrendingUp class=\"w-5 h-5 text-green-600\" />\n                <span class=\"text-sm text-green-700\">Overages</span>\n              </div>\n              <p class=\"text-2xl font-bold text-green-700\">{{ varianceStats.overages }}</p>\n            </div>\n            <div class=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n              <div class=\"flex items-center gap-2 mb-2\">\n                <DollarSign class=\"w-5 h-5 text-purple-600\" />\n                <span class=\"text-sm text-purple-700\">Net Variance Value</span>\n              </div>\n              <p class=\"text-2xl font-bold text-purple-700\">\n                {{ formatCurrency(varianceStats.netVarianceValue) }}\n              </p>\n            </div>\n          </div>\n\n          <!-- Material Variances Alert -->\n          <div v-if=\"varianceStats.materialVariances > 0\" class=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n            <div class=\"flex items-start gap-3\">\n              <AlertCircle class=\"w-5 h-5 text-red-600 mt-0.5\" />\n              <div>\n                <p class=\"font-medium text-red-800\">\n                  {{ varianceStats.materialVariances }} Material Variance(s) Detected\n                </p>\n                <p class=\"text-sm text-red-600 mt-1\">\n                  These variances exceed the materiality thresholds and require investigation.\n                </p>\n                <Button variant=\"outline\" size=\"sm\" class=\"mt-2\" @click=\"createVarianceCases\">\n                  Create Variance Cases\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Signoff Section -->\n        <div class=\"bg-white rounded-lg border p-6\">\n          <SignoffSection\n            :teamSignoff=\"session.team_signoff\"\n            :teamSignoffDate=\"session.team_signoff_date\"\n            :supervisorSignoff=\"session.supervisor_signoff\"\n            :supervisorSignoffDate=\"session.supervisor_signoff_date\"\n            :auditorSignoff=\"session.auditor_signoff\"\n            :auditorSignoffDate=\"session.auditor_signoff_date\"\n            :readonly=\"session.status === 'Approved'\"\n            @signoff=\"handleSignoff\"\n          />\n        </div>\n      </div>\n\n      <!-- Sidebar -->\n      <div class=\"space-y-6\">\n        <!-- Quick Stats -->\n        <div class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Quick Stats</h3>\n          <div class=\"space-y-4\">\n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-gray-500\">Progress</span>\n              <span class=\"font-medium\">{{ progressPercent }}%</span>\n            </div>\n            <div class=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                class=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                :style=\"{ width: `${progressPercent}%` }\"\n              ></div>\n            </div>\n            <div class=\"pt-2 space-y-3\">\n              <div class=\"flex items-center justify-between\">\n                <span class=\"text-gray-500\">Items with Issues</span>\n                <span class=\"font-medium text-yellow-600\">{{ itemsWithIssues }}</span>\n              </div>\n              <div class=\"flex items-center justify-between\">\n                <span class=\"text-gray-500\">Accuracy Rate</span>\n                <span class=\"font-medium text-green-600\">{{ accuracyRate }}%</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Session Timeline -->\n        <div class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Timeline</h3>\n          <div class=\"space-y-4\">\n            <div class=\"flex gap-3\">\n              <div class=\"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0\">\n                <Calendar class=\"w-4 h-4 text-blue-600\" />\n              </div>\n              <div>\n                <p class=\"font-medium\">Scheduled</p>\n                <p class=\"text-sm text-gray-500\">{{ formatDate(session.scheduled_date) }}</p>\n              </div>\n            </div>\n            <div v-if=\"session.start_time\" class=\"flex gap-3\">\n              <div class=\"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0\">\n                <Play class=\"w-4 h-4 text-green-600\" />\n              </div>\n              <div>\n                <p class=\"font-medium\">Started</p>\n                <p class=\"text-sm text-gray-500\">{{ formatDateTime(session.start_time) }}</p>\n              </div>\n            </div>\n            <div v-if=\"session.end_time\" class=\"flex gap-3\">\n              <div class=\"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0\">\n                <CheckCircle class=\"w-4 h-4 text-purple-600\" />\n              </div>\n              <div>\n                <p class=\"font-medium\">Completed</p>\n                <p class=\"text-sm text-gray-500\">{{ formatDateTime(session.end_time) }}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Related Variance Cases -->\n        <div v-if=\"varianceCases.length > 0\" class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Variance Cases</h3>\n          <div class=\"space-y-3\">\n            <div \n              v-for=\"vc in varianceCases\" \n              :key=\"vc.name\"\n              class=\"p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100\"\n              @click=\"viewVarianceCase(vc.name)\"\n            >\n              <div class=\"flex items-center justify-between mb-1\">\n                <span class=\"font-medium text-sm\">{{ vc.name }}</span>\n                <Badge :variant=\"getCaseStatusVariant(vc.status)\" size=\"sm\">\n                  {{ vc.status }}\n                </Badge>\n              </div>\n              <p class=\"text-sm text-gray-500\">{{ vc.item_code }} - {{ vc.item_name }}</p>\n            </div>\n          </div>\n        </div>\n\n        <!-- Actions -->\n        <div class=\"bg-white rounded-lg border p-6\">\n          <h3 class=\"text-lg font-semibold text-gray-900 mb-4\">Actions</h3>\n          <div class=\"space-y-2\">\n            <Button variant=\"outline\" class=\"w-full justify-start\" @click=\"printCountSheet\">\n              <Printer class=\"w-4 h-4 mr-2\" />\n              Print Count Sheet\n            </Button>\n            <Button variant=\"outline\" class=\"w-full justify-start\" @click=\"exportToExcel\">\n              <Download class=\"w-4 h-4 mr-2\" />\n              Export to Excel\n            </Button>\n            <Button variant=\"outline\" class=\"w-full justify-start\" @click=\"viewAuditLog\">\n              <History class=\"w-4 h-4 mr-2\" />\n              View Audit Log\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport {\n\tPhysicalCountTable,\n\tSignoffSection,\n} from \"@/components/inventory-audit\"\nimport { Badge, Button } from \"frappe-ui\"\nimport { call } from \"frappe-ui\"\nimport {\n\tAlertCircle,\n\tAlertTriangle,\n\tArrowLeft,\n\tCalendar,\n\tCheckCircle,\n\tClipboardList,\n\tDollarSign,\n\tDownload,\n\tEdit,\n\tExternalLink,\n\tHistory,\n\tPlay,\n\tPrinter,\n\tTrendingDown,\n\tTrendingUp,\n} from \"lucide-vue-next\"\nimport { computed, onMounted, ref } from \"vue\"\nimport { useRoute, useRouter } from \"vue-router\"\n\nconst route = useRoute()\nconst router = useRouter()\n\nconst loading = ref(true)\nconst session = ref(null)\nconst varianceCases = ref([])\n\nonMounted(async () => {\n\tawait loadSession()\n\tawait loadVarianceCases()\n})\n\nasync function loadSession() {\n\tloading.value = true\n\ttry {\n\t\tconst doc = await call(\"frappe.client.get\", {\n\t\t\tdoctype: \"Stock Take Session\",\n\t\t\tname: route.params.id,\n\t\t})\n\t\tsession.value = doc\n\t} catch (error) {\n\t\tconsole.error(\"Error loading session:\", error)\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n\nasync function loadVarianceCases() {\n\ttry {\n\t\tconst cases = await call(\"frappe.client.get_list\", {\n\t\t\tdoctype: \"Inventory Variance Case\",\n\t\t\tfilters: { stock_take_session: route.params.id },\n\t\t\tfields: [\n\t\t\t\t\"name\",\n\t\t\t\t\"item_code\",\n\t\t\t\t\"item_name\",\n\t\t\t\t\"status\",\n\t\t\t\t\"variance_qty\",\n\t\t\t\t\"variance_value\",\n\t\t\t],\n\t\t})\n\t\tvarianceCases.value = cases\n\t} catch (error) {\n\t\tconsole.error(\"Error loading variance cases:\", error)\n\t}\n}\n\nconst statusVariant = computed(() => {\n\tconst variants = {\n\t\tScheduled: \"subtle\",\n\t\t\"In Progress\": \"outline\",\n\t\t\"Pending Review\": \"warning\",\n\t\tCompleted: \"success\",\n\t\tApproved: \"success\",\n\t\tCancelled: \"subtle\",\n\t}\n\treturn variants[session.value?.status] || \"subtle\"\n})\n\nconst totalItems = computed(() => session.value?.count_items?.length || 0)\n\nconst countedItems = computed(() => {\n\tif (!session.value?.count_items) return 0\n\treturn session.value.count_items.filter(\n\t\t(i) => i.counted_qty !== null && i.counted_qty !== undefined,\n\t).length\n})\n\nconst progressPercent = computed(() => {\n\tif (totalItems.value === 0) return 0\n\treturn Math.round((countedItems.value / totalItems.value) * 100)\n})\n\nconst itemsWithIssues = computed(() => {\n\tif (!session.value?.count_items) return 0\n\treturn session.value.count_items.filter(\n\t\t(i) => i.condition && i.condition !== \"Good\",\n\t).length\n})\n\nconst accuracyRate = computed(() => {\n\tif (countedItems.value === 0) return 100\n\tconst accurateItems =\n\t\tsession.value?.count_items?.filter((i) => i.variance_qty === 0).length || 0\n\treturn Math.round((accurateItems / countedItems.value) * 100)\n})\n\nconst varianceStats = computed(() => {\n\tif (!session.value?.count_items) {\n\t\treturn {\n\t\t\ttotalVariances: 0,\n\t\t\tshortages: 0,\n\t\t\toverages: 0,\n\t\t\tnetVarianceValue: 0,\n\t\t\tmaterialVariances: 0,\n\t\t}\n\t}\n\n\tconst items = session.value.count_items.filter((i) => i.variance_qty !== 0)\n\treturn {\n\t\ttotalVariances: items.length,\n\t\tshortages: items.filter((i) => (i.variance_qty || 0) < 0).length,\n\t\toverages: items.filter((i) => (i.variance_qty || 0) > 0).length,\n\t\tnetVarianceValue: items.reduce(\n\t\t\t(sum, i) => sum + (i.variance_value || 0),\n\t\t\t0,\n\t\t),\n\t\tmaterialVariances: items.filter((i) => i.is_material).length,\n\t}\n})\n\nfunction formatDate(date) {\n\tif (!date) return \"-\"\n\treturn new Date(date).toLocaleDateString()\n}\n\nfunction formatDateTime(datetime) {\n\tif (!datetime) return \"-\"\n\treturn new Date(datetime).toLocaleString()\n}\n\nfunction formatCurrency(value) {\n\tif (value === null || value === undefined) return \"-\"\n\treturn new Intl.NumberFormat(\"en-KE\", {\n\t\tstyle: \"currency\",\n\t\tcurrency: \"KES\",\n\t}).format(value)\n}\n\nfunction getCaseStatusVariant(status) {\n\tconst variants = {\n\t\tOpen: \"warning\",\n\t\t\"Under Investigation\": \"outline\",\n\t\tResolved: \"success\",\n\t\t\"Written Off\": \"subtle\",\n\t\tClosed: \"subtle\",\n\t}\n\treturn variants[status] || \"subtle\"\n}\n\nfunction goBack() {\n\trouter.push(\"/inventory-audit/sessions\")\n}\n\nfunction editSession() {\n\trouter.push(`/inventory-audit/sessions/${route.params.id}/edit`)\n}\n\nfunction viewAuditPlan() {\n\tif (session.value?.audit_plan) {\n\t\trouter.push(`/inventory-audit/plans/${session.value.audit_plan}`)\n\t}\n}\n\nfunction viewVarianceCase(name) {\n\trouter.push(`/inventory-audit/variance-cases/${name}`)\n}\n\nasync function startCount() {\n\ttry {\n\t\tawait call(\"frappe.client.set_value\", {\n\t\t\tdoctype: \"Stock Take Session\",\n\t\t\tname: route.params.id,\n\t\t\tfieldname: {\n\t\t\t\tstatus: \"In Progress\",\n\t\t\t\tstart_time: new Date().toISOString(),\n\t\t\t},\n\t\t})\n\t\tawait loadSession()\n\t} catch (error) {\n\t\tconsole.error(\"Error starting count:\", error)\n\t}\n}\n\nasync function submitForReview() {\n\ttry {\n\t\tawait call(\"frappe.client.set_value\", {\n\t\t\tdoctype: \"Stock Take Session\",\n\t\t\tname: route.params.id,\n\t\t\tfieldname: {\n\t\t\t\tstatus: \"Pending Review\",\n\t\t\t\tend_time: new Date().toISOString(),\n\t\t\t},\n\t\t})\n\t\tawait loadSession()\n\t} catch (error) {\n\t\tconsole.error(\"Error submitting for review:\", error)\n\t}\n}\n\nasync function handleCountItemsUpdate(items) {\n\t// Auto-save count items\n\ttry {\n\t\tawait call(\"frappe.client.set_value\", {\n\t\t\tdoctype: \"Stock Take Session\",\n\t\t\tname: route.params.id,\n\t\t\tfieldname: { count_items: items },\n\t\t})\n\t} catch (error) {\n\t\tconsole.error(\"Error saving count items:\", error)\n\t}\n}\n\nasync function handleSignoff(type) {\n\tconst fieldMap = {\n\t\tteam: { team_signoff: 1, team_signoff_date: new Date().toISOString() },\n\t\tsupervisor: {\n\t\t\tsupervisor_signoff: 1,\n\t\t\tsupervisor_signoff_date: new Date().toISOString(),\n\t\t},\n\t\tauditor: {\n\t\t\tauditor_signoff: 1,\n\t\t\tauditor_signoff_date: new Date().toISOString(),\n\t\t},\n\t}\n\n\ttry {\n\t\tawait call(\"frappe.client.set_value\", {\n\t\t\tdoctype: \"Stock Take Session\",\n\t\t\tname: route.params.id,\n\t\t\tfieldname: fieldMap[type],\n\t\t})\n\t\tawait loadSession()\n\t} catch (error) {\n\t\tconsole.error(\"Error applying signoff:\", error)\n\t}\n}\n\nfunction createVarianceCases() {\n\t// Navigate to create variance cases from material variances\n\trouter.push(\n\t\t`/inventory-audit/sessions/${route.params.id}/create-variance-cases`,\n\t)\n}\n\nfunction printCountSheet() {\n\twindow.open(\n\t\t`/api/method/frappe.utils.print_format.download_pdf?doctype=Stock Take Session&name=${route.params.id}&format=Count Sheet`,\n\t\t\"_blank\",\n\t)\n}\n\nfunction exportToExcel() {\n\t// Implementation for Excel export\n\tconsole.log(\"Export to Excel\")\n}\n\nfunction viewAuditLog() {\n\t// Show audit log modal\n\tconsole.log(\"View Audit Log\")\n}\n</script>\n"],"names":["props","__props","completedCount","computed","count","progressBarClass","getSignoffClass","role","canSignoff","formatDate","date","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","_hoisted_3","_normalizeClass","_hoisted_4","_createBlock","_unref","CheckCircle","Circle","_cache","_hoisted_5","_hoisted_6","Button","$emit","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","route","useRoute","router","useRouter","loading","ref","session","varianceCases","onMounted","__async","loadSession","loadVarianceCases","doc","call","error","cases","statusVariant","_a","totalItems","_b","countedItems","i","progressPercent","itemsWithIssues","accuracyRate","accurateItems","varianceStats","items","sum","formatDateTime","datetime","formatCurrency","value","getCaseStatusVariant","status","goBack","editSession","viewAuditPlan","viewVarianceCase","name","startCount","submitForReview","handleCountItemsUpdate","handleSignoff","type","fieldMap","createVarianceCases","printCountSheet","exportToExcel","viewAuditLog","_createVNode","ArrowLeft","Badge","_createTextVNode","Edit","_c","Play","_d","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","ClipboardList","_hoisted_23","ExternalLink","_hoisted_24","PhysicalCountTable","$event","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","AlertTriangle","_hoisted_29","_hoisted_30","_hoisted_31","TrendingDown","_hoisted_32","_hoisted_33","_hoisted_34","TrendingUp","_hoisted_35","_hoisted_36","_hoisted_37","DollarSign","_hoisted_38","_hoisted_39","_hoisted_40","AlertCircle","_hoisted_41","_hoisted_42","SignoffSection","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","Calendar","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_Fragment","_renderList","vc","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","Printer","Download","History"],"mappings":"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"}