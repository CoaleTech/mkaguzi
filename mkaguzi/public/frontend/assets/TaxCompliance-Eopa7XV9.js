var ge=Object.defineProperty;var ce=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var pe=(C,c,n)=>c in C?ge(C,c,{enumerable:!0,configurable:!0,writable:!0,value:n}):C[c]=n,ae=(C,c)=>{for(var n in c||(c={}))be.call(c,n)&&pe(C,n,c[n]);if(ce)for(var n of ce(c))he.call(c,n)&&pe(C,n,c[n]);return C};var L=(C,c,n)=>new Promise((F,r)=>{var w=V=>{try{g(n.next(V))}catch(l){r(l)}},u=V=>{try{g(n.throw(V))}catch(l){r(l)}},g=V=>V.done?F(V.value):Promise.resolve(V.value).then(w,u);g((n=n.apply(C,c)).next())});import{j as W,r as O,b as me,w as oe,y as h,p as m,u as f,q as e,H as A,v as s,z as k,s as a,A as v,l as j,F as te,x as ne,B as X,C as we,$ as le,ac as D,ad as M,aq as ee,Q as Ve}from"./vue-DciwFjI_.js";import{a as P,e as K,b as y,L as fe,c as H,d as Q,D as $e,j as ke}from"./index-qIC3Tfxg.js";import{F as _e,aN as de,g as xe,aj as ve,al as ie,l as re,b as Te,C as Se,ad as Ce,n as q,U as Fe,be as Ue,N as ue,K as Pe,m as Ie,a4 as R,$ as ye,b3 as Ae,E as Ne,a1 as Re,a9 as je,aa as Ee}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const De={class:"flex h-[75vh]"},Oe={class:"w-56 border-r pr-4 flex-shrink-0"},He={class:"space-y-1 sticky top-0"},We=["onClick"],Be={class:"flex-1"},ze={class:"mt-6 pt-6 border-t"},Ye={class:"w-full bg-gray-200 rounded-full h-2"},Le={class:"text-xs text-gray-500 mt-1"},Me={class:"flex-1 pl-6 overflow-y-auto"},Ke={class:"space-y-6"},qe={class:"grid grid-cols-2 gap-6"},Qe={class:"space-y-6"},Xe={class:"grid grid-cols-3 gap-6"},Ge={class:"border rounded-lg p-4 bg-gray-50"},Je={class:"grid grid-cols-2 gap-6"},Ze={class:"flex items-center gap-3"},et={class:"grid grid-cols-2 gap-6 mt-4"},tt={class:"grid grid-cols-2 gap-6 mt-4"},lt={class:"mt-4"},st={class:"border-2 border-dashed rounded-lg p-4 text-center"},at={class:"space-y-6"},ot={class:"grid grid-cols-2 gap-6"},nt={class:"flex items-center gap-3 pt-6"},it={class:"grid grid-cols-3 gap-6"},rt={class:"space-y-6"},dt={class:"grid grid-cols-2 gap-6"},ut={class:"grid grid-cols-2 gap-6"},ct={class:"border rounded-lg p-4 bg-blue-50"},pt={class:"flex items-center justify-between"},mt={class:"text-xl font-bold text-blue-800"},ft={class:"grid grid-cols-3 gap-6"},_t={class:"flex items-center gap-3"},xt={class:"space-y-6"},vt={class:"border rounded-lg p-4"},yt={class:"font-medium text-gray-700 mb-4 flex items-center gap-2"},gt={class:"grid grid-cols-3 gap-6"},bt={class:"grid grid-cols-2 gap-6 mt-4"},ht={class:"flex items-center gap-3"},wt={class:"border rounded-lg p-4"},Vt={class:"font-medium text-gray-700 mb-4 flex items-center gap-2"},$t={class:"grid grid-cols-2 gap-6"},kt={class:"flex items-center gap-3 mt-4"},Tt={class:"space-y-6"},St={class:"border rounded-lg p-6 bg-gradient-to-r from-blue-50 to-purple-50"},Ct={class:"flex items-center justify-between mb-4"},Ft={class:"w-full bg-gray-200 rounded-full h-3"},Ut={class:"border rounded-lg overflow-hidden"},Pt={class:"bg-gray-50 px-4 py-3 border-b flex items-center justify-between"},It={class:"divide-y max-h-64 overflow-y-auto"},At={class:"grid grid-cols-12 gap-4 items-start"},Nt={class:"col-span-2"},Rt={class:"col-span-4"},jt={class:"col-span-2"},Et={class:"col-span-2"},Dt={class:"col-span-2 flex justify-end"},Ot={key:0,class:"mt-3"},Ht={key:0,class:"p-8 text-center text-gray-500"},Wt={class:"flex items-center justify-between w-full"},Bt={class:"flex items-center gap-2"},zt={class:"flex items-center gap-2"},Yt={__name:"TaxComplianceForm",props:{show:{type:Boolean,default:!1},tracker:{type:Object,default:null}},emits:["update:show","saved"],setup(C,{emit:c}){const n=C,F=c,r=W({get:()=>n.show,set:p=>F("update:show",p)}),w=W(()=>{var p;return!!((p=n.tracker)!=null&&p.name)}),u=O(!1),g=O("basic"),V=[{id:"basic",label:"Basic Info",icon:_e},{id:"vat",label:"VAT",icon:de},{id:"paye",label:"PAYE",icon:xe},{id:"wht",label:"Withholding Tax",icon:ve},{id:"statutory",label:"Statutory",icon:ie},{id:"issues",label:"Issues",icon:re}],l=me({tracker_id:"",tax_period:"",vat_on_sales:0,vat_on_purchases:0,net_vat_payable:0,vat_return_filed:!1,vat_return_reference:"",vat_filing_date:"",vat_payment_date:"",vat_payment_amount:0,vat_payment_reference:"",vat_reconciliation:"",total_paye:0,paye_return_filed:!1,paye_filing_date:"",paye_payment_date:"",paye_payment_reference:"",wht_on_services:0,wht_on_rent:0,wht_on_professional_fees:0,other_wht:0,total_wht:0,wht_return_filed:!1,wht_filing_date:"",wht_payment_date:"",employee_contributions:0,employer_contributions:0,total_nssf:0,nssf_return_filed:!1,nssf_payment_date:"",total_nhif:0,nhif_return_filed:!1,nhif_payment_date:"",compliance_score:0,issues_identified:[]}),U=[{label:"Late Filing",value:"Late Filing"},{label:"Late Payment",value:"Late Payment"},{label:"Underpayment",value:"Underpayment"},{label:"Documentation",value:"Documentation"},{label:"Other",value:"Other"}],I=[{label:"Open",value:"Open"},{label:"Resolved",value:"Resolved"}];oe(()=>n.tracker,p=>{p&&Object.keys(l).forEach(t=>{p[t]!==void 0&&(l[t]=p[t])})},{immediate:!0}),oe(()=>n.show,p=>{p&&!n.tracker&&(Object.keys(l).forEach(t=>{t==="issues_identified"?l[t]=[]:typeof l[t]=="boolean"?l[t]=!1:typeof l[t]=="number"?l[t]=0:l[t]=""}),g.value="basic")});function B(){l.net_vat_payable=(l.vat_on_sales||0)-(l.vat_on_purchases||0)}function $(){l.total_wht=(l.wht_on_services||0)+(l.wht_on_rent||0)+(l.wht_on_professional_fees||0)+(l.other_wht||0)}function d(){l.total_nssf=(l.employee_contributions||0)+(l.employer_contributions||0)}function b(){l.issues_identified.push({issue_type:"",description:"",financial_impact:0,resolution_status:"Open",resolution_notes:""})}function G(p){l.issues_identified.splice(p,1)}const z=W(()=>V.findIndex(p=>p.id===g.value));function J(){z.value<V.length-1&&(g.value=V[z.value+1].id)}function T(){z.value>0&&(g.value=V[z.value-1].id)}function i(p){switch(p){case"basic":return!!l.tracker_id&&!!l.tax_period;case"vat":return l.vat_return_filed;case"paye":return l.paye_return_filed;case"wht":return l.wht_return_filed;case"statutory":return l.nssf_return_filed&&l.nhif_return_filed;case"issues":return!0;default:return!1}}const _=W(()=>{const p=V.filter(t=>i(t.id)).length;return Math.round(p/V.length*100)});function Y(p){return new Intl.NumberFormat("en-KE").format(p)}function x(p){return p>=90?"green":p>=70?"blue":p>=50?"orange":"red"}function S(p){return p>=90?"bg-green-500":p>=70?"bg-blue-500":p>=50?"bg-orange-500":"bg-red-500"}function N(){return L(this,null,function*(){u.value=!0;try{yield new Promise(p=>setTimeout(p,1e3)),F("saved",ae({},l)),r.value=!1}catch(p){console.error("Failed to save tracker:",p)}finally{u.value=!1}})}return(p,t)=>(m(),h(s($e),{modelValue:r.value,"onUpdate:modelValue":t[32]||(t[32]=Z=>r.value=Z),options:{size:"7xl",title:w.value?"Edit Tax Compliance Tracker":"New Tax Compliance Tracker"}},{"body-content":f(()=>{var Z;return[e("div",De,[e("div",Oe,[e("nav",He,[(m(),j(te,null,ne(V,(o,se)=>e("button",{key:o.id,onClick:E=>g.value=o.id,class:X(["w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",g.value===o.id?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-50"])},[(m(),h(we(o.icon),{class:X(["h-4 w-4",g.value===o.id?"text-blue-600":"text-gray-400"])},null,8,["class"])),e("span",Be,v(o.label),1),i(o.id)?(m(),h(s(q),{key:0,class:"h-4 w-4 text-green-500"})):A("",!0)],10,We)),64))]),e("div",ze,[t[33]||(t[33]=e("div",{class:"text-xs font-medium text-gray-500 mb-2"},"Completion",-1)),e("div",Ye,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all",style:le({width:`${_.value}%`})},null,4)]),e("div",Le,v(_.value)+"% complete",1)])]),e("div",Me,[D(e("div",Ke,[a(K,{title:"Basic Information",description:"Tracker identification and tax period details"}),e("div",qe,[a(s(y),{modelValue:l.tracker_id,"onUpdate:modelValue":t[0]||(t[0]=o=>l.tracker_id=o),label:"Tracker ID",type:"text",required:!0,placeholder:"Auto-generated if left empty"},null,8,["modelValue"]),a(fe,{modelValue:l.tax_period,"onUpdate:modelValue":t[1]||(t[1]=o=>l.tax_period=o),label:"Tax Period",doctype:"Data Period",required:!0,placeholder:"Select tax period"},null,8,["modelValue"])])],512),[[M,g.value==="basic"]]),D(e("div",Qe,[a(K,{title:"VAT Compliance",description:"Value Added Tax calculations and filings"}),e("div",Xe,[a(s(y),{modelValue:l.vat_on_sales,"onUpdate:modelValue":t[2]||(t[2]=o=>l.vat_on_sales=o),label:"VAT on Sales",type:"number",placeholder:"0.00",onChange:B},null,8,["modelValue"]),a(s(y),{modelValue:l.vat_on_purchases,"onUpdate:modelValue":t[3]||(t[3]=o=>l.vat_on_purchases=o),label:"VAT on Purchases",type:"number",placeholder:"0.00",onChange:B},null,8,["modelValue"]),a(s(y),{modelValue:l.net_vat_payable,"onUpdate:modelValue":t[4]||(t[4]=o=>l.net_vat_payable=o),label:"Net VAT Payable",type:"number",disabled:!0},null,8,["modelValue"])]),e("div",Ge,[t[38]||(t[38]=e("h4",{class:"font-medium text-gray-700 mb-4"},"VAT Filing Details",-1)),e("div",Je,[e("div",Ze,[D(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=o=>l.vat_return_filed=o),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,512),[[ee,l.vat_return_filed]]),t[34]||(t[34]=e("label",{class:"text-sm text-gray-700"},"VAT Return Filed",-1))]),a(s(y),{modelValue:l.vat_return_reference,"onUpdate:modelValue":t[6]||(t[6]=o=>l.vat_return_reference=o),label:"Return Reference",type:"text",placeholder:"Enter reference number"},null,8,["modelValue"])]),e("div",et,[a(s(y),{modelValue:l.vat_filing_date,"onUpdate:modelValue":t[7]||(t[7]=o=>l.vat_filing_date=o),label:"Filing Date",type:"date"},null,8,["modelValue"]),a(s(y),{modelValue:l.vat_payment_date,"onUpdate:modelValue":t[8]||(t[8]=o=>l.vat_payment_date=o),label:"Payment Date",type:"date"},null,8,["modelValue"])]),e("div",tt,[a(s(y),{modelValue:l.vat_payment_amount,"onUpdate:modelValue":t[9]||(t[9]=o=>l.vat_payment_amount=o),label:"Payment Amount",type:"number",placeholder:"0.00"},null,8,["modelValue"]),a(s(y),{modelValue:l.vat_payment_reference,"onUpdate:modelValue":t[10]||(t[10]=o=>l.vat_payment_reference=o),label:"Payment Reference",type:"text",placeholder:"Enter payment reference"},null,8,["modelValue"])]),e("div",lt,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," VAT Reconciliation Document ",-1)),e("div",st,[a(s(Fe),{class:"h-8 w-8 text-gray-400 mx-auto mb-2"}),t[35]||(t[35]=e("p",{class:"text-sm text-gray-600"},[e("span",{class:"text-blue-600 cursor-pointer hover:underline"}," Click to upload "),k(" or drag and drop ")],-1)),t[36]||(t[36]=e("p",{class:"text-xs text-gray-500 mt-1"},"PDF, XLS, XLSX up to 10MB",-1))])])])],512),[[M,g.value==="vat"]]),D(e("div",at,[a(K,{title:"PAYE Compliance",description:"Pay As You Earn tax calculations and filings"}),e("div",ot,[a(s(y),{modelValue:l.total_paye,"onUpdate:modelValue":t[11]||(t[11]=o=>l.total_paye=o),label:"Total PAYE",type:"number",placeholder:"0.00"},null,8,["modelValue"]),e("div",nt,[D(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=o=>l.paye_return_filed=o),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,512),[[ee,l.paye_return_filed]]),t[39]||(t[39]=e("label",{class:"text-sm text-gray-700"},"PAYE Return Filed",-1))])]),e("div",it,[a(s(y),{modelValue:l.paye_filing_date,"onUpdate:modelValue":t[13]||(t[13]=o=>l.paye_filing_date=o),label:"Filing Date",type:"date"},null,8,["modelValue"]),a(s(y),{modelValue:l.paye_payment_date,"onUpdate:modelValue":t[14]||(t[14]=o=>l.paye_payment_date=o),label:"Payment Date",type:"date"},null,8,["modelValue"]),a(s(y),{modelValue:l.paye_payment_reference,"onUpdate:modelValue":t[15]||(t[15]=o=>l.paye_payment_reference=o),label:"Payment Reference",type:"text",placeholder:"Enter reference"},null,8,["modelValue"])])],512),[[M,g.value==="paye"]]),D(e("div",rt,[a(K,{title:"Withholding Tax Compliance",description:"WHT calculations and filings"}),e("div",dt,[a(s(y),{modelValue:l.wht_on_services,"onUpdate:modelValue":t[16]||(t[16]=o=>l.wht_on_services=o),label:"WHT on Services",type:"number",placeholder:"0.00",onChange:$},null,8,["modelValue"]),a(s(y),{modelValue:l.wht_on_rent,"onUpdate:modelValue":t[17]||(t[17]=o=>l.wht_on_rent=o),label:"WHT on Rent",type:"number",placeholder:"0.00",onChange:$},null,8,["modelValue"])]),e("div",ut,[a(s(y),{modelValue:l.wht_on_professional_fees,"onUpdate:modelValue":t[18]||(t[18]=o=>l.wht_on_professional_fees=o),label:"WHT on Professional Fees",type:"number",placeholder:"0.00",onChange:$},null,8,["modelValue"]),a(s(y),{modelValue:l.other_wht,"onUpdate:modelValue":t[19]||(t[19]=o=>l.other_wht=o),label:"Other WHT",type:"number",placeholder:"0.00",onChange:$},null,8,["modelValue"])]),e("div",ct,[e("div",pt,[t[40]||(t[40]=e("span",{class:"font-medium text-blue-700"},"Total Withholding Tax",-1)),e("span",mt," KES "+v(Y(l.total_wht||0)),1)])]),e("div",ft,[e("div",_t,[D(e("input",{type:"checkbox","onUpdate:modelValue":t[20]||(t[20]=o=>l.wht_return_filed=o),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,512),[[ee,l.wht_return_filed]]),t[41]||(t[41]=e("label",{class:"text-sm text-gray-700"},"WHT Return Filed",-1))]),a(s(y),{modelValue:l.wht_filing_date,"onUpdate:modelValue":t[21]||(t[21]=o=>l.wht_filing_date=o),label:"Filing Date",type:"date"},null,8,["modelValue"]),a(s(y),{modelValue:l.wht_payment_date,"onUpdate:modelValue":t[22]||(t[22]=o=>l.wht_payment_date=o),label:"Payment Date",type:"date"},null,8,["modelValue"])])],512),[[M,g.value==="wht"]]),D(e("div",xt,[a(K,{title:"Statutory Deductions",description:"NSSF and NHIF contributions and filings"}),e("div",vt,[e("h4",yt,[a(s(ie),{class:"h-5 w-5 text-blue-500"}),t[42]||(t[42]=k(" NSSF Compliance ",-1))]),e("div",gt,[a(s(y),{modelValue:l.employee_contributions,"onUpdate:modelValue":t[23]||(t[23]=o=>l.employee_contributions=o),label:"Employee Contributions",type:"number",placeholder:"0.00",onChange:d},null,8,["modelValue"]),a(s(y),{modelValue:l.employer_contributions,"onUpdate:modelValue":t[24]||(t[24]=o=>l.employer_contributions=o),label:"Employer Contributions",type:"number",placeholder:"0.00",onChange:d},null,8,["modelValue"]),a(s(y),{modelValue:l.total_nssf,"onUpdate:modelValue":t[25]||(t[25]=o=>l.total_nssf=o),label:"Total NSSF",type:"number",disabled:!0},null,8,["modelValue"])]),e("div",bt,[e("div",ht,[D(e("input",{type:"checkbox","onUpdate:modelValue":t[26]||(t[26]=o=>l.nssf_return_filed=o),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,512),[[ee,l.nssf_return_filed]]),t[43]||(t[43]=e("label",{class:"text-sm text-gray-700"},"NSSF Return Filed",-1))]),a(s(y),{modelValue:l.nssf_payment_date,"onUpdate:modelValue":t[27]||(t[27]=o=>l.nssf_payment_date=o),label:"Payment Date",type:"date"},null,8,["modelValue"])])]),e("div",wt,[e("h4",Vt,[a(s(Ue),{class:"h-5 w-5 text-red-500"}),t[44]||(t[44]=k(" NHIF Compliance ",-1))]),e("div",$t,[a(s(y),{modelValue:l.total_nhif,"onUpdate:modelValue":t[28]||(t[28]=o=>l.total_nhif=o),label:"Total NHIF",type:"number",placeholder:"0.00"},null,8,["modelValue"]),a(s(y),{modelValue:l.nhif_payment_date,"onUpdate:modelValue":t[29]||(t[29]=o=>l.nhif_payment_date=o),label:"Payment Date",type:"date"},null,8,["modelValue"])]),e("div",kt,[D(e("input",{type:"checkbox","onUpdate:modelValue":t[30]||(t[30]=o=>l.nhif_return_filed=o),class:"h-4 w-4 rounded border-gray-300 text-blue-600"},null,512),[[ee,l.nhif_return_filed]]),t[45]||(t[45]=e("label",{class:"text-sm text-gray-700"},"NHIF Return Filed",-1))])])],512),[[M,g.value==="statutory"]]),D(e("div",Tt,[a(K,{title:"Issues & Compliance Score",description:"Identified issues and overall compliance status"}),e("div",St,[e("div",Ct,[t[46]||(t[46]=e("h4",{class:"font-medium text-gray-700"},"Overall Compliance Score",-1)),a(s(H),{theme:x(l.compliance_score),size:"lg"},{default:f(()=>[k(v(l.compliance_score||0)+"% ",1)]),_:1},8,["theme"])]),e("div",Ft,[e("div",{class:X(["h-3 rounded-full transition-all",S(l.compliance_score)]),style:le({width:`${l.compliance_score||0}%`})},null,6)])]),e("div",Ut,[e("div",Pt,[t[48]||(t[48]=e("h4",{class:"font-medium text-gray-700"},"Issues Identified",-1)),a(s(P),{size:"sm",variant:"outline",onClick:b},{prefix:f(()=>[a(s(ue),{class:"h-4 w-4"})]),default:f(()=>[t[47]||(t[47]=k(" Add Issue ",-1))]),_:1})]),e("div",It,[(m(!0),j(te,null,ne(l.issues_identified,(o,se)=>(m(),j("div",{key:se,class:"p-4"},[e("div",At,[e("div",Nt,[a(s(Q),{modelValue:o.issue_type,"onUpdate:modelValue":E=>o.issue_type=E,options:U,placeholder:"Issue Type"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Rt,[a(s(y),{modelValue:o.description,"onUpdate:modelValue":E=>o.description=E,type:"textarea",rows:2,placeholder:"Describe the issue..."},null,8,["modelValue","onUpdate:modelValue"])]),e("div",jt,[a(s(y),{modelValue:o.financial_impact,"onUpdate:modelValue":E=>o.financial_impact=E,type:"number",placeholder:"Impact"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Et,[a(s(Q),{modelValue:o.resolution_status,"onUpdate:modelValue":E=>o.resolution_status=E,options:I,placeholder:"Status"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Dt,[a(s(P),{size:"sm",variant:"ghost",theme:"red",onClick:E=>G(se)},{default:f(()=>[a(s(Pe),{class:"h-4 w-4"})]),_:1},8,["onClick"])])]),o.resolution_notes||o.resolution_status==="Resolved"?(m(),j("div",Ot,[a(s(y),{modelValue:o.resolution_notes,"onUpdate:modelValue":E=>o.resolution_notes=E,type:"textarea",rows:2,placeholder:"Resolution notes..."},null,8,["modelValue","onUpdate:modelValue"])])):A("",!0)]))),128)),(Z=l.issues_identified)!=null&&Z.length?A("",!0):(m(),j("div",Ht,[a(s(re),{class:"h-8 w-8 mx-auto mb-2 text-gray-400"}),t[49]||(t[49]=e("p",null,"No issues identified",-1)),t[50]||(t[50]=e("p",{class:"text-sm mt-1"},'Click "Add Issue" to record any compliance issues',-1))]))])])],512),[[M,g.value==="issues"]])])])]}),actions:f(()=>[e("div",Wt,[e("div",Bt,[g.value!=="basic"?(m(),h(s(P),{key:0,variant:"outline",onClick:T},{prefix:f(()=>[a(s(Te),{class:"h-4 w-4"})]),default:f(()=>[t[51]||(t[51]=k(" Previous ",-1))]),_:1})):A("",!0)]),e("div",zt,[a(s(P),{variant:"outline",onClick:t[31]||(t[31]=Z=>r.value=!1)},{default:f(()=>[...t[52]||(t[52]=[k("Cancel",-1)])]),_:1}),g.value!=="issues"?(m(),h(s(P),{key:0,variant:"solid",onClick:J},{suffix:f(()=>[a(s(Se),{class:"h-4 w-4"})]),default:f(()=>[t[53]||(t[53]=k(" Next ",-1))]),_:1})):(m(),h(s(P),{key:1,variant:"solid",theme:"green",loading:u.value,onClick:N},{prefix:f(()=>[a(s(Ce),{class:"h-4 w-4"})]),default:f(()=>[k(" "+v(w.value?"Update Tracker":"Create Tracker"),1)]),_:1},8,["loading"]))])])]),_:1},8,["modelValue","options"]))}},Lt={class:"bg-white rounded-xl border p-4"},Mt={class:"flex flex-wrap items-center gap-4"},Kt={class:"flex-1 min-w-[200px] max-w-md"},qt={class:"w-44"},Qt={class:"w-36"},Xt={class:"w-36"},Gt={class:"w-40"},Jt={class:"w-32"},Zt={class:"flex items-center gap-2 ml-auto"},el={key:0,class:"flex flex-wrap items-center gap-2 mt-3 pt-3 border-t"},tl={__name:"TaxFilters",props:{filters:{type:Object,default:()=>({})}},emits:["update:filters","refresh","create"],setup(C,{emit:c}){const n=C,F=c,r=me({search:"",taxPeriod:"",taxType:"",filingStatus:"",scoreRange:"",hasIssues:""});oe(()=>n.filters,$=>{$&&Object.assign(r,$)},{immediate:!0,deep:!0});const w=[{label:"All Tax Types",value:""},{label:"VAT",value:"VAT"},{label:"PAYE",value:"PAYE"},{label:"Withholding Tax",value:"WHT"},{label:"NSSF",value:"NSSF"},{label:"NHIF",value:"NHIF"}],u=[{label:"All Status",value:""},{label:"All Filed",value:"filed"},{label:"Pending Filing",value:"pending"},{label:"Overdue",value:"overdue"}],g=[{label:"All Scores",value:""},{label:"Excellent (90-100%)",value:"90-100"},{label:"Good (70-89%)",value:"70-89"},{label:"Fair (50-69%)",value:"50-69"},{label:"Poor (0-49%)",value:"0-49"}],V=[{label:"All",value:""},{label:"Has Issues",value:"yes"},{label:"No Issues",value:"no"}],l=W(()=>Object.values(r).some($=>$!==""));function U(){F("update:filters",ae({},r))}function I($){r[$]="",U()}function B(){Object.keys(r).forEach($=>{r[$]=""}),U()}return($,d)=>(m(),j("div",Lt,[e("div",Mt,[e("div",Kt,[a(s(y),{modelValue:r.search,"onUpdate:modelValue":[d[0]||(d[0]=b=>r.search=b),U],type:"text",placeholder:"Search by tracker ID...",debounce:300},{prefix:f(()=>[a(s(Ie),{class:"h-4 w-4 text-gray-400"})]),_:1},8,["modelValue"])]),e("div",qt,[a(fe,{modelValue:r.taxPeriod,"onUpdate:modelValue":[d[1]||(d[1]=b=>r.taxPeriod=b),U],doctype:"Data Period",placeholder:"All Periods"},null,8,["modelValue"])]),e("div",Qt,[a(s(Q),{modelValue:r.taxType,"onUpdate:modelValue":[d[2]||(d[2]=b=>r.taxType=b),U],options:w,placeholder:"Tax Type"},null,8,["modelValue"])]),e("div",Xt,[a(s(Q),{modelValue:r.filingStatus,"onUpdate:modelValue":[d[3]||(d[3]=b=>r.filingStatus=b),U],options:u,placeholder:"Filing Status"},null,8,["modelValue"])]),e("div",Gt,[a(s(Q),{modelValue:r.scoreRange,"onUpdate:modelValue":[d[4]||(d[4]=b=>r.scoreRange=b),U],options:g,placeholder:"Score Range"},null,8,["modelValue"])]),e("div",Jt,[a(s(Q),{modelValue:r.hasIssues,"onUpdate:modelValue":[d[5]||(d[5]=b=>r.hasIssues=b),U],options:V,placeholder:"Issues"},null,8,["modelValue"])]),e("div",Zt,[l.value?(m(),h(s(P),{key:0,variant:"outline",onClick:B},{prefix:f(()=>[a(s(R),{class:"h-4 w-4"})]),default:f(()=>[d[14]||(d[14]=k(" Clear ",-1))]),_:1})):A("",!0),a(s(P),{variant:"outline",onClick:d[6]||(d[6]=b=>$.$emit("refresh"))},{prefix:f(()=>[a(s(ye),{class:"h-4 w-4"})]),default:f(()=>[d[15]||(d[15]=k(" Refresh ",-1))]),_:1}),a(s(P),{variant:"solid",onClick:d[7]||(d[7]=b=>$.$emit("create"))},{prefix:f(()=>[a(s(ue),{class:"h-4 w-4"})]),default:f(()=>[d[16]||(d[16]=k(" New Tracker ",-1))]),_:1})])]),l.value?(m(),j("div",el,[d[17]||(d[17]=e("span",{class:"text-xs text-gray-500"},"Active filters:",-1)),r.search?(m(),h(s(H),{key:0,theme:"blue",class:"cursor-pointer",onClick:d[8]||(d[8]=b=>I("search"))},{default:f(()=>[k(' Search: "'+v(r.search)+'" ',1),a(s(R),{class:"h-3 w-3 ml-1"})]),_:1})):A("",!0),r.taxPeriod?(m(),h(s(H),{key:1,theme:"purple",class:"cursor-pointer",onClick:d[9]||(d[9]=b=>I("taxPeriod"))},{default:f(()=>[k(" Period: "+v(r.taxPeriod)+" ",1),a(s(R),{class:"h-3 w-3 ml-1"})]),_:1})):A("",!0),r.taxType?(m(),h(s(H),{key:2,theme:"green",class:"cursor-pointer",onClick:d[10]||(d[10]=b=>I("taxType"))},{default:f(()=>[k(" Type: "+v(r.taxType)+" ",1),a(s(R),{class:"h-3 w-3 ml-1"})]),_:1})):A("",!0),r.filingStatus?(m(),h(s(H),{key:3,theme:"indigo",class:"cursor-pointer",onClick:d[11]||(d[11]=b=>I("filingStatus"))},{default:f(()=>[k(" Status: "+v(r.filingStatus)+" ",1),a(s(R),{class:"h-3 w-3 ml-1"})]),_:1})):A("",!0),r.scoreRange?(m(),h(s(H),{key:4,theme:"orange",class:"cursor-pointer",onClick:d[12]||(d[12]=b=>I("scoreRange"))},{default:f(()=>[k(" Score: "+v(r.scoreRange)+" ",1),a(s(R),{class:"h-3 w-3 ml-1"})]),_:1})):A("",!0),r.hasIssues?(m(),h(s(H),{key:5,theme:"red",class:"cursor-pointer",onClick:d[13]||(d[13]=b=>I("hasIssues"))},{default:f(()=>[k(v(r.hasIssues==="yes"?"Has Issues":"No Issues")+" ",1),a(s(R),{class:"h-3 w-3 ml-1"})]),_:1})):A("",!0)])):A("",!0)]))}},ll={class:"grid grid-cols-5 gap-4"},sl={class:"bg-white rounded-xl border p-4"},al={class:"flex items-center justify-between"},ol={class:"text-2xl font-bold text-gray-900"},nl={class:"h-10 w-10 rounded-lg bg-blue-50 flex items-center justify-center"},il={class:"mt-2 flex items-center gap-1 text-xs"},rl={class:"text-gray-500"},dl={class:"bg-white rounded-xl border p-4"},ul={class:"flex items-center justify-between"},cl={class:"text-2xl font-bold text-green-600"},pl={class:"h-10 w-10 rounded-lg bg-green-50 flex items-center justify-center"},ml={class:"mt-2"},fl={class:"flex items-center justify-between text-xs"},_l={class:"font-medium text-green-600"},xl={class:"w-full bg-gray-100 rounded-full h-1.5 mt-1"},vl={class:"bg-white rounded-xl border p-4"},yl={class:"flex items-center justify-between"},gl={class:"text-2xl font-bold text-purple-600"},bl={class:"h-10 w-10 rounded-lg bg-purple-50 flex items-center justify-center"},hl={class:"mt-2"},wl={class:"flex items-center justify-between text-xs"},Vl={class:"font-medium text-purple-600"},$l={class:"w-full bg-gray-100 rounded-full h-1.5 mt-1"},kl={class:"bg-white rounded-xl border p-4"},Tl={class:"flex items-center justify-between"},Sl={class:"text-2xl font-bold text-indigo-600"},Cl={class:"h-10 w-10 rounded-lg bg-indigo-50 flex items-center justify-center"},Fl={class:"mt-2 flex items-center gap-2 text-xs"},Ul={class:"text-gray-500"},Pl={class:"text-gray-500"},Il={class:"bg-white rounded-xl border p-4"},Al={class:"flex items-center justify-between"},Nl={class:"mt-2 flex items-center justify-between text-xs"},Rl={class:"grid grid-cols-4 gap-4 mt-4"},jl={class:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white"},El={class:"flex items-center justify-between"},Dl={class:"text-xl font-bold"},Ol={class:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white"},Hl={class:"flex items-center justify-between"},Wl={class:"text-xl font-bold"},Bl={class:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white"},zl={class:"flex items-center justify-between"},Yl={class:"text-xl font-bold"},Ll={class:"bg-gradient-to-r from-teal-500 to-teal-600 rounded-xl p-4 text-white"},Ml={class:"flex items-center justify-between"},Kl={class:"text-xl font-bold"},ql={__name:"TaxStats",props:{trackers:{type:Array,default:()=>[]}},setup(C){const c=C,n=W(()=>{const w=c.trackers.length,u=c.trackers.filter(x=>x.vat_return_filed).length,g=c.trackers.filter(x=>x.paye_return_filed).length,V=c.trackers.filter(x=>x.wht_return_filed).length,l=c.trackers.filter(x=>x.nssf_return_filed).length,U=c.trackers.filter(x=>x.nhif_return_filed).length,I=w>0?Math.round(u/w*100):0,B=w>0?Math.round(g/w*100):0,$=c.trackers.reduce((x,S)=>x+(S.net_vat_payable||0),0),d=c.trackers.reduce((x,S)=>x+(S.total_paye||0),0),b=c.trackers.reduce((x,S)=>x+(S.total_wht||0),0),G=c.trackers.reduce((x,S)=>x+(S.total_nssf||0),0),z=c.trackers.reduce((x,S)=>x+(S.total_nhif||0),0),J=G+z,T=c.trackers.reduce((x,S)=>{var N;return x+(((N=S.issues_identified)==null?void 0:N.filter(p=>p.resolution_status==="Open").length)||0)},0),i=c.trackers.filter(x=>x.compliance_score!==null&&x.compliance_score!==void 0),_=i.length>0?Math.round(i.reduce((x,S)=>x+(S.compliance_score||0),0)/i.length):0,Y=new Set(c.trackers.map(x=>x.tax_period)).size;return{total:w,vatFiled:u,payeFiled:g,whtFiled:V,nssfFiled:l,nhifFiled:U,statutoryFiled:Math.min(l,U),vatRate:I,payeRate:B,totalVatPayable:$,totalPaye:d,totalWht:b,totalStatutory:J,openIssues:T,avgScore:_,periodsCount:Y}});function F(w){return new Intl.NumberFormat("en-KE").format(w||0)}function r(w){return w>=90?"green":w>=70?"blue":w>=50?"orange":"red"}return(w,u)=>(m(),j(te,null,[e("div",ll,[e("div",sl,[e("div",al,[e("div",null,[u[0]||(u[0]=e("p",{class:"text-sm text-gray-500"},"Total Trackers",-1)),e("p",ol,v(n.value.total),1)]),e("div",nl,[a(s(_e),{class:"h-5 w-5 text-blue-600"})])]),e("div",il,[e("span",rl,v(n.value.periodsCount)+" periods covered",1)])]),e("div",dl,[e("div",ul,[e("div",null,[u[1]||(u[1]=e("p",{class:"text-sm text-gray-500"},"VAT Filed",-1)),e("p",cl,v(n.value.vatFiled),1)]),e("div",pl,[a(s(de),{class:"h-5 w-5 text-green-600"})])]),e("div",ml,[e("div",fl,[u[2]||(u[2]=e("span",{class:"text-gray-500"},"Compliance Rate",-1)),e("span",_l,v(n.value.vatRate)+"%",1)]),e("div",xl,[e("div",{class:"bg-green-500 h-1.5 rounded-full",style:le({width:`${n.value.vatRate}%`})},null,4)])])]),e("div",vl,[e("div",yl,[e("div",null,[u[3]||(u[3]=e("p",{class:"text-sm text-gray-500"},"PAYE Filed",-1)),e("p",gl,v(n.value.payeFiled),1)]),e("div",bl,[a(s(xe),{class:"h-5 w-5 text-purple-600"})])]),e("div",hl,[e("div",wl,[u[4]||(u[4]=e("span",{class:"text-gray-500"},"Compliance Rate",-1)),e("span",Vl,v(n.value.payeRate)+"%",1)]),e("div",$l,[e("div",{class:"bg-purple-500 h-1.5 rounded-full",style:le({width:`${n.value.payeRate}%`})},null,4)])])]),e("div",kl,[e("div",Tl,[e("div",null,[u[5]||(u[5]=e("p",{class:"text-sm text-gray-500"},"Statutory Filed",-1)),e("p",Sl,v(n.value.statutoryFiled),1)]),e("div",Cl,[a(s(ie),{class:"h-5 w-5 text-indigo-600"})])]),e("div",Fl,[e("span",Ul,"NSSF: "+v(n.value.nssfFiled),1),u[6]||(u[6]=e("span",{class:"text-gray-300"},"|",-1)),e("span",Pl,"NHIF: "+v(n.value.nhifFiled),1)])]),e("div",Il,[e("div",Al,[e("div",null,[u[7]||(u[7]=e("p",{class:"text-sm text-gray-500"},"Open Issues",-1)),e("p",{class:X(["text-2xl font-bold",n.value.openIssues>0?"text-red-600":"text-green-600"])},v(n.value.openIssues),3)]),e("div",{class:X(["h-10 w-10 rounded-lg flex items-center justify-center",n.value.openIssues>0?"bg-red-50":"bg-green-50"])},[a(s(re),{class:X(["h-5 w-5",n.value.openIssues>0?"text-red-600":"text-green-600"])},null,8,["class"])],2)]),e("div",Nl,[u[8]||(u[8]=e("span",{class:"text-gray-500"},"Avg Score",-1)),a(s(H),{theme:r(n.value.avgScore),size:"sm"},{default:f(()=>[k(v(n.value.avgScore)+"% ",1)]),_:1},8,["theme"])])])]),e("div",Rl,[e("div",jl,[e("div",El,[e("div",null,[u[9]||(u[9]=e("p",{class:"text-sm text-blue-100"},"Total VAT Payable",-1)),e("p",Dl,"KES "+v(F(n.value.totalVatPayable)),1)]),a(s(Ae),{class:"h-8 w-8 text-blue-200"})])]),e("div",Ol,[e("div",Hl,[e("div",null,[u[10]||(u[10]=e("p",{class:"text-sm text-purple-100"},"Total PAYE",-1)),e("p",Wl,"KES "+v(F(n.value.totalPaye)),1)]),a(s(Ne),{class:"h-8 w-8 text-purple-200"})])]),e("div",Bl,[e("div",zl,[e("div",null,[u[11]||(u[11]=e("p",{class:"text-sm text-orange-100"},"Total WHT",-1)),e("p",Yl,"KES "+v(F(n.value.totalWht)),1)]),a(s(ve),{class:"h-8 w-8 text-orange-200"})])]),e("div",Ll,[e("div",Ml,[e("div",null,[u[12]||(u[12]=e("p",{class:"text-sm text-teal-100"},"Total Statutory",-1)),e("p",Kl,"KES "+v(F(n.value.totalStatutory)),1)]),a(s(Re),{class:"h-8 w-8 text-teal-200"})])])])],64))}},Ql={class:"p-6"},Xl={class:"flex justify-between items-center mb-6"},Gl={class:"bg-white rounded-lg border shadow-sm"},Jl={class:"p-4 border-b"},Zl={class:"flex justify-between items-center"},es={class:"flex gap-2"},ts={class:"overflow-x-auto"},ls={class:"w-full"},ss={class:"divide-y divide-gray-200"},as={class:"px-4 py-3"},os={class:"font-medium"},ns={class:"text-sm text-gray-500"},is={class:"px-4 py-3"},rs={class:"px-4 py-3"},ds={class:"px-4 py-3"},us={class:"flex items-center gap-1"},cs={class:"px-4 py-3"},ps={class:"flex items-center gap-1"},ms={class:"px-4 py-3"},fs={class:"flex items-center gap-1"},_s={class:"px-4 py-3"},xs={class:"flex items-center gap-1"},vs={class:"px-4 py-3"},ys={class:"flex items-center gap-1"},gs={class:"px-4 py-3"},bs={class:"flex gap-1"},hs={key:0,class:"p-8 text-center text-gray-500"},Cs={__name:"TaxCompliance",setup(C){const c=ke(),n=O(!1),F=O(!1),r=O(null),w=W(()=>c.loading),u=W(()=>c.taxComplianceTrackers),g=O(""),V=O(""),l=O(""),U=O(""),I=O(""),B=W(()=>{const T=u.value,i=T.length,_=i>0?Math.round(T.reduce((N,p)=>N+(p.compliance_score||0),0)/i):0,Y=T.filter(N=>N.vat_return_filed).length,x=T.filter(N=>N.paye_return_filed).length,S=T.filter(N=>(N.compliance_score||0)>=80).length;return{total:i,avgScore:_,vatFiled:Y,payeFiled:x,compliant:S}}),$=()=>L(this,null,function*(){yield c.fetchTaxComplianceTrackers()}),d=()=>{r.value=null,F.value=!1,n.value=!0},b=T=>L(this,null,function*(){try{r.value=yield c.getTaxTrackerDetails(T.name),F.value=!0,n.value=!0}catch(i){console.error("Error fetching tracker details:",i)}}),G=T=>L(this,null,function*(){try{r.value=yield c.getTaxTrackerDetails(T.name),F.value=!0,n.value=!0}catch(i){console.error("Error fetching tracker details:",i)}}),z=()=>L(this,null,function*(){n.value=!1,yield $()}),J=T=>T>=80?"green":T>=60?"yellow":"red";return Ve(()=>L(this,null,function*(){yield $()})),(T,i)=>(m(),j("div",Ql,[e("div",Xl,[i[7]||(i[7]=e("div",null,[e("h1",{class:"text-2xl font-bold"},"Tax Compliance"),e("p",{class:"text-gray-600"},"Track tax compliance, filings, and payments across all tax types.")],-1)),a(s(P),{onClick:d,class:"flex items-center gap-2"},{default:f(()=>[a(s(ue),{class:"w-4 h-4"}),i[6]||(i[6]=k(" Create Tracker ",-1))]),_:1})]),a(ql,{stats:B.value},null,8,["stats"]),a(tl,{searchQuery:g.value,"onUpdate:searchQuery":i[0]||(i[0]=_=>g.value=_),selectedTaxPeriod:V.value,"onUpdate:selectedTaxPeriod":i[1]||(i[1]=_=>V.value=_),selectedComplianceScore:l.value,"onUpdate:selectedComplianceScore":i[2]||(i[2]=_=>l.value=_),selectedVatStatus:U.value,"onUpdate:selectedVatStatus":i[3]||(i[3]=_=>U.value=_),selectedPayeStatus:I.value,"onUpdate:selectedPayeStatus":i[4]||(i[4]=_=>I.value=_)},null,8,["searchQuery","selectedTaxPeriod","selectedComplianceScore","selectedVatStatus","selectedPayeStatus"]),e("div",Gl,[e("div",Jl,[e("div",Zl,[i[8]||(i[8]=e("h2",{class:"text-lg font-semibold"},"Tax Compliance Trackers",-1)),e("div",es,[a(s(P),{onClick:$,loading:w.value,variant:"outline",size:"sm"},{default:f(()=>[a(s(ye),{class:"w-4 h-4"})]),_:1},8,["loading"])])])]),e("div",ts,[e("table",ls,[i[14]||(i[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Tracker ID"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Tax Period"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Compliance Score"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"VAT"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"PAYE"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"WHT"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"NSSF"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"NHIF"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),e("tbody",ss,[(m(!0),j(te,null,ne(u.value,_=>(m(),j("tr",{key:_.name,class:"hover:bg-gray-50"},[e("td",as,[e("div",os,v(_.tracker_id),1),e("div",ns,v(_.name),1)]),e("td",is,[e("div",null,v(_.tax_period),1)]),e("td",rs,[a(s(H),{variant:J(_.compliance_score)},{default:f(()=>[k(v(_.compliance_score||0)+"% ",1)]),_:2},1032,["variant"])]),e("td",ds,[e("div",us,[_.vat_return_filed?(m(),h(s(q),{key:0,class:"w-4 h-4 text-green-500"})):(m(),h(s(R),{key:1,class:"w-4 h-4 text-red-500"})),i[9]||(i[9]=e("span",{class:"text-xs"},"Filed",-1))])]),e("td",cs,[e("div",ps,[_.paye_return_filed?(m(),h(s(q),{key:0,class:"w-4 h-4 text-green-500"})):(m(),h(s(R),{key:1,class:"w-4 h-4 text-red-500"})),i[10]||(i[10]=e("span",{class:"text-xs"},"Filed",-1))])]),e("td",ms,[e("div",fs,[_.wht_return_filed?(m(),h(s(q),{key:0,class:"w-4 h-4 text-green-500"})):(m(),h(s(R),{key:1,class:"w-4 h-4 text-red-500"})),i[11]||(i[11]=e("span",{class:"text-xs"},"Filed",-1))])]),e("td",_s,[e("div",xs,[_.nssf_return_filed?(m(),h(s(q),{key:0,class:"w-4 h-4 text-green-500"})):(m(),h(s(R),{key:1,class:"w-4 h-4 text-red-500"})),i[12]||(i[12]=e("span",{class:"text-xs"},"Filed",-1))])]),e("td",vs,[e("div",ys,[_.nhif_return_filed?(m(),h(s(q),{key:0,class:"w-4 h-4 text-green-500"})):(m(),h(s(R),{key:1,class:"w-4 h-4 text-red-500"})),i[13]||(i[13]=e("span",{class:"text-xs"},"Filed",-1))])]),e("td",gs,[e("div",bs,[a(s(P),{onClick:Y=>b(_),variant:"outline",size:"sm"},{default:f(()=>[a(s(je),{class:"w-4 h-4"})]),_:1},8,["onClick"]),a(s(P),{onClick:Y=>G(_),variant:"outline",size:"sm"},{default:f(()=>[a(s(Ee),{class:"w-4 h-4"})]),_:1},8,["onClick"])])])]))),128))])])]),u.value.length===0&&!w.value?(m(),j("div",hs,[a(s(de),{class:"w-12 h-12 mx-auto mb-4 text-gray-300"}),i[16]||(i[16]=e("p",null,"No tax compliance trackers found.",-1)),a(s(P),{onClick:d,class:"mt-4"},{default:f(()=>[...i[15]||(i[15]=[k(" Create Your First Tracker ",-1)])]),_:1})])):A("",!0)]),a(Yt,{show:n.value,"onUpdate:show":i[5]||(i[5]=_=>n.value=_),"tracker-data":r.value,"is-edit-mode":F.value,onSaved:z},null,8,["show","tracker-data","is-edit-mode"])]))}};export{Cs as default};
//# sourceMappingURL=TaxCompliance-Eopa7XV9.js.map
