import{af as S,r as s,c as i,ai as L,aj as V,ak as D,al as T,am as W,an as $,o as j,ao as B,b as h,d as b,R as H,g as m,ad as O,ae as z,h as v,e as c,j as f,_ as R,i as _,f as G,n as K,ap as M,t as C,D as q,aq as F}from"./index-DzpD5d1M.js";const J={class:"space-y-4"},Q={key:0,class:"text-red-500 text-sm mt-1"},X={key:1,class:"text-ink-green-3 text-sm mt-1"},Y={class:"flex justify-end space-x-2"},ee=S({__name:"InsertIframe",props:{editor:{}},setup(E){const n=E,r=s(!1),t=s(""),o=s(""),k=s(""),I=s("center"),p=s(640),g=s(360),y=s(),l=i(()=>{if(!t.value)return!1;try{if(t.value.trim().startsWith("<iframe")){const e=t.value.match(/src=["']([^"']+)["']/);return e!=null&&e[1]?L(e[1],{allowedDomains:V,HTMLAttributes:{}}):!1}return L(t.value,{allowedDomains:V,HTMLAttributes:{}})}catch(e){return!1}}),u=i(()=>{if(!t.value)return"";if(t.value.trim().startsWith("<iframe")){const e=t.value.match(/src=["']([^"']+)["']/);return e!=null&&e[1]?D(e[1]):t.value}return D(t.value)}),A=i(()=>{if(!t.value||!l.value)return{platform:"Generic",aspectRatio:9/16};const e=T(u.value),a=W(u.value);return{platform:(e==null?void 0:e.name)||"Generic",aspectRatio:a.ratio}}),N=i(()=>!t.value||!l.value?{width:640,height:360}:$(u.value,800));function P(){o.value="",t.value&&(l.value||(o.value="Please enter a supported URL or iframe embed code"))}function U(){r.value=!0,t.value="",o.value="",k.value="",I.value="center",p.value=640,g.value=360,F(()=>{var e,a;(a=(e=y.value)==null?void 0:e.el)==null||a.focus()})}i(()=>{if(t.value&&l.value){const e=N.value;p.value=e.width,g.value=e.height}});function w(){if(!t.value||!l.value)return;n.editor.commands.setIframe({src:u.value,width:p.value,height:g.value,title:k.value,align:I.value})?(r.value=!1,n.editor.commands.focus()):o.value="Failed to insert embed. Please check the URL and try again."}function x(e){var a;((a=e.detail)==null?void 0:a.editor)===n.editor&&U()}return j(()=>{n.editor.view.dom.addEventListener("iframe:open-dialog",x)}),B(()=>{n.editor.view.dom.removeEventListener("iframe:open-dialog",x)}),(e,a)=>(b(),h("div",null,[H(e.$slots,"default",O(z({onClick:U}))),m(f(q),{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=d=>r.value=d),options:{title:"Insert Embed",size:"md"}},{"body-content":v(()=>[c("div",J,[c("div",null,[a[3]||(a[3]=c("label",{class:"block text-sm font-medium text-ink-gray-7 mb-2"}," URL or Embed Code ",-1)),m(f(K),{ref_key:"urlInput",ref:y,modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=d=>t.value=d),placeholder:"https://youtube.com/watch?v=... or <iframe src=...>",onKeydown:M(w,["enter"]),onInput:P},null,8,["modelValue"]),o.value?(b(),h("p",Q,C(o.value),1)):t.value&&l.value?(b(),h("p",X," âœ“ Valid "+C(A.value.platform)+" URL ",1)):G("",!0)])])]),actions:v(()=>[c("div",Y,[m(f(R),{variant:"subtle",onClick:a[1]||(a[1]=d=>r.value=!1)},{default:v(()=>[...a[4]||(a[4]=[_("Cancel",-1)])]),_:1}),m(f(R),{variant:"solid",disabled:!t.value||!l.value,onClick:w},{default:v(()=>[...a[5]||(a[5]=[_(" Insert Embed ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]))}});export{ee as default};
//# sourceMappingURL=InsertIframe-B84oESJH.js.map
