var B=(h,x,_)=>new Promise((d,y)=>{var t=v=>{try{k(_.next(v))}catch(w){y(w)}},T=v=>{try{k(_.throw(v))}catch(w){y(w)}},k=v=>v.done?d(v.value):Promise.resolve(v.value).then(t,T);k((_=_.apply(h,x)).next())});import{a3 as z,r as D,x as E,a as P,c as V,o as K,B as U,b as a,d as s,e,g as b,h as c,j as u,A as q,_ as H,t as i,i as p,l as g,f as n,k as R,a2 as $,V as G,F as f,q as M,p as J}from"./index-DyBJn5r4.js";const Q=z("auditReports",()=>{const h=D(null),x=D(!1);return{currentReport:h,loading:x,fetchReportDetail:d=>B(void 0,null,function*(){x.value=!0;try{const y=yield E({url:"frappe.client.get",params:{doctype:"Audit Report",name:d}}).fetch();return h.value=y,y}catch(y){return console.error("Failed to fetch report:",y),h.value=null,null}finally{x.value=!1}})}}),W={class:"space-y-6"},X={class:"flex items-center justify-between"},Y={class:"flex items-center space-x-3"},Z={class:"text-2xl font-bold text-gray-900"},ee={class:"text-gray-600 mt-1"},te={class:"flex items-center space-x-3"},se={key:0,class:"flex justify-center items-center py-12"},oe={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},re={class:"bg-white rounded-lg border border-gray-200 p-4"},ae={class:"text-lg font-bold text-gray-900"},ie={class:"bg-white rounded-lg border border-gray-200 p-4"},ne={key:1,class:"text-gray-400"},le={class:"bg-white rounded-lg border border-gray-200 p-4"},de={class:"text-lg font-bold text-gray-900"},ue={class:"bg-white rounded-lg border border-gray-200 p-4"},ce={class:"text-lg font-bold text-gray-900"},pe={class:"bg-white rounded-lg border border-gray-200"},_e={class:"border-b border-gray-200"},ye={class:"flex -mb-px overflow-x-auto"},ve=["onClick"],me={class:"p-6"},ge={key:0,class:"space-y-6"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},be={class:"space-y-3"},fe={class:"font-medium"},he={key:1,class:"text-gray-400"},ke={class:"font-medium"},we={class:"space-y-3"},Re={class:"font-medium"},Me={class:"font-medium"},Le={class:"font-medium"},He={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-3"},Te={class:"text-sm text-green-800"},De={key:1,class:"prose prose-sm max-w-none"},Ce=["innerHTML"],Se={key:1,class:"text-gray-500"},Ne={key:2,class:"mt-6"},Ae=["innerHTML"],Fe={key:3,class:"mt-6"},Be=["innerHTML"],Ve={key:4,class:"mt-6"},$e=["innerHTML"],Oe={key:2,class:"space-y-4"},je={key:0},Ie={class:"flex items-start justify-between"},ze={class:"font-medium text-gray-900"},Ee={key:0,class:"text-sm text-gray-600 mt-1"},Pe={key:1,class:"text-gray-500 text-center py-6"},Ke={key:3,class:"space-y-4"},Ue={key:0},qe={class:"w-full"},Ge={class:"px-4 py-2 text-sm text-gray-500"},Je={class:"px-4 py-2 text-sm text-gray-900"},Qe={class:"px-4 py-2"},We={class:"px-4 py-2"},Xe={key:1,class:"text-gray-500 text-center py-6"},Ye={key:4,class:"space-y-6"},Ze={key:0,class:"bg-gray-50 rounded-lg p-6"},et={key:1},tt=["innerHTML"],st={key:2},ot=["innerHTML"],rt={key:3},at=["innerHTML"],it={key:4},nt=["innerHTML"],lt={key:5,class:"space-y-4"},dt={key:0},ut={class:"w-full"},ct={class:"px-4 py-2 text-sm text-gray-900"},pt={class:"px-4 py-2 text-sm text-gray-600"},_t={class:"px-4 py-2 text-sm text-gray-600"},yt={key:1,class:"text-gray-500 text-center py-6"},vt={key:6,class:"space-y-4"},mt={key:0},gt={class:"flex items-center justify-between"},xt={class:"font-medium text-gray-900"},bt={key:0,class:"text-sm text-gray-600 mt-1"},ft={key:1,class:"text-gray-500 text-center py-6"},ht={key:7,class:"space-y-4"},kt={key:0},wt={class:"space-y-3"},Rt={class:"text-sm font-medium text-gray-900"},Mt={class:"text-sm text-gray-600"},Lt={class:"text-xs text-gray-500 mt-1"},Ht={key:1,class:"text-gray-500 text-center py-6"},Tt={key:2,class:"text-center py-12"},Nt={__name:"AuditReportDetail",setup(h){const x=P(),_=Q(),d=D("overview"),y=V(()=>_.loading),t=V(()=>_.currentReport),T=[{id:"overview",label:"Overview"},{id:"summary",label:"Executive Summary"},{id:"key_findings",label:"Key Findings"},{id:"detailed_findings",label:"Detailed Findings"},{id:"opinion",label:"Opinion & Conclusion"},{id:"distribution",label:"Distribution"},{id:"appendices",label:"Appendices"},{id:"revisions",label:"Revision History"}],k=()=>{_.fetchReportDetail(x.params.id)},v=l=>({Draft:"secondary","Under Review":"warning",Finalized:"info",Issued:"success"})[l]||"secondary",w=l=>({Satisfactory:"success","Satisfactory with Minor Improvements":"info","Needs Improvement":"warning",Unsatisfactory:"danger"})[l]||"secondary",C=l=>({Critical:"danger",High:"warning",Medium:"info",Low:"secondary"})[l]||"secondary",L=l=>l?new Date(l).toLocaleDateString():"-",O=()=>{var l;(l=t.value)!=null&&l.report_file&&window.open(t.value.report_file)},j=l=>{l&&window.open(l)};return K(()=>{k()}),(l,o)=>{var S,N,A,F;const I=U("router-link");return s(),a("div",W,[e("div",X,[e("div",Y,[b(u(H),{variant:"ghost",onClick:o[0]||(o[0]=r=>l.$router.push("/reports/audit-reports"))},{default:c(()=>[b(u(q),{class:"h-4 w-4"})]),_:1}),e("div",null,[e("h1",Z,i(((S=t.value)==null?void 0:S.report_title)||"Audit Report"),1),e("p",ee,[p(i(((N=t.value)==null?void 0:N.report_type)||"")+" ",1),t.value?(s(),g(u(R),{key:0,variant:v(t.value.report_status),class:"ml-2"},{default:c(()=>[p(i(t.value.report_status),1)]),_:1},8,["variant"])):n("",!0)])])]),e("div",te,[(A=t.value)!=null&&A.report_file?(s(),g(u(H),{key:0,variant:"outline",onClick:O},{default:c(()=>[b(u($),{class:"h-4 w-4 mr-2"}),o[1]||(o[1]=p(" Download ",-1))]),_:1})):n("",!0)])]),y.value?(s(),a("div",se,[b(u(G),{class:"h-8 w-8"})])):t.value?(s(),a(f,{key:1},[e("div",oe,[e("div",re,[o[2]||(o[2]=e("p",{class:"text-sm text-gray-600"},"Report Date",-1)),e("p",ae,i(L(t.value.report_date)),1)]),e("div",ie,[o[3]||(o[3]=e("p",{class:"text-sm text-gray-600"},"Opinion",-1)),t.value.overall_audit_opinion?(s(),g(u(R),{key:0,variant:w(t.value.overall_audit_opinion)},{default:c(()=>[p(i(t.value.overall_audit_opinion),1)]),_:1},8,["variant"])):(s(),a("span",ne,"-"))]),e("div",le,[o[4]||(o[4]=e("p",{class:"text-sm text-gray-600"},"Key Findings",-1)),e("p",de,i(((F=t.value.key_findings_summary)==null?void 0:F.length)||0),1)]),e("div",ue,[o[5]||(o[5]=e("p",{class:"text-sm text-gray-600"},"Version",-1)),e("p",ce,i(t.value.version_number||"1.0"),1)])]),e("div",pe,[e("div",_e,[e("nav",ye,[(s(),a(f,null,M(T,r=>e("button",{key:r.id,onClick:m=>d.value=r.id,class:J(["px-6 py-3 text-sm font-medium border-b-2 whitespace-nowrap",d.value===r.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},i(r.label),11,ve)),64))])]),e("div",me,[d.value==="overview"?(s(),a("div",ge,[e("div",xe,[e("div",be,[e("div",null,[o[6]||(o[6]=e("p",{class:"text-sm text-gray-600"},"Report ID",-1)),e("p",fe,i(t.value.report_id),1)]),e("div",null,[o[7]||(o[7]=e("p",{class:"text-sm text-gray-600"},"Engagement",-1)),t.value.engagement_reference?(s(),g(I,{key:0,to:`/engagements/${t.value.engagement_reference}`,class:"text-blue-600 hover:underline font-medium"},{default:c(()=>[p(i(t.value.engagement_reference),1)]),_:1},8,["to"])):(s(),a("span",he,"-"))]),e("div",null,[o[8]||(o[8]=e("p",{class:"text-sm text-gray-600"},"Report Period",-1)),e("p",ke,i(t.value.report_period||"-"),1)])]),e("div",we,[e("div",null,[o[9]||(o[9]=e("p",{class:"text-sm text-gray-600"},"Prepared By",-1)),e("p",Re,i(t.value.prepared_by||"-"),1)]),e("div",null,[o[10]||(o[10]=e("p",{class:"text-sm text-gray-600"},"Reviewed By",-1)),e("p",Me,i(t.value.reviewed_by||"-"),1)]),e("div",null,[o[11]||(o[11]=e("p",{class:"text-sm text-gray-600"},"Approved By",-1)),e("p",Le,i(t.value.approved_by||"-"),1)])])]),t.value.management_acknowledgement?(s(),a("div",He,[e("p",Te," Management acknowledged on "+i(L(t.value.management_ack_date))+" by "+i(t.value.management_ack_by),1)])):n("",!0)])):n("",!0),d.value==="summary"?(s(),a("div",De,[t.value.executive_summary?(s(),a("div",{key:0,innerHTML:t.value.executive_summary},null,8,Ce)):(s(),a("p",Se,"No executive summary provided.")),t.value.background?(s(),a("div",Ne,[o[12]||(o[12]=e("h3",null,"Background",-1)),e("div",{innerHTML:t.value.background},null,8,Ae)])):n("",!0),t.value.audit_scope?(s(),a("div",Fe,[o[13]||(o[13]=e("h3",null,"Scope",-1)),e("div",{innerHTML:t.value.audit_scope},null,8,Be)])):n("",!0),t.value.methodology?(s(),a("div",Ve,[o[14]||(o[14]=e("h3",null,"Methodology",-1)),e("div",{innerHTML:t.value.methodology},null,8,$e)])):n("",!0)])):n("",!0),d.value==="key_findings"?(s(),a("div",Oe,[t.value.key_findings_summary&&t.value.key_findings_summary.length>0?(s(),a("div",je,[(s(!0),a(f,null,M(t.value.key_findings_summary,(r,m)=>(s(),a("div",{key:r.name||m,class:"border border-gray-200 rounded-lg p-4"},[e("div",Ie,[e("div",null,[e("p",ze,i(r.finding_title||r.title||`Finding ${m+1}`),1),r.summary?(s(),a("p",Ee,i(r.summary),1)):n("",!0)]),r.severity||r.risk_rating?(s(),g(u(R),{key:0,variant:C(r.severity||r.risk_rating)},{default:c(()=>[p(i(r.severity||r.risk_rating),1)]),_:2},1032,["variant"])):n("",!0)])]))),128))])):(s(),a("p",Pe,"No key findings recorded."))])):n("",!0),d.value==="detailed_findings"?(s(),a("div",Ke,[t.value.detailed_findings&&t.value.detailed_findings.length>0?(s(),a("div",Ue,[e("table",qe,[o[15]||(o[15]=e("thead",null,[e("tr",{class:"border-b border-gray-200 bg-gray-50"},[e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"#"),e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"Finding"),e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"Severity"),e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"Status")])],-1)),e("tbody",null,[(s(!0),a(f,null,M(t.value.detailed_findings,(r,m)=>(s(),a("tr",{key:r.name||m,class:"border-b border-gray-100"},[e("td",Ge,i(m+1),1),e("td",Je,i(r.finding_title||r.title),1),e("td",Qe,[r.severity?(s(),g(u(R),{key:0,variant:C(r.severity)},{default:c(()=>[p(i(r.severity),1)]),_:2},1032,["variant"])):n("",!0)]),e("td",We,[r.status?(s(),g(u(R),{key:0,variant:"secondary"},{default:c(()=>[p(i(r.status),1)]),_:2},1024)):n("",!0)])]))),128))])])])):(s(),a("p",Xe,"No detailed findings recorded."))])):n("",!0),d.value==="opinion"?(s(),a("div",Ye,[t.value.overall_audit_opinion?(s(),a("div",Ze,[o[16]||(o[16]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Overall Audit Opinion",-1)),b(u(R),{variant:w(t.value.overall_audit_opinion),class:"text-base"},{default:c(()=>[p(i(t.value.overall_audit_opinion),1)]),_:1},8,["variant"])])):n("",!0),t.value.opinion_basis?(s(),a("div",et,[o[17]||(o[17]=e("h3",{class:"font-semibold text-gray-900 mb-2"},"Basis for Opinion",-1)),e("div",{class:"prose prose-sm max-w-none",innerHTML:t.value.opinion_basis},null,8,tt)])):n("",!0),t.value.positive_observations?(s(),a("div",st,[o[18]||(o[18]=e("h3",{class:"font-semibold text-gray-900 mb-2"},"Positive Observations",-1)),e("div",{class:"prose prose-sm max-w-none",innerHTML:t.value.positive_observations},null,8,ot)])):n("",!0),t.value.areas_for_improvement?(s(),a("div",rt,[o[19]||(o[19]=e("h3",{class:"font-semibold text-gray-900 mb-2"},"Areas for Improvement",-1)),e("div",{class:"prose prose-sm max-w-none",innerHTML:t.value.areas_for_improvement},null,8,at)])):n("",!0),t.value.conclusion?(s(),a("div",it,[o[20]||(o[20]=e("h3",{class:"font-semibold text-gray-900 mb-2"},"Conclusion",-1)),e("div",{class:"prose prose-sm max-w-none",innerHTML:t.value.conclusion},null,8,nt)])):n("",!0)])):n("",!0),d.value==="distribution"?(s(),a("div",lt,[t.value.distribution_list&&t.value.distribution_list.length>0?(s(),a("div",dt,[e("table",ut,[o[21]||(o[21]=e("thead",null,[e("tr",{class:"border-b border-gray-200 bg-gray-50"},[e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"Recipient"),e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"Role"),e("th",{class:"text-left text-xs font-medium text-gray-500 uppercase px-4 py-2"},"Distributed")])],-1)),e("tbody",null,[(s(!0),a(f,null,M(t.value.distribution_list,r=>(s(),a("tr",{key:r.name,class:"border-b border-gray-100"},[e("td",ct,i(r.recipient||r.user),1),e("td",pt,i(r.role||"-"),1),e("td",_t,i(r.distributed_date?L(r.distributed_date):"-"),1)]))),128))])])])):(s(),a("p",yt,"No distribution list defined."))])):n("",!0),d.value==="appendices"?(s(),a("div",vt,[t.value.appendices&&t.value.appendices.length>0?(s(),a("div",mt,[(s(!0),a(f,null,M(t.value.appendices,(r,m)=>(s(),a("div",{key:r.name||m,class:"border border-gray-200 rounded-lg p-4"},[e("div",gt,[e("div",null,[e("p",xt,i(r.title||`Appendix ${m+1}`),1),r.description?(s(),a("p",bt,i(r.description),1)):n("",!0)]),r.file?(s(),g(u(H),{key:0,variant:"outline",size:"sm",onClick:Dt=>j(r.file)},{default:c(()=>[b(u($),{class:"h-4 w-4"})]),_:1},8,["onClick"])):n("",!0)])]))),128))])):(s(),a("p",ft,"No appendices attached."))])):n("",!0),d.value==="revisions"?(s(),a("div",ht,[t.value.revision_history&&t.value.revision_history.length>0?(s(),a("div",kt,[e("div",wt,[(s(!0),a(f,null,M(t.value.revision_history,r=>(s(),a("div",{key:r.name,class:"flex items-start space-x-3 border-l-2 border-blue-200 pl-4 py-2"},[e("div",null,[e("p",Rt,"Version "+i(r.version||"-"),1),e("p",Mt,i(r.description||r.changes||"No description"),1),e("p",Lt,i(r.revised_by||"-")+" on "+i(L(r.revision_date||r.creation)),1)])]))),128))])])):(s(),a("p",Ht,"No revision history."))])):n("",!0)])])],64)):(s(),a("div",Tt,[o[23]||(o[23]=e("p",{class:"text-gray-600"},"Failed to load report details.",-1)),b(u(H),{onClick:k,class:"mt-4"},{default:c(()=>[...o[22]||(o[22]=[p("Retry",-1)])]),_:1})]))])}}};export{Nt as default};
//# sourceMappingURL=AuditReportDetail-CYROlZ-g.js.map
