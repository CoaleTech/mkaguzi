var fe=Object.defineProperty,be=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var K=(x,f,k)=>f in x?fe(x,f,{enumerable:!0,configurable:!0,writable:!0,value:k}):x[f]=k,L=(x,f)=>{for(var k in f||(f={}))Ve.call(f,k)&&K(x,k,f[k]);if(W)for(var k of W(f))we.call(f,k)&&K(x,k,f[k]);return x},X=(x,f)=>be(x,xe(f));var z=(x,f,k)=>new Promise((y,a)=>{var T=V=>{try{d(k.next(V))}catch(p){a(p)}},$=V=>{try{d(k.throw(V))}catch(p){a(p)}},d=V=>V.done?y(V.value):Promise.resolve(V.value).then(T,$);d((k=k.apply(x,f)).next())});import{r as I,j as H,l as b,p as m,q as o,am as he,s as l,F as D,x as E,A as g,B as Ce,u as n,v as t,z as _,ap as Ae,ab as Re,w as Ue,Q as Se,H as R,y as U,ac as $e,aq as Me}from"./vue-DciwFjI_.js";import{_ as Ie,c as O,D as se,a as C,A as De,b as u,d as F}from"./index-qIC3Tfxg.js";import{C as S}from"./Card-BkaRUg6O.js";import{aL as Ee,aa as Z,n as Pe,ab as ee,N,ad as Te}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const qe={class:"risk-heat-map"},je={class:"grid grid-cols-6 gap-1 max-w-md mx-auto"},ze={class:"text-center text-sm font-medium text-gray-700 p-2 flex items-center justify-center"},Fe=["onClick"],Oe={class:"space-y-4 max-h-96 overflow-y-auto"},Be={key:0,class:"text-center text-gray-500 py-8"},Le={key:1,class:"space-y-3"},Ne={class:"flex items-start justify-between"},He={class:"flex-1"},Je={class:"font-medium text-sm"},Ye={class:"text-sm text-gray-600 mt-1"},Qe={class:"text-xs text-gray-500 mt-1"},Ge={__name:"RiskHeatMapGrid",props:{risks:{type:Array,default:()=>[]},heatMapData:{type:Object,default:()=>({})}},setup(x){const f=x,k=I(!1),y=I({likelihood:0,impact:0}),a=H(()=>!y.value.likelihood||!y.value.impact?[]:f.risks.filter(p=>p.likelihood_score===y.value.likelihood&&p.impact_score===y.value.impact)),T=(p,r)=>{const c=p*r,P=$(p,r);let M="border-gray-200";return c>=19?M="bg-red-100 border-red-300 text-red-800":c>=13?M="bg-orange-100 border-orange-300 text-orange-800":c>=7?M="bg-yellow-100 border-yellow-300 text-yellow-800":M="bg-green-100 border-green-300 text-green-800",P>0&&(M+=" font-bold"),M},$=(p,r)=>{const c=`${p}-${r}`;return f.heatMapData[c]||0},d=(p,r)=>{y.value={likelihood:p,impact:r},k.value=!0},V=p=>p>=20?"destructive":p>=15?"warning":p>=10?"secondary":"success";return(p,r)=>(m(),b("div",qe,[o("div",je,[r[1]||(r[1]=o("div",{class:"col-span-1"},null,-1)),(m(),b(D,null,E(5,c=>o("div",{key:`impact-${c}`,class:"text-center text-sm font-medium text-gray-700 p-2"},g(c),1)),64)),(m(),b(D,null,E(5,c=>o("div",{key:`likelihood-${c}`,class:"contents"},[o("div",ze,g(c),1),(m(),b(D,null,E(5,P=>o("div",{key:`cell-${c}-${P}`,class:Ce([T(c,P),"aspect-square rounded border cursor-pointer transition-all duration-200 hover:scale-105 flex items-center justify-center text-xs font-medium"]),onClick:M=>d(c,P)},g($(c,P)),11,Fe)),64))])),64))]),r[2]||(r[2]=he('<div class="flex justify-center mt-6 space-x-4" data-v-295e4ba7><div class="flex items-center space-x-2" data-v-295e4ba7><div class="w-4 h-4 bg-green-100 border border-green-300 rounded" data-v-295e4ba7></div><span class="text-sm text-gray-600" data-v-295e4ba7>Low (1-6)</span></div><div class="flex items-center space-x-2" data-v-295e4ba7><div class="w-4 h-4 bg-yellow-100 border border-yellow-300 rounded" data-v-295e4ba7></div><span class="text-sm text-gray-600" data-v-295e4ba7>Medium (7-12)</span></div><div class="flex items-center space-x-2" data-v-295e4ba7><div class="w-4 h-4 bg-orange-100 border border-orange-300 rounded" data-v-295e4ba7></div><span class="text-sm text-gray-600" data-v-295e4ba7>High (13-18)</span></div><div class="flex items-center space-x-2" data-v-295e4ba7><div class="w-4 h-4 bg-red-100 border border-red-300 rounded" data-v-295e4ba7></div><span class="text-sm text-gray-600" data-v-295e4ba7>Critical (19-25)</span></div></div><div class="text-center mt-4" data-v-295e4ba7><div class="grid grid-cols-2 gap-8 max-w-md mx-auto" data-v-295e4ba7><div class="text-sm text-gray-600" data-v-295e4ba7><div class="font-medium" data-v-295e4ba7>Likelihood</div><div class="text-xs" data-v-295e4ba7>1 = Rare, 5 = Almost Certain</div></div><div class="text-sm text-gray-600" data-v-295e4ba7><div class="font-medium" data-v-295e4ba7>Impact</div><div class="text-xs" data-v-295e4ba7>1 = Minor, 5 = Catastrophic</div></div></div></div>',2)),l(t(se),{modelValue:k.value,"onUpdate:modelValue":r[0]||(r[0]=c=>k.value=c)},{title:n(()=>[_("Risks in "+g(y.value.likelihood)+"x"+g(y.value.impact)+" Cell",1)]),default:n(()=>[o("div",Oe,[a.value.length===0?(m(),b("div",Be," No risks in this cell ")):(m(),b("div",Le,[(m(!0),b(D,null,E(a.value,c=>(m(),b("div",{key:c.risk_id,class:"p-3 border rounded-lg"},[o("div",Ne,[o("div",He,[o("div",Je,g(c.risk_id),1),o("div",Ye,g(c.risk_description),1),o("div",Qe," Category: "+g(c.risk_category),1)]),l(t(O),{variant:V(c.inherent_risk_score),class:"ml-2"},{default:n(()=>[_(g(c.inherent_risk_score)+"/25 ",1)]),_:2},1032,["variant"])])]))),128))]))])]),_:1},8,["modelValue"])]))}},We=Ie(Ge,[["__scopeId","data-v-295e4ba7"]]),Ke={class:"space-y-6"},Xe={class:"flex items-center justify-between"},Ze={class:"flex items-center space-x-4"},es={class:"text-sm text-gray-600"},ss={class:"flex items-center space-x-2"},as={key:0,class:"flex justify-center items-center py-12"},ts={key:1,class:"space-y-6"},ls={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},os={class:"space-y-4"},rs={class:"flex items-end space-x-2"},is={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ns={class:"space-y-4"},ds=["id","value","disabled"],us=["for"],ms={class:"space-y-4"},vs={class:"flex justify-between items-center"},ps={class:"overflow-x-auto"},cs={class:"min-w-full divide-y divide-gray-200"},_s={class:"bg-white divide-y divide-gray-200"},ys={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},gs={class:"px-6 py-4 text-sm text-gray-900"},ks={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},fs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},bs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xs={class:"px-6 py-4 whitespace-nowrap"},Vs={class:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},ws={class:"flex justify-center"},hs={class:"space-y-4"},Cs={class:"flex justify-between items-center"},As={class:"space-y-4"},Rs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Us={class:"space-y-4"},Ss={class:"flex items-center justify-between"},$s={class:"font-semibold"},Ms={class:"text-sm text-gray-600"},Is={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ds={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Es={class:"flex justify-end space-x-4"},Ps={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ts={class:"space-y-4"},qs={class:"grid grid-cols-2 gap-4"},Hs={__name:"RiskAssessmentDetail",props:{assessmentId:{type:String,default:null},mode:{type:String,default:"view"}},setup(x){const f=Ae(),k=Re(),y=x,a=I(null),T=I(!0),$=I(!1),d=I(y.mode==="edit"||y.mode==="new"),V=I(!1),p=I(null),r=I({risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""}),c=[{label:"Annual",value:"Annual"},{label:"Mid-Year",value:"Mid-Year"},{label:"Quarterly",value:"Quarterly"},{label:"Ad-hoc",value:"Ad-hoc"}],P=[{label:"Planning",value:"Planning"},{label:"In Progress",value:"In Progress"},{label:"Review",value:"Review"},{label:"Finalized",value:"Finalized"},{label:"Approved",value:"Approved"}],M=[{label:"Interview",value:"interview"},{label:"Workshop",value:"workshop"},{label:"Survey",value:"survey"},{label:"Document Review",value:"document_review"},{label:"Data Analysis",value:"data_analysis"}],ae=[{label:"Planned",value:"Planned"},{label:"In Progress",value:"In Progress"},{label:"Completed",value:"Completed"},{label:"Overdue",value:"Overdue"}],te=[{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],le=H(()=>{var i;return((i=a.value)==null?void 0:i.status)!=="Approved"}),oe=H(()=>!0),B=()=>z(this,null,function*(){try{if(T.value=!0,y.mode==="new")a.value={assessment_id:"",assessment_name:"",assessment_date:new Date().toISOString().split("T")[0],fiscal_year:new Date().getFullYear().toString(),assessment_period:"Annual",assessment_team:[],assessment_scope:"",methodology:[],status:"Planning",risk_register:[],action_plan:[],risk_heat_map_data:{},top_risks:[],assessment_summary:"",recommendations:"",prepared_by:"",reviewed_by:"",approved_by:"",approval_date:""};else{const i=y.assessmentId||f.params.id;if(!i)throw new Error("Assessment ID is required");const e=yield fetch(`/api/resource/Risk Assessment/${i}`);if(e.ok)a.value=yield e.json();else throw new Error("Failed to load assessment")}}catch(i){if(console.error("Error loading assessment:",i),y.mode!=="new"){const e=y.assessmentId||f.params.id;a.value={name:e,assessment_id:`RA-2024-${String(e).padStart(4,"0")}`,assessment_name:"Annual Risk Assessment 2024",assessment_date:"2024-01-15",fiscal_year:"2024",assessment_period:"Annual",assessment_team:[{team_member:"John Doe",role:"Lead"},{team_member:"Jane Smith",role:"Member"}],assessment_scope:"Comprehensive risk assessment covering all business units and processes.",methodology:["interview","workshop","document_review"],status:"In Progress",risk_register:[{risk_id:"R001",risk_title:"Financial reporting errors",risk_description:"Financial reporting errors due to manual processes",risk_category:"Operational",risk_subcategory:"Financial Reporting",auditable_entity:"Finance Department",threat_source:"Human error",vulnerability:"Manual data entry",likelihood_score:4,impact_score:5,inherent_risk_score:20,control_effectiveness:"Adequate",existing_controls:"Basic review process",risk_owner:"Finance Manager",risk_response:"Mitigate",target_risk_score:10,likelihood_rationale:"High volume of manual entries",impact_rationale:"Material impact on financial statements"}],action_plan:[{action_id:"A001",action_description:"Implement automated financial reporting system",action_type:"System Enhancement",priority:"High",responsible_party:"IT Department",target_completion_date:"2024-06-30",estimated_cost:5e4,resource_required:"IT team and software licenses",status:"In Progress",actual_completion_date:"",effectiveness_review_date:"",review_notes:""}],risk_heat_map_data:{},top_risks:[],assessment_summary:"The assessment identified several key risks...",recommendations:"Implement automated systems and enhance training...",prepared_by:"John Doe",reviewed_by:"",approved_by:"",approval_date:""}}}finally{T.value=!1}}),re=()=>{y.mode==="view"?k.push(`/audit-planning/risk-assessment/${y.assessmentId||f.params.id}/edit`):Y()},J=()=>z(this,null,function*(){try{if($.value=!0,a.value.risk_register.forEach(e=>{e.inherent_risk_score=e.likelihood_score*e.impact_score}),y.mode==="new"&&!a.value.assessment_id){const e=a.value.fiscal_year.slice(-2),A=Math.floor(Math.random()*1e3)+1;a.value.assessment_id=`RA-${a.value.fiscal_year}-${String(A).padStart(4,"0")}`}let i;if(y.mode==="new")i=yield fetch("/api/resource/Risk Assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.value)});else{const e=y.assessmentId||f.params.id;i=yield fetch(`/api/resource/Risk Assessment/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.value)})}if(i.ok){const e=yield i.json();y.mode==="new"?k.push(`/audit-planning/risk-assessment/${e.name}`):(d.value=!1,yield B())}else throw new Error("Failed to save changes")}catch(i){console.error("Error saving changes:",i)}finally{$.value=!1}}),Y=()=>{y.mode==="new"?k.push("/audit-planning/risk-assessment"):y.mode==="edit"?k.push(`/audit-planning/risk-assessment/${y.assessmentId||f.params.id}`):(d.value=!1,B())},ie=()=>z(this,null,function*(){try{a.value.status="Approved",a.value.approved_by="Current User",a.value.approval_date=new Date().toISOString().split("T")[0],yield J()}catch(i){console.error("Error approving assessment:",i)}}),ne=()=>{a.value.assessment_team.push({team_member:"",role:""})},de=i=>{a.value.assessment_team.splice(i,1)},ue=()=>{p.value=null,r.value={risk_id:`R${String(a.value.risk_register.length+1).padStart(3,"0")}`,risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""},V.value=!0},me=i=>{p.value=i,r.value=L({},a.value.risk_register[i]),V.value=!0},ve=i=>{a.value.risk_register.splice(i,1)},pe=()=>{const i=X(L({},r.value),{inherent_risk_score:r.value.likelihood_score*r.value.impact_score});p.value!==null?a.value.risk_register[p.value]=i:a.value.risk_register.push(i),Q()},Q=()=>{V.value=!1,p.value=null,r.value={risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""}},ce=()=>{a.value.action_plan.push({action_id:`A${String(a.value.action_plan.length+1).padStart(3,"0")}`,action_description:"",action_type:"",priority:"Medium",responsible_party:"",target_completion_date:"",estimated_cost:0,resource_required:"",status:"Not Started",actual_completion_date:"",effectiveness_review_date:"",review_notes:""})},_e=i=>({Planning:"secondary","In Progress":"warning",Review:"info",Finalized:"success",Approved:"success"})[i]||"secondary",G=i=>i>=20?"destructive":i>=15?"warning":i>=10?"secondary":"success",ye=i=>i>=20?"Critical":i>=15?"High":i>=10?"Medium":"Low",ge=()=>{var i,e,A,q,j,s,w,v;return a.value?{assessmentId:a.value.name||a.value.assessment_id,assessmentName:a.value.assessment_name,fiscalYear:a.value.fiscal_year,assessmentPeriod:a.value.assessment_period,status:a.value.status,scope:a.value.assessment_scope,methodology:a.value.methodology,teamMembers:((i=a.value.assessment_team)==null?void 0:i.length)||0,riskCount:((e=a.value.risk_register)==null?void 0:e.length)||0,actionCount:((A=a.value.action_plan)==null?void 0:A.length)||0,highRiskCount:((q=a.value.risk_register)==null?void 0:q.filter(h=>h.inherent_risk_score>=15).length)||0,criticalRiskCount:((j=a.value.risk_register)==null?void 0:j.filter(h=>h.inherent_risk_score>=20).length)||0,assessmentSummary:a.value.assessment_summary,recommendations:a.value.recommendations,preparedBy:a.value.prepared_by,topRisks:((s=a.value.top_risks)==null?void 0:s.slice(0,3).map(h=>({id:h.risk_id,title:h.risk_title,score:h.inherent_risk_score,category:h.risk_category,owner:h.risk_owner})))||[],pendingActions:((w=a.value.action_plan)==null?void 0:w.filter(h=>h.status!=="Completed").length)||0,completedActions:((v=a.value.action_plan)==null?void 0:v.filter(h=>h.status==="Completed").length)||0}:{}};Ue(()=>{var i;return(i=a.value)==null?void 0:i.risk_register},i=>{i&&ke()},{deep:!0});const ke=()=>{if(!a.value)return;const i={};a.value.risk_register.forEach(e=>{const A=`${e.likelihood_score}-${e.impact_score}`;i[A]=(i[A]||0)+1}),a.value.risk_heat_map_data=i,a.value.top_risks=[...a.value.risk_register].sort((e,A)=>A.inherent_risk_score-e.inherent_risk_score).slice(0,5)};return Se(()=>{B()}),(i,e)=>{var A,q,j;return m(),b("div",Ke,[o("div",Xe,[o("div",Ze,[l(t(C),{variant:"ghost",size:"sm",onClick:e[0]||(e[0]=s=>i.$router.go(-1)),class:"flex items-center space-x-2"},{default:n(()=>[l(t(Ee),{class:"h-4 w-4"}),e[30]||(e[30]=o("span",null,"Back",-1))]),_:1}),o("div",null,[e[31]||(e[31]=o("h1",{class:"text-2xl font-bold text-gray-900"}," Risk Assessment Details ",-1)),o("p",es,g(((A=a.value)==null?void 0:A.assessment_id)||"Loading..."),1)])]),o("div",ss,[l(t(O),{variant:_e((q=a.value)==null?void 0:q.status),class:"capitalize"},{default:n(()=>{var s;return[_(g(((s=a.value)==null?void 0:s.status)||"Draft"),1)]}),_:1},8,["variant"]),le.value?(m(),U(t(C),{key:0,variant:"outline",size:"sm",onClick:re},{default:n(()=>[l(t(Z),{class:"h-4 w-4 mr-2"}),_(" "+g(d.value?"Cancel":"Edit"),1)]),_:1})):R("",!0),oe.value&&((j=a.value)==null?void 0:j.status)==="Review"?(m(),U(t(C),{key:1,variant:"default",size:"sm",onClick:ie},{default:n(()=>[l(t(Pe),{class:"h-4 w-4 mr-2"}),e[32]||(e[32]=_(" Approve ",-1))]),_:1})):R("",!0),a.value?(m(),U(De,{key:2,contextType:"risk-assessment",contextData:ge(),capability:"risk-analysis"},null,8,["contextData"])):R("",!0)])]),T.value?(m(),b("div",as,[...e[33]||(e[33]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):a.value?(m(),b("div",ts,[l(t(S),null,{title:n(()=>[...e[34]||(e[34]=[_("Assessment Information",-1)])]),default:n(()=>[o("div",ls,[l(t(u),{label:"Assessment ID",value:a.value.assessment_id,readonly:""},null,8,["value"]),l(t(u),{label:"Assessment Name",modelValue:a.value.assessment_name,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.assessment_name=s),readonly:!d.value,required:""},null,8,["modelValue","readonly"]),l(t(u),{label:"Fiscal Year",modelValue:a.value.fiscal_year,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.fiscal_year=s),readonly:!d.value,required:""},null,8,["modelValue","readonly"]),l(t(u),{label:"Assessment Date",modelValue:a.value.assessment_date,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.assessment_date=s),type:"date",readonly:!d.value,required:""},null,8,["modelValue","readonly"]),l(t(u),{label:"Assessment Period",modelValue:a.value.assessment_period,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.assessment_period=s),readonly:!d.value,required:""},{input:n(()=>[l(t(F),{modelValue:a.value.assessment_period,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.assessment_period=s),disabled:!d.value,options:c},null,8,["modelValue","disabled"])]),_:1},8,["modelValue","readonly"]),l(t(u),{label:"Status",modelValue:a.value.status,"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.status=s),readonly:!d.value,required:""},{input:n(()=>[l(t(F),{modelValue:a.value.status,"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.status=s),disabled:!d.value,options:P},null,8,["modelValue","disabled"])]),_:1},8,["modelValue","readonly"])])]),_:1}),l(t(S),null,{title:n(()=>[...e[35]||(e[35]=[_("Assessment Team",-1)])]),default:n(()=>[o("div",os,[(m(!0),b(D,null,E(a.value.assessment_team,(s,w)=>(m(),b("div",{key:w,class:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-lg"},[l(t(u),{label:"Team Member",modelValue:s.team_member,"onUpdate:modelValue":v=>s.team_member=v,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Role",modelValue:s.role,"onUpdate:modelValue":v=>s.role=v,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),o("div",rs,[d.value?(m(),U(t(C),{key:0,variant:"outline",size:"sm",onClick:v=>de(w),class:"text-red-600 hover:text-red-700"},{default:n(()=>[l(t(ee),{class:"h-4 w-4"})]),_:1},8,["onClick"])):R("",!0)])]))),128)),d.value?(m(),U(t(C),{key:0,variant:"outline",size:"sm",onClick:ne,class:"w-full"},{default:n(()=>[l(t(N),{class:"h-4 w-4 mr-2"}),e[36]||(e[36]=_(" Add Team Member ",-1))]),_:1})):R("",!0)])]),_:1}),o("div",is,[l(t(S),null,{title:n(()=>[...e[37]||(e[37]=[_("Assessment Scope",-1)])]),default:n(()=>[l(t(u),{modelValue:a.value.assessment_scope,"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.assessment_scope=s),readonly:!d.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1}),l(t(S),null,{title:n(()=>[...e[38]||(e[38]=[_("Methodology",-1)])]),default:n(()=>[o("div",ns,[(m(),b(D,null,E(M,s=>o("div",{key:s.value,class:"flex items-center space-x-2"},[$e(o("input",{id:`method-${s.value}`,"onUpdate:modelValue":e[9]||(e[9]=w=>a.value.methodology=w),value:s.value,type:"checkbox",disabled:!d.value,class:"rounded border-gray-300"},null,8,ds),[[Me,a.value.methodology]]),o("label",{for:`method-${s.value}`,class:"text-sm"},g(s.label),9,us)])),64))])]),_:1})]),l(t(S),null,{title:n(()=>[...e[39]||(e[39]=[_("Risk Register",-1)])]),default:n(()=>[o("div",ms,[o("div",vs,[e[41]||(e[41]=o("h3",{class:"text-lg font-semibold"},"Identified Risks",-1)),d.value?(m(),U(t(C),{key:0,variant:"outline",size:"sm",onClick:ue},{default:n(()=>[l(t(N),{class:"h-4 w-4 mr-2"}),e[40]||(e[40]=_(" Add Risk ",-1))]),_:1})):R("",!0)]),o("div",ps,[o("table",cs,[e[42]||(e[42]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Risk ID "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Description "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Category "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Likelihood "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Impact "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Inherent Risk "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),o("tbody",_s,[(m(!0),b(D,null,E(a.value.risk_register,(s,w)=>(m(),b("tr",{key:w},[o("td",ys,g(s.risk_id),1),o("td",gs,g(s.risk_title),1),o("td",ks,g(s.risk_category),1),o("td",fs,g(s.likelihood_score)+"/5 ",1),o("td",bs,g(s.impact_score)+"/5 ",1),o("td",xs,[l(t(O),{variant:G(s.inherent_risk_score)},{default:n(()=>[_(g(s.inherent_risk_score)+"/25 ",1)]),_:2},1032,["variant"])]),o("td",Vs,[d.value?(m(),U(t(C),{key:0,variant:"ghost",size:"sm",onClick:v=>me(w)},{default:n(()=>[l(t(Z),{class:"h-4 w-4"})]),_:1},8,["onClick"])):R("",!0),d.value?(m(),U(t(C),{key:1,variant:"ghost",size:"sm",onClick:v=>ve(w),class:"text-red-600 hover:text-red-700"},{default:n(()=>[l(t(ee),{class:"h-4 w-4"})]),_:1},8,["onClick"])):R("",!0)])]))),128))])])])])]),_:1}),l(t(S),null,{title:n(()=>[...e[43]||(e[43]=[_("Risk Heat Map",-1)])]),default:n(()=>[o("div",ws,[l(We,{risks:a.value.risk_register,heatMapData:a.value.risk_heat_map_data},null,8,["risks","heatMapData"])])]),_:1}),l(t(S),null,{title:n(()=>[...e[44]||(e[44]=[_("Action Plan",-1)])]),default:n(()=>[o("div",hs,[o("div",Cs,[e[46]||(e[46]=o("h3",{class:"text-lg font-semibold"},"Mitigation Actions",-1)),d.value?(m(),U(t(C),{key:0,variant:"outline",size:"sm",onClick:ce},{default:n(()=>[l(t(N),{class:"h-4 w-4 mr-2"}),e[45]||(e[45]=_(" Add Action ",-1))]),_:1})):R("",!0)]),o("div",As,[(m(!0),b(D,null,E(a.value.action_plan,(s,w)=>(m(),b("div",{key:w,class:"p-4 border rounded-lg"},[o("div",Rs,[l(t(u),{label:"Action ID",value:s.action_id,readonly:""},null,8,["value"]),l(t(u),{label:"Action Description",modelValue:s.action_description,"onUpdate:modelValue":v=>s.action_description=v,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Responsible Party",modelValue:s.responsible_party,"onUpdate:modelValue":v=>s.responsible_party=v,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Target Completion Date",modelValue:s.target_completion_date,"onUpdate:modelValue":v=>s.target_completion_date=v,type:"date",readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Status",modelValue:s.status,"onUpdate:modelValue":v=>s.status=v,readonly:!d.value},{input:n(()=>[l(t(F),{modelValue:s.status,"onUpdate:modelValue":v=>s.status=v,disabled:!d.value,options:ae},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Priority",modelValue:s.priority,"onUpdate:modelValue":v=>s.priority=v,readonly:!d.value},{input:n(()=>[l(t(F),{modelValue:s.priority,"onUpdate:modelValue":v=>s.priority=v,disabled:!d.value,options:te},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Estimated Cost",modelValue:s.estimated_cost,"onUpdate:modelValue":v=>s.estimated_cost=v,type:"number",readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(t(u),{label:"Actual Completion Date",modelValue:s.actual_completion_date,"onUpdate:modelValue":v=>s.actual_completion_date=v,type:"date",readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"])])]))),128))])])]),_:1}),l(t(S),null,{title:n(()=>[...e[47]||(e[47]=[_("Top Risks Summary",-1)])]),default:n(()=>[o("div",Us,[(m(!0),b(D,null,E(a.value.top_risks,s=>(m(),b("div",{key:s.risk_id,class:"p-4 border rounded-lg"},[o("div",Ss,[o("div",null,[o("h4",$s,g(s.risk_description),1),o("p",Ms,"Risk Score: "+g(s.inherent_risk_score)+"/25",1)]),l(t(O),{variant:G(s.inherent_risk_score)},{default:n(()=>[_(g(ye(s.inherent_risk_score)),1)]),_:2},1032,["variant"])])]))),128))])]),_:1}),o("div",Is,[l(t(S),null,{title:n(()=>[...e[48]||(e[48]=[_("Assessment Summary",-1)])]),default:n(()=>[l(t(u),{modelValue:a.value.assessment_summary,"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.assessment_summary=s),readonly:!d.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1}),l(t(S),null,{title:n(()=>[...e[49]||(e[49]=[_("Recommendations",-1)])]),default:n(()=>[l(t(u),{modelValue:a.value.recommendations,"onUpdate:modelValue":e[11]||(e[11]=s=>a.value.recommendations=s),readonly:!d.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1})]),l(t(S),null,{title:n(()=>[...e[50]||(e[50]=[_("Approval Information",-1)])]),default:n(()=>[o("div",Ds,[l(t(u),{label:"Prepared By",value:a.value.prepared_by,readonly:""},null,8,["value"]),l(t(u),{label:"Reviewed By",modelValue:a.value.reviewed_by,"onUpdate:modelValue":e[12]||(e[12]=s=>a.value.reviewed_by=s),readonly:!d.value},null,8,["modelValue","readonly"]),l(t(u),{label:"Approved By",modelValue:a.value.approved_by,"onUpdate:modelValue":e[13]||(e[13]=s=>a.value.approved_by=s),readonly:!d.value},null,8,["modelValue","readonly"]),l(t(u),{label:"Approval Date",value:a.value.approval_date,readonly:""},null,8,["value"])])]),_:1}),o("div",Es,[d.value?(m(),U(t(C),{key:0,variant:"outline",onClick:Y},{default:n(()=>[...e[51]||(e[51]=[_(" Cancel ",-1)])]),_:1})):R("",!0),d.value?(m(),U(t(C),{key:1,variant:"default",onClick:J,disabled:$.value},{default:n(()=>[$.value?(m(),b("div",Ps)):(m(),U(t(Te),{key:0,class:"h-4 w-4 mr-2"})),_(" "+g($.value?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"])):R("",!0)])])):R("",!0),l(t(se),{modelValue:V.value,"onUpdate:modelValue":e[29]||(e[29]=s=>V.value=s)},{title:n(()=>[_(g(p.value!==null?"Edit Risk Entry":"Add Risk Entry"),1)]),actions:n(()=>[l(t(C),{variant:"outline",onClick:Q},{default:n(()=>[...e[52]||(e[52]=[_(" Cancel ",-1)])]),_:1}),l(t(C),{onClick:pe},{default:n(()=>[_(g(p.value!==null?"Update":"Add")+" Risk ",1)]),_:1})]),default:n(()=>[o("div",Ts,[l(t(u),{label:"Risk ID",modelValue:r.value.risk_id,"onUpdate:modelValue":e[14]||(e[14]=s=>r.value.risk_id=s),required:""},null,8,["modelValue"]),l(t(u),{label:"Risk Title",modelValue:r.value.risk_title,"onUpdate:modelValue":e[15]||(e[15]=s=>r.value.risk_title=s),required:""},null,8,["modelValue"]),l(t(u),{label:"Risk Description",modelValue:r.value.risk_description,"onUpdate:modelValue":e[16]||(e[16]=s=>r.value.risk_description=s),type:"textarea",required:""},null,8,["modelValue"]),l(t(u),{label:"Risk Category",modelValue:r.value.risk_category,"onUpdate:modelValue":e[17]||(e[17]=s=>r.value.risk_category=s),required:""},null,8,["modelValue"]),l(t(u),{label:"Risk Subcategory",modelValue:r.value.risk_subcategory,"onUpdate:modelValue":e[18]||(e[18]=s=>r.value.risk_subcategory=s)},null,8,["modelValue"]),l(t(u),{label:"Auditable Entity",modelValue:r.value.auditable_entity,"onUpdate:modelValue":e[19]||(e[19]=s=>r.value.auditable_entity=s)},null,8,["modelValue"]),l(t(u),{label:"Threat Source",modelValue:r.value.threat_source,"onUpdate:modelValue":e[20]||(e[20]=s=>r.value.threat_source=s)},null,8,["modelValue"]),l(t(u),{label:"Vulnerability",modelValue:r.value.vulnerability,"onUpdate:modelValue":e[21]||(e[21]=s=>r.value.vulnerability=s)},null,8,["modelValue"]),o("div",qs,[l(t(u),{label:"Likelihood Score (1-5)",modelValue:r.value.likelihood_score,"onUpdate:modelValue":e[22]||(e[22]=s=>r.value.likelihood_score=s),modelModifiers:{number:!0},type:"number",min:"1",max:"5",required:""},null,8,["modelValue"]),l(t(u),{label:"Impact Score (1-5)",modelValue:r.value.impact_score,"onUpdate:modelValue":e[23]||(e[23]=s=>r.value.impact_score=s),modelModifiers:{number:!0},type:"number",min:"1",max:"5",required:""},null,8,["modelValue"])]),l(t(u),{label:"Control Effectiveness",modelValue:r.value.control_effectiveness,"onUpdate:modelValue":e[24]||(e[24]=s=>r.value.control_effectiveness=s)},null,8,["modelValue"]),l(t(u),{label:"Existing Controls",modelValue:r.value.existing_controls,"onUpdate:modelValue":e[25]||(e[25]=s=>r.value.existing_controls=s),type:"textarea"},null,8,["modelValue"]),l(t(u),{label:"Risk Owner",modelValue:r.value.risk_owner,"onUpdate:modelValue":e[26]||(e[26]=s=>r.value.risk_owner=s)},null,8,["modelValue"]),l(t(u),{label:"Risk Response",modelValue:r.value.risk_response,"onUpdate:modelValue":e[27]||(e[27]=s=>r.value.risk_response=s)},null,8,["modelValue"]),l(t(u),{label:"Target Risk Score",modelValue:r.value.target_risk_score,"onUpdate:modelValue":e[28]||(e[28]=s=>r.value.target_risk_score=s),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}};export{Hs as default};
//# sourceMappingURL=RiskAssessmentDetail-BEC_ISSH.js.map
