var F=(n,p,k)=>new Promise((U,A)=>{var d=_=>{try{R(k.next(_))}catch(I){A(I)}},l=_=>{try{R(k.throw(_))}catch(I){A(I)}},R=_=>_.done?U(_.value):Promise.resolve(_.value).then(d,l);R((k=k.apply(n,p)).next())});import{a as y,c as S,A as Ce,h as V,d as b,s as D,i as Q}from"./index-qIC3Tfxg.js";import{ab as Ae,ap as he,r as L,j as G,Q as Se,w as Ue,l as f,p as u,q as t,H as g,s as i,u as m,z as v,v as s,A as c,y as x,B as Re,F as q,x as N}from"./vue-DciwFjI_.js";import{aL as Ie,aa as Ee,a9 as De,d as K,N as T,a4 as j,p as Le,F as Oe}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const Pe={class:"space-y-6"},Me={class:"flex items-center justify-between"},Fe={class:"flex items-center space-x-4"},qe={class:"text-2xl font-bold text-gray-900"},Ne={class:"text-gray-600 mt-1"},Te={key:0,class:"flex items-center space-x-3"},je={class:"flex items-center space-x-2"},ze={key:0,class:"flex justify-center items-center py-12"},Be={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},He={class:"lg:col-span-2 space-y-6"},$e={class:"bg-white rounded-lg border border-gray-200 p-6"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Qe={class:"md:col-span-2"},Ge={class:"md:col-span-2"},Ke={class:"bg-white rounded-lg border border-gray-200 p-6"},Je={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Xe={class:"space-y-4"},Ye={class:"space-y-4"},Ze={class:"mt-6 p-4 bg-gray-50 rounded-lg"},et={class:"flex items-center justify-between"},tt={class:"text-right"},lt={class:"text-sm text-gray-600"},at={class:"bg-white rounded-lg border border-gray-200 p-6"},st={class:"flex items-center justify-between mb-4"},it={class:"space-y-4"},nt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ot={class:"flex items-end space-x-2"},dt={class:"flex-1"},rt={class:"mt-4"},ut={class:"bg-white rounded-lg border border-gray-200 p-6"},mt={class:"flex items-center justify-between mb-4"},vt={class:"space-y-4"},ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},yt={class:"md:col-span-2"},bt={class:"flex items-end"},gt={class:"bg-white rounded-lg border border-gray-200 p-6"},ft={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pt={class:"md:col-span-2"},kt={class:"mt-4"},xt={class:"bg-white rounded-lg border border-gray-200 p-6"},_t={class:"flex items-center justify-between mb-4"},wt={class:"space-y-4"},Vt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ct={class:"flex items-end"},At={class:"bg-white rounded-lg border border-gray-200 p-6"},ht={class:"space-y-4"},St={key:0,class:"flex items-center justify-end space-x-3"},Ut={class:"space-y-6"},Rt={class:"bg-white rounded-lg border border-gray-200 p-6"},It={class:"space-y-4"},Et={class:"flex items-center justify-between"},Dt={class:"flex items-center justify-between"},Lt={class:"flex items-center justify-between"},Ot={class:"bg-white rounded-lg border border-gray-200 p-6"},Pt={class:"space-y-4"},Mt={class:"font-medium"},Ft={class:"font-medium"},qt={class:"font-medium"},Nt={key:0},Tt={key:0,class:"bg-white rounded-lg border border-gray-200 p-6"},jt={class:"space-y-3"},Gt={__name:"AuditUniverseDetail",props:{entityId:{type:String,default:null},mode:{type:String,default:"view",validator:n=>["view","edit","new"].includes(n)}},setup(n){const p=n,k=Ae();he();const U=L(!1),A=L(!1),d=L(null),l=L({auditable_entity:"",entity_type:"",department:"",location:"",description:"",process_owner:"",inherent_risk_rating:"",inherent_risk_score:1,control_environment_rating:"",control_effectiveness_score:1,residual_risk_rating:"",residual_risk_score:1,risk_factors:[],key_controls:[],audit_frequency:"",last_audit_date:"",last_audit_opinion:"",next_scheduled_audit:"",mandatory_audit:!1,regulatory_reference:"",bc_data_sources:[],notes:"",is_active:!0}),R=[{label:"Process",value:"Process"},{label:"Function",value:"Function"},{label:"Department",value:"Department"},{label:"Location",value:"Location"},{label:"System",value:"System"},{label:"Compliance Area",value:"Compliance Area"}],_=[{label:"Finance",value:"Finance"},{label:"IT",value:"IT"},{label:"Operations",value:"Operations"},{label:"HR",value:"HR"},{label:"Sales",value:"Sales"},{label:"Procurement",value:"Procurement"}],I=[{label:"Head Office",value:"Head Office"},{label:"Branch 1",value:"Branch 1"},{label:"Branch 2",value:"Branch 2"},{label:"Warehouse",value:"Warehouse"},{label:"All Locations",value:"All"}],J=[{label:"Critical",value:"Critical"},{label:"High",value:"High"},{label:"Medium",value:"Medium"},{label:"Low",value:"Low"}],X=[{label:"Strong",value:"Strong"},{label:"Adequate",value:"Adequate"},{label:"Weak",value:"Weak"},{label:"Not Assessed",value:"Not Assessed"}],Y=[{label:"Financial",value:"Financial"},{label:"Operational",value:"Operational"},{label:"Compliance",value:"Compliance"},{label:"Strategic",value:"Strategic"},{label:"IT",value:"IT"},{label:"Reputational",value:"Reputational"}],Z=[{label:"Rare",value:"Rare"},{label:"Unlikely",value:"Unlikely"},{label:"Possible",value:"Possible"},{label:"Likely",value:"Likely"},{label:"Almost Certain",value:"Almost Certain"}],ee=[{label:"Insignificant",value:"Insignificant"},{label:"Minor",value:"Minor"},{label:"Moderate",value:"Moderate"},{label:"Major",value:"Major"},{label:"Catastrophic",value:"Catastrophic"}],te=[{label:"Preventive",value:"Preventive"},{label:"Detective",value:"Detective"},{label:"Corrective",value:"Corrective"}],le=[{label:"Continuous",value:"Continuous"},{label:"Daily",value:"Daily"},{label:"Weekly",value:"Weekly"},{label:"Monthly",value:"Monthly"},{label:"Quarterly",value:"Quarterly"},{label:"Annually",value:"Annually"}],ae=[{label:"Effective",value:"Effective"},{label:"Partially Effective",value:"Partially Effective"},{label:"Ineffective",value:"Ineffective"},{label:"Not Tested",value:"Not Tested"}],se=[{label:"Quarterly",value:"Quarterly"},{label:"Semi-Annual",value:"Semi-Annual"},{label:"Annual",value:"Annual"},{label:"Bi-Annual",value:"Bi-Annual"},{label:"Tri-Annual",value:"Tri-Annual"},{label:"As Needed",value:"As Needed"}],ie=[{label:"Satisfactory",value:"Satisfactory"},{label:"Needs Improvement",value:"Needs Improvement"},{label:"Unsatisfactory",value:"Unsatisfactory"}],ne=[{label:"General Ledger Entries",value:"General Ledger Entries"},{label:"Item Master Data",value:"Item Master Data"},{label:"Item Ledger Entries",value:"Item Ledger Entries"},{label:"Sales Invoices",value:"Sales Invoices"},{label:"Purchase Invoices",value:"Purchase Invoices"},{label:"Customer Ledger Entries",value:"Customer Ledger Entries"},{label:"Vendor Ledger Entries",value:"Vendor Ledger Entries"},{label:"Bank Account Ledger Entries",value:"Bank Account Ledger Entries"}],oe=[{label:"Primary",value:"Primary"},{label:"Secondary",value:"Secondary"},{label:"Reference",value:"Reference"}],de=G(()=>l.value.next_scheduled_audit?new Date(l.value.next_scheduled_audit)<new Date:!1),re=G(()=>l.value.is_active&&l.value.auditable_entity),z=()=>{k.push("/audit-planning/universe")},O=o=>{o==="edit"?k.push(`/audit-planning/universe/${p.entityId}/edit`):k.push(`/audit-planning/universe/${p.entityId}`)},ue=()=>F(this,null,function*(){if(p.mode!=="new"){U.value=!0;try{yield new Promise(o=>setTimeout(o,1e3)),d.value={universe_id:"AU-001",auditable_entity:"Accounts Payable",entity_type:"Process",department:"Finance",location:"Head Office",description:"Processing of vendor payments and expense reimbursements",process_owner:"John Doe",inherent_risk_rating:"High",inherent_risk_score:15,control_environment_rating:"Adequate",control_effectiveness_score:3,residual_risk_rating:"Medium",residual_risk_score:5,risk_factors:[{risk_category:"Financial",risk_description:"Payment errors leading to overpayments",likelihood:"Possible",impact:"Moderate",risk_score:12}],key_controls:[{control_description:"Three-way matching of PO, receipt, and invoice",control_type:"Preventive",control_frequency:"Continuous",control_effectiveness:"Effective"}],audit_frequency:"Quarterly",last_audit_date:"2023-10-15",last_audit_opinion:"Satisfactory",next_scheduled_audit:"2024-01-15",mandatory_audit:!1,regulatory_reference:"",bc_data_sources:[{data_type:"Purchase Invoices",relevance:"Primary"},{data_type:"Vendor Ledger Entries",relevance:"Secondary"}],notes:"Regular monitoring required due to high transaction volume",is_active:!0},Object.assign(l.value,d.value)}catch(o){console.error("Error loading entity:",o)}finally{U.value=!1}}}),B=()=>{const o={Critical:25,High:15,Medium:8,Low:3};l.value.inherent_risk_score=o[l.value.inherent_risk_rating]||1;const e={Strong:5,Adequate:3,Weak:1,"Not Assessed":1};l.value.control_effectiveness_score=e[l.value.control_environment_rating]||1,P()},P=()=>{const o=Math.round(l.value.inherent_risk_score/l.value.control_effectiveness_score);l.value.residual_risk_score=o,o>=20?l.value.residual_risk_rating="Critical":o>=12?l.value.residual_risk_rating="High":o>=6?l.value.residual_risk_rating="Medium":l.value.residual_risk_rating="Low"},H=o=>{const e={Rare:1,Unlikely:2,Possible:3,Likely:4,"Almost Certain":5},C={Insignificant:1,Minor:2,Moderate:3,Major:4,Catastrophic:5},h=e[o.likelihood]||1,E=C[o.impact]||1;o.risk_score=h*E},me=()=>{l.value.risk_factors.push({risk_category:"",risk_description:"",likelihood:"",impact:"",risk_score:1})},ve=o=>{l.value.risk_factors.splice(o,1)},ce=()=>{l.value.key_controls.push({control_description:"",control_type:"",control_frequency:"",control_effectiveness:""})},ye=o=>{l.value.key_controls.splice(o,1)},be=()=>{l.value.bc_data_sources.push({data_type:"",relevance:""})},ge=o=>{l.value.bc_data_sources.splice(o,1)},M=o=>({Critical:"danger",High:"danger",Medium:"warning",Low:"success"})[o]||"secondary",fe=o=>({Strong:"success",Adequate:"warning",Weak:"danger","Not Assessed":"secondary"})[o]||"secondary",pe=o=>({Critical:"text-red-600",High:"text-red-600",Medium:"text-yellow-600",Low:"text-green-600"})[o]||"text-gray-600",$=o=>new Date(o).toLocaleDateString(),ke=()=>F(this,null,function*(){A.value=!0;try{yield new Promise(o=>setTimeout(o,1e3)),p.mode==="new"?(console.log("Creating new entity:",l.value),k.push("/audit-planning/universe")):(console.log("Updating entity:",l.value),k.push(`/audit-planning/universe/${p.entityId}`))}catch(o){console.error("Error saving entity:",o)}finally{A.value=!1}}),xe=()=>{p.mode==="new"?z():O("view")},W=()=>{console.log("Schedule audit for entity:",p.entityId)},_e=()=>{console.log("View audit history for entity:",p.entityId)},we=()=>{console.log("Generate report for entity:",p.entityId)},Ve=()=>{var o,e,C;return d.value?{entityId:d.value.name||d.value.auditable_entity,entityName:d.value.auditable_entity,entityType:d.value.entity_type,department:d.value.department,location:d.value.location,industry:d.value.industry,riskRating:d.value.residual_risk_rating,inherentRiskRating:d.value.inherent_risk_rating,controlEffectiveness:d.value.control_effectiveness,isActive:d.value.is_active,lastAuditDate:d.value.last_audit_date,nextAuditDue:d.value.next_audit_due,auditFrequency:d.value.audit_frequency,auditHistoryCount:((o=d.value.audit_history)==null?void 0:o.length)||0,openFindings:((e=d.value.findings)==null?void 0:e.filter(h=>h.status==="Open").length)||0,totalFindings:((C=d.value.findings)==null?void 0:C.length)||0,riskFactors:d.value.risk_factors||[],keyControls:d.value.key_controls||[],auditScope:d.value.audit_scope,auditObjectives:d.value.audit_objectives}:{}};return Se(()=>{ue()}),Ue(()=>p.mode,o=>{o==="edit"&&d.value&&Object.assign(l.value,d.value)}),(o,e)=>{var C,h,E;return u(),f("div",Pe,[t("div",Me,[t("div",Fe,[i(s(y),{variant:"ghost",onClick:z},{default:m(()=>[i(s(Ie),{class:"h-4 w-4 mr-2"}),e[20]||(e[20]=v(" Back to Audit Universe ",-1))]),_:1}),t("div",null,[t("h1",qe,c(n.mode==="new"?"New Audit Universe Entity":((C=d.value)==null?void 0:C.auditable_entity)||"Audit Universe Entity"),1),t("p",Ne,c(n.mode==="view"?"View entity details and risk assessment":n.mode==="edit"?"Edit entity information":"Create new auditable entity"),1)])]),n.mode!=="new"?(u(),f("div",Te,[i(s(S),{variant:M((h=d.value)==null?void 0:h.residual_risk_rating)},{default:m(()=>{var a;return[v(c((a=d.value)==null?void 0:a.residual_risk_rating)+" Risk ",1)]}),_:1},8,["variant"]),i(s(S),{variant:(E=d.value)!=null&&E.is_active?"success":"secondary"},{default:m(()=>{var a;return[v(c((a=d.value)!=null&&a.is_active?"Active":"Inactive"),1)]}),_:1},8,["variant"]),t("div",je,[n.mode==="view"?(u(),x(s(y),{key:0,variant:"outline",onClick:e[0]||(e[0]=a=>O("edit"))},{default:m(()=>[i(s(Ee),{class:"h-4 w-4 mr-2"}),e[21]||(e[21]=v(" Edit ",-1))]),_:1})):g("",!0),n.mode==="edit"?(u(),x(s(y),{key:1,variant:"outline",onClick:e[1]||(e[1]=a=>O("view"))},{default:m(()=>[i(s(De),{class:"h-4 w-4 mr-2"}),e[22]||(e[22]=v(" View ",-1))]),_:1})):g("",!0),n.mode==="view"&&re.value?(u(),x(s(y),{key:2,variant:"outline",onClick:W},{default:m(()=>[i(s(K),{class:"h-4 w-4 mr-2"}),e[23]||(e[23]=v(" Schedule Audit ",-1))]),_:1})):g("",!0),n.mode==="view"&&d.value?(u(),x(Ce,{key:3,contextType:"audit-universe",contextData:Ve(),capability:"entity-analysis"},null,8,["contextData"])):g("",!0)])])):g("",!0)]),U.value?(u(),f("div",ze,[...e[24]||(e[24]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("span",{class:"ml-3 text-gray-600"},"Loading...",-1)])])):(u(),f("div",Be,[t("div",He,[t("div",$e,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Basic Information",-1)),t("div",We,[t("div",Qe,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Auditable Entity *",-1)),i(s(V),{modelValue:l.value.auditable_entity,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.auditable_entity=a),readonly:n.mode==="view",placeholder:"e.g., Accounts Payable, IT Security Controls",class:"w-full"},null,8,["modelValue","readonly"])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Entity Type *",-1)),i(s(b),{modelValue:l.value.entity_type,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.entity_type=a),options:R,disabled:n.mode==="view",placeholder:"Select entity type"},null,8,["modelValue","disabled"])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Department",-1)),i(s(b),{modelValue:l.value.department,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.department=a),options:_,disabled:n.mode==="view",placeholder:"Select department"},null,8,["modelValue","disabled"])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Location",-1)),i(s(b),{modelValue:l.value.location,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.location=a),options:I,disabled:n.mode==="view",placeholder:"Select location"},null,8,["modelValue","disabled"])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Process Owner",-1)),i(s(V),{modelValue:l.value.process_owner,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.process_owner=a),readonly:n.mode==="view",placeholder:"Name of responsible person",class:"w-full"},null,8,["modelValue","readonly"])]),t("div",Ge,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),i(s(D),{modelValue:l.value.description,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.description=a),readonly:n.mode==="view",placeholder:"Detailed description of the auditable entity",rows:"3",class:"w-full"},null,8,["modelValue","readonly"])])])]),t("div",Ke,[e[39]||(e[39]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Risk Assessment",-1)),t("div",Je,[t("div",Xe,[e[34]||(e[34]=t("h4",{class:"font-medium text-gray-900"},"Inherent Risk",-1)),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Risk Rating",-1)),i(s(b),{modelValue:l.value.inherent_risk_rating,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.inherent_risk_rating=a),options:J,disabled:n.mode==="view",onChange:B},null,8,["modelValue","disabled"])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Risk Score",-1)),i(s(V),{modelValue:l.value.inherent_risk_score,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.inherent_risk_score=a),modelModifiers:{number:!0},readonly:n.mode==="view",type:"number",min:"1",max:"25",onInput:P},null,8,["modelValue","readonly"])])]),t("div",Ye,[e[37]||(e[37]=t("h4",{class:"font-medium text-gray-900"},"Control Environment",-1)),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Control Rating",-1)),i(s(b),{modelValue:l.value.control_environment_rating,"onUpdate:modelValue":e[10]||(e[10]=a=>l.value.control_environment_rating=a),options:X,disabled:n.mode==="view",onChange:B},null,8,["modelValue","disabled"])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Effectiveness Score",-1)),i(s(V),{modelValue:l.value.control_effectiveness_score,"onUpdate:modelValue":e[11]||(e[11]=a=>l.value.control_effectiveness_score=a),modelModifiers:{number:!0},readonly:n.mode==="view",type:"number",min:"1",max:"5",onInput:P},null,8,["modelValue","readonly"])])])]),t("div",Ze,[t("div",et,[e[38]||(e[38]=t("div",null,[t("h4",{class:"font-medium text-gray-900"},"Residual Risk"),t("p",{class:"text-sm text-gray-600"},"Calculated based on inherent risk and control effectiveness")],-1)),t("div",tt,[t("div",{class:Re(["text-2xl font-bold",pe(l.value.residual_risk_rating)])},c(l.value.residual_risk_rating),3),t("div",lt,"Score: "+c(l.value.residual_risk_score),1)])])])]),t("div",at,[t("div",st,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Risk Factors",-1)),n.mode!=="view"?(u(),x(s(y),{key:0,variant:"outline",size:"sm",onClick:me},{default:m(()=>[i(s(T),{class:"h-4 w-4 mr-2"}),e[40]||(e[40]=v(" Add Factor ",-1))]),_:1})):g("",!0)]),t("div",it,[(u(!0),f(q,null,N(l.value.risk_factors,(a,w)=>(u(),f("div",{key:w,class:"p-4 border border-gray-200 rounded-lg"},[t("div",nt,[t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),i(s(b),{modelValue:a.risk_category,"onUpdate:modelValue":r=>a.risk_category=r,options:Y,disabled:n.mode==="view",size:"sm"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Likelihood",-1)),i(s(b),{modelValue:a.likelihood,"onUpdate:modelValue":r=>a.likelihood=r,options:Z,disabled:n.mode==="view",size:"sm",onChange:r=>H(a)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Impact",-1)),i(s(b),{modelValue:a.impact,"onUpdate:modelValue":r=>a.impact=r,options:ee,disabled:n.mode==="view",size:"sm",onChange:r=>H(a)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),t("div",ot,[t("div",dt,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Score",-1)),i(s(V),{modelValue:a.risk_score,"onUpdate:modelValue":r=>a.risk_score=r,modelModifiers:{number:!0},readonly:"",size:"sm",class:"text-center font-medium"},null,8,["modelValue","onUpdate:modelValue"])]),n.mode!=="view"?(u(),x(s(y),{key:0,variant:"ghost",size:"sm",onClick:r=>ve(w),class:"text-red-600 hover:text-red-700"},{default:m(()=>[i(s(j),{class:"h-4 w-4"})]),_:1},8,["onClick"])):g("",!0)])]),t("div",rt,[e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),i(s(D),{modelValue:a.risk_description,"onUpdate:modelValue":r=>a.risk_description=r,readonly:n.mode==="view",placeholder:"Describe the risk factor",rows:"2",size:"sm"},null,8,["modelValue","onUpdate:modelValue","readonly"])])]))),128))])]),t("div",ut,[t("div",mt,[e[48]||(e[48]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Key Controls",-1)),n.mode!=="view"?(u(),x(s(y),{key:0,variant:"outline",size:"sm",onClick:ce},{default:m(()=>[i(s(T),{class:"h-4 w-4 mr-2"}),e[47]||(e[47]=v(" Add Control ",-1))]),_:1})):g("",!0)]),t("div",vt,[(u(!0),f(q,null,N(l.value.key_controls,(a,w)=>(u(),f("div",{key:w,class:"p-4 border border-gray-200 rounded-lg"},[t("div",ct,[t("div",yt,[e[49]||(e[49]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Control Description",-1)),i(s(D),{modelValue:a.control_description,"onUpdate:modelValue":r=>a.control_description=r,readonly:n.mode==="view",placeholder:"Describe the control activity",rows:"2",size:"sm"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Control Type",-1)),i(s(b),{modelValue:a.control_type,"onUpdate:modelValue":r=>a.control_type=r,options:te,disabled:n.mode==="view",size:"sm"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Frequency",-1)),i(s(b),{modelValue:a.control_frequency,"onUpdate:modelValue":r=>a.control_frequency=r,options:le,disabled:n.mode==="view",size:"sm"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",null,[e[52]||(e[52]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Effectiveness",-1)),i(s(b),{modelValue:a.control_effectiveness,"onUpdate:modelValue":r=>a.control_effectiveness=r,options:ae,disabled:n.mode==="view",size:"sm"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",bt,[n.mode!=="view"?(u(),x(s(y),{key:0,variant:"ghost",size:"sm",onClick:r=>ye(w),class:"text-red-600 hover:text-red-700"},{default:m(()=>[i(s(j),{class:"h-4 w-4"})]),_:1},8,["onClick"])):g("",!0)])])]))),128))])]),t("div",gt,[e[58]||(e[58]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Audit Information",-1)),t("div",ft,[t("div",null,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Audit Frequency",-1)),i(s(b),{modelValue:l.value.audit_frequency,"onUpdate:modelValue":e[12]||(e[12]=a=>l.value.audit_frequency=a),options:se,disabled:n.mode==="view"},null,8,["modelValue","disabled"])]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Last Audit Date",-1)),i(s(V),{modelValue:l.value.last_audit_date,"onUpdate:modelValue":e[13]||(e[13]=a=>l.value.last_audit_date=a),readonly:n.mode==="view",type:"date"},null,8,["modelValue","readonly"])]),t("div",null,[e[55]||(e[55]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Last Audit Opinion",-1)),i(s(b),{modelValue:l.value.last_audit_opinion,"onUpdate:modelValue":e[14]||(e[14]=a=>l.value.last_audit_opinion=a),options:ie,disabled:n.mode==="view"},null,8,["modelValue","disabled"])]),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Next Scheduled Audit",-1)),i(s(V),{modelValue:l.value.next_scheduled_audit,"onUpdate:modelValue":e[15]||(e[15]=a=>l.value.next_scheduled_audit=a),readonly:n.mode==="view",type:"date"},null,8,["modelValue","readonly"])]),t("div",pt,[e[57]||(e[57]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Regulatory Reference",-1)),i(s(V),{modelValue:l.value.regulatory_reference,"onUpdate:modelValue":e[16]||(e[16]=a=>l.value.regulatory_reference=a),readonly:n.mode==="view",placeholder:"e.g., CBK Prudential Guidelines"},null,8,["modelValue","readonly"])])]),t("div",kt,[i(s(Q),{modelValue:l.value.mandatory_audit,"onUpdate:modelValue":e[17]||(e[17]=a=>l.value.mandatory_audit=a),disabled:n.mode==="view",label:"Mandatory Regulatory Audit"},null,8,["modelValue","disabled"])])]),t("div",xt,[t("div",_t,[e[60]||(e[60]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Business Central Data Sources",-1)),n.mode!=="view"?(u(),x(s(y),{key:0,variant:"outline",size:"sm",onClick:be},{default:m(()=>[i(s(T),{class:"h-4 w-4 mr-2"}),e[59]||(e[59]=v(" Add Data Source ",-1))]),_:1})):g("",!0)]),t("div",wt,[(u(!0),f(q,null,N(l.value.bc_data_sources,(a,w)=>(u(),f("div",{key:w,class:"p-4 border border-gray-200 rounded-lg"},[t("div",Vt,[t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Data Type",-1)),i(s(b),{modelValue:a.data_type,"onUpdate:modelValue":r=>a.data_type=r,options:ne,disabled:n.mode==="view",size:"sm"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Relevance",-1)),i(s(b),{modelValue:a.relevance,"onUpdate:modelValue":r=>a.relevance=r,options:oe,disabled:n.mode==="view",size:"sm"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),t("div",Ct,[n.mode!=="view"?(u(),x(s(y),{key:0,variant:"ghost",size:"sm",onClick:r=>ge(w),class:"text-red-600 hover:text-red-700"},{default:m(()=>[i(s(j),{class:"h-4 w-4"})]),_:1},8,["onClick"])):g("",!0)])])]))),128))])]),t("div",At,[e[64]||(e[64]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Additional Information",-1)),t("div",ht,[t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),i(s(D),{modelValue:l.value.notes,"onUpdate:modelValue":e[18]||(e[18]=a=>l.value.notes=a),readonly:n.mode==="view",placeholder:"Additional notes and comments",rows:"3"},null,8,["modelValue","readonly"])]),t("div",null,[i(s(Q),{modelValue:l.value.is_active,"onUpdate:modelValue":e[19]||(e[19]=a=>l.value.is_active=a),disabled:n.mode==="view",label:"Entity is Active"},null,8,["modelValue","disabled"])])])]),n.mode!=="view"?(u(),f("div",St,[i(s(y),{variant:"outline",onClick:xe},{default:m(()=>[...e[65]||(e[65]=[v(" Cancel ",-1)])]),_:1}),i(s(y),{onClick:ke,loading:A.value},{default:m(()=>[v(c(n.mode==="new"?"Create Entity":"Save Changes"),1)]),_:1},8,["loading"])])):g("",!0)]),t("div",Ut,[t("div",Rt,[e[69]||(e[69]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Risk Summary",-1)),t("div",It,[t("div",Et,[e[66]||(e[66]=t("span",{class:"text-sm text-gray-600"},"Inherent Risk:",-1)),i(s(S),{variant:M(l.value.inherent_risk_rating)},{default:m(()=>[v(c(l.value.inherent_risk_rating)+" ("+c(l.value.inherent_risk_score)+") ",1)]),_:1},8,["variant"])]),t("div",Dt,[e[67]||(e[67]=t("span",{class:"text-sm text-gray-600"},"Control Effectiveness:",-1)),i(s(S),{variant:fe(l.value.control_environment_rating)},{default:m(()=>[v(c(l.value.control_environment_rating)+" ("+c(l.value.control_effectiveness_score)+") ",1)]),_:1},8,["variant"])]),t("div",Lt,[e[68]||(e[68]=t("span",{class:"text-sm text-gray-600"},"Residual Risk:",-1)),i(s(S),{variant:M(l.value.residual_risk_rating)},{default:m(()=>[v(c(l.value.residual_risk_rating)+" ("+c(l.value.residual_risk_score)+") ",1)]),_:1},8,["variant"])])])]),t("div",Ot,[e[74]||(e[74]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Audit Schedule",-1)),t("div",Pt,[t("div",null,[e[70]||(e[70]=t("span",{class:"text-sm text-gray-600"},"Frequency:",-1)),t("p",Mt,c(l.value.audit_frequency||"Not set"),1)]),t("div",null,[e[71]||(e[71]=t("span",{class:"text-sm text-gray-600"},"Last Audit:",-1)),t("p",Ft,c(l.value.last_audit_date?$(l.value.last_audit_date):"Never"),1)]),t("div",null,[e[72]||(e[72]=t("span",{class:"text-sm text-gray-600"},"Next Scheduled:",-1)),t("p",qt,c(l.value.next_scheduled_audit?$(l.value.next_scheduled_audit):"Not scheduled"),1)]),de.value?(u(),f("div",Nt,[i(s(S),{variant:"danger"},{default:m(()=>[...e[73]||(e[73]=[v("Overdue",-1)])]),_:1})])):g("",!0)])]),n.mode==="view"?(u(),f("div",Tt,[e[78]||(e[78]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),t("div",jt,[i(s(y),{variant:"outline",class:"w-full justify-start",onClick:W},{default:m(()=>[i(s(K),{class:"h-4 w-4 mr-2"}),e[75]||(e[75]=v(" Schedule Audit ",-1))]),_:1}),i(s(y),{variant:"outline",class:"w-full justify-start",onClick:_e},{default:m(()=>[i(s(Le),{class:"h-4 w-4 mr-2"}),e[76]||(e[76]=v(" View Audit History ",-1))]),_:1}),i(s(y),{variant:"outline",class:"w-full justify-start",onClick:we},{default:m(()=>[i(s(Oe),{class:"h-4 w-4 mr-2"}),e[77]||(e[77]=v(" Generate Report ",-1))]),_:1})])])):g("",!0)])]))])}}};export{Gt as default};
//# sourceMappingURL=AuditUniverseDetail-CIyTQ7RC.js.map
