{"version":3,"file":"RiskAssessmentDetail-BEC_ISSH.js","sources":["../../../../frontend/src/components/RiskHeatMapGrid.vue","../../../../frontend/src/pages/RiskAssessmentDetail.vue"],"sourcesContent":["<template>\n\t<div class=\"risk-heat-map\">\n\t\t<div class=\"grid grid-cols-6 gap-1 max-w-md mx-auto\">\n\t\t\t<!-- Header row -->\n\t\t\t<div class=\"col-span-1\"></div>\n\t\t\t<div v-for=\"impact in 5\" :key=\"`impact-${impact}`\" class=\"text-center text-sm font-medium text-gray-700 p-2\">\n\t\t\t\t{{ impact }}\n\t\t\t</div>\n\n\t\t\t<!-- Grid rows -->\n\t\t\t<div v-for=\"likelihood in 5\" :key=\"`likelihood-${likelihood}`\" class=\"contents\">\n\t\t\t\t<!-- Likelihood label -->\n\t\t\t\t<div class=\"text-center text-sm font-medium text-gray-700 p-2 flex items-center justify-center\">\n\t\t\t\t\t{{ likelihood }}\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Risk cells -->\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"impact in 5\"\n\t\t\t\t\t:key=\"`cell-${likelihood}-${impact}`\"\n\t\t\t\t\t:class=\"getCellClass(likelihood, impact)\"\n\t\t\t\t\tclass=\"aspect-square rounded border cursor-pointer transition-all duration-200 hover:scale-105 flex items-center justify-center text-xs font-medium\"\n\t\t\t\t\t@click=\"onCellClick(likelihood, impact)\"\n\t\t\t\t>\n\t\t\t\t\t{{ getCellCount(likelihood, impact) }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Legend -->\n\t\t<div class=\"flex justify-center mt-6 space-x-4\">\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<div class=\"w-4 h-4 bg-green-100 border border-green-300 rounded\"></div>\n\t\t\t\t<span class=\"text-sm text-gray-600\">Low (1-6)</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<div class=\"w-4 h-4 bg-yellow-100 border border-yellow-300 rounded\"></div>\n\t\t\t\t<span class=\"text-sm text-gray-600\">Medium (7-12)</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<div class=\"w-4 h-4 bg-orange-100 border border-orange-300 rounded\"></div>\n\t\t\t\t<span class=\"text-sm text-gray-600\">High (13-18)</span>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<div class=\"w-4 h-4 bg-red-100 border border-red-300 rounded\"></div>\n\t\t\t\t<span class=\"text-sm text-gray-600\">Critical (19-25)</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Axis labels -->\n\t\t<div class=\"text-center mt-4\">\n\t\t\t<div class=\"grid grid-cols-2 gap-8 max-w-md mx-auto\">\n\t\t\t\t<div class=\"text-sm text-gray-600\">\n\t\t\t\t\t<div class=\"font-medium\">Likelihood</div>\n\t\t\t\t\t<div class=\"text-xs\">1 = Rare, 5 = Almost Certain</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"text-sm text-gray-600\">\n\t\t\t\t\t<div class=\"font-medium\">Impact</div>\n\t\t\t\t\t<div class=\"text-xs\">1 = Minor, 5 = Catastrophic</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Risk details modal -->\n\t\t<Dialog v-model=\"showDetailsModal\">\n\t\t\t<template #title>Risks in {{ selectedCell.likelihood }}x{{ selectedCell.impact }} Cell</template>\n\t\t\t<div class=\"space-y-4 max-h-96 overflow-y-auto\">\n\t\t\t\t<div v-if=\"cellRisks.length === 0\" class=\"text-center text-gray-500 py-8\">\n\t\t\t\t\tNo risks in this cell\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"space-y-3\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for=\"risk in cellRisks\"\n\t\t\t\t\t\t:key=\"risk.risk_id\"\n\t\t\t\t\t\tclass=\"p-3 border rounded-lg\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<div class=\"font-medium text-sm\">{{ risk.risk_id }}</div>\n\t\t\t\t\t\t\t\t<div class=\"text-sm text-gray-600 mt-1\">{{ risk.risk_description }}</div>\n\t\t\t\t\t\t\t\t<div class=\"text-xs text-gray-500 mt-1\">\n\t\t\t\t\t\t\t\t\tCategory: {{ risk.risk_category }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Badge :variant=\"getRiskVariant(risk.inherent_risk_score)\" class=\"ml-2\">\n\t\t\t\t\t\t\t\t{{ risk.inherent_risk_score }}/25\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Dialog>\n\t</div>\n</template>\n\n<script setup>\nimport { Badge, Dialog } from \"frappe-ui\"\nimport { computed, ref } from \"vue\"\n\n// Props\nconst props = defineProps({\n\trisks: {\n\t\ttype: Array,\n\t\tdefault: () => [],\n\t},\n\theatMapData: {\n\t\ttype: Object,\n\t\tdefault: () => ({}),\n\t},\n})\n\n// Reactive data\nconst showDetailsModal = ref(false)\nconst selectedCell = ref({ likelihood: 0, impact: 0 })\n\n// Computed properties\nconst cellRisks = computed(() => {\n\tif (!selectedCell.value.likelihood || !selectedCell.value.impact) return []\n\n\treturn props.risks.filter(\n\t\t(risk) =>\n\t\t\trisk.likelihood_score === selectedCell.value.likelihood &&\n\t\t\trisk.impact_score === selectedCell.value.impact,\n\t)\n})\n\n// Methods\nconst getCellClass = (likelihood, impact) => {\n\tconst riskScore = likelihood * impact\n\tconst count = getCellCount(likelihood, impact)\n\n\tlet baseClass = \"border-gray-200\"\n\n\t// Risk level colors\n\tif (riskScore >= 19) {\n\t\tbaseClass = \"bg-red-100 border-red-300 text-red-800\"\n\t} else if (riskScore >= 13) {\n\t\tbaseClass = \"bg-orange-100 border-orange-300 text-orange-800\"\n\t} else if (riskScore >= 7) {\n\t\tbaseClass = \"bg-yellow-100 border-yellow-300 text-yellow-800\"\n\t} else {\n\t\tbaseClass = \"bg-green-100 border-green-300 text-green-800\"\n\t}\n\n\t// Add hover effect and count indicator\n\tif (count > 0) {\n\t\tbaseClass += \" font-bold\"\n\t}\n\n\treturn baseClass\n}\n\nconst getCellCount = (likelihood, impact) => {\n\tconst key = `${likelihood}-${impact}`\n\treturn props.heatMapData[key] || 0\n}\n\nconst onCellClick = (likelihood, impact) => {\n\tselectedCell.value = { likelihood, impact }\n\tshowDetailsModal.value = true\n}\n\nconst getRiskVariant = (score) => {\n\tif (score >= 20) return \"destructive\"\n\tif (score >= 15) return \"warning\"\n\tif (score >= 10) return \"secondary\"\n\treturn \"success\"\n}\n</script>\n\n<style scoped>\n.risk-heat-map {\n\t@apply p-6 bg-white rounded-lg border;\n}\n</style>","<template>\n\t<div class=\"space-y-6\">\n\t\t<!-- Header -->\n\t\t<div class=\"flex items-center justify-between\">\n\t\t\t<div class=\"flex items-center space-x-4\">\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t@click=\"$router.go(-1)\"\n\t\t\t\t\tclass=\"flex items-center space-x-2\"\n\t\t\t\t>\n\t\t\t\t\t<ArrowLeftIcon class=\"h-4 w-4\" />\n\t\t\t\t\t<span>Back</span>\n\t\t\t\t</Button>\n\t\t\t\t<div>\n\t\t\t\t\t<h1 class=\"text-2xl font-bold text-gray-900\">\n\t\t\t\t\t\tRisk Assessment Details\n\t\t\t\t\t</h1>\n\t\t\t\t\t<p class=\"text-sm text-gray-600\">\n\t\t\t\t\t\t{{ assessment?.assessment_id || 'Loading...' }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<Badge\n\t\t\t\t\t:variant=\"getStatusVariant(assessment?.status)\"\n\t\t\t\t\tclass=\"capitalize\"\n\t\t\t\t>\n\t\t\t\t\t{{ assessment?.status || 'Draft' }}\n\t\t\t\t</Badge>\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"canEdit\"\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t@click=\"toggleEditMode\"\n\t\t\t\t>\n\t\t\t\t\t<EditIcon class=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t{{ isEditMode ? 'Cancel' : 'Edit' }}\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"canApprove && assessment?.status === 'Review'\"\n\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t@click=\"approveAssessment\"\n\t\t\t\t>\n\t\t\t\t\t<CheckCircleIcon class=\"h-4 w-4 mr-2\" />\n\t\t\t\t\tApprove\n\t\t\t\t</Button>\n\t\t\t\t<AskAIButton\n\t\t\t\t\tv-if=\"assessment\"\n\t\t\t\t\tcontextType=\"risk-assessment\"\n\t\t\t\t\t:contextData=\"getRiskAssessmentContext()\"\n\t\t\t\t\tcapability=\"risk-analysis\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Loading State -->\n\t\t<div v-if=\"loading\" class=\"flex justify-center items-center py-12\">\n\t\t\t<div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n\t\t</div>\n\n\t\t<!-- Assessment Form -->\n\t\t<div v-else-if=\"assessment\" class=\"space-y-6\">\n\t\t\t<!-- Basic Information -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Assessment Information</template>\n\t\t\t\t<div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Assessment ID\"\n\t\t\t\t\t\t:value=\"assessment.assessment_id\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Assessment Name\"\n\t\t\t\t\t\tv-model=\"assessment.assessment_name\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Fiscal Year\"\n\t\t\t\t\t\tv-model=\"assessment.fiscal_year\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Assessment Date\"\n\t\t\t\t\t\tv-model=\"assessment.assessment_date\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Assessment Period\"\n\t\t\t\t\t\tv-model=\"assessment.assessment_period\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #input>\n\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\tv-model=\"assessment.assessment_period\"\n\t\t\t\t\t\t\t\t:disabled=\"!isEditMode\"\n\t\t\t\t\t\t\t\t:options=\"periodOptions\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FormControl>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Status\"\n\t\t\t\t\t\tv-model=\"assessment.status\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #input>\n\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\tv-model=\"assessment.status\"\n\t\t\t\t\t\t\t\t:disabled=\"!isEditMode\"\n\t\t\t\t\t\t\t\t:options=\"statusOptions\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FormControl>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Assessment Team -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Assessment Team</template>\n\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t<div v-for=\"(member, index) in assessment.assessment_team\" :key=\"index\" class=\"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-lg\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tlabel=\"Team Member\"\n\t\t\t\t\t\t\tv-model=\"member.team_member\"\n\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tlabel=\"Role\"\n\t\t\t\t\t\t\tv-model=\"member.role\"\n\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"flex items-end space-x-2\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t@click=\"removeTeamMember(index)\"\n\t\t\t\t\t\t\t\tclass=\"text-red-600 hover:text-red-700\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<TrashIcon class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t@click=\"addTeamMember\"\n\t\t\t\t\t\tclass=\"w-full\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<PlusIcon class=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\tAdd Team Member\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Assessment Scope & Methodology -->\n\t\t\t<div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n\t\t\t\t<Card>\n\t\t\t\t\t<template #title>Assessment Scope</template>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"assessment.assessment_scope\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\t\trows=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t\t<Card>\n\t\t\t\t\t<template #title>Methodology</template>\n\t\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t\t<div v-for=\"method in methodologyOptions\" :key=\"method.value\" class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t:id=\"`method-${method.value}`\"\n\t\t\t\t\t\t\t\tv-model=\"assessment.methodology\"\n\t\t\t\t\t\t\t\t:value=\"method.value\"\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t:disabled=\"!isEditMode\"\n\t\t\t\t\t\t\t\tclass=\"rounded border-gray-300\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<label :for=\"`method-${method.value}`\" class=\"text-sm\">\n\t\t\t\t\t\t\t\t{{ method.label }}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t<!-- Risk Register -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Risk Register</template>\n\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t<div class=\"flex justify-between items-center\">\n\t\t\t\t\t\t<h3 class=\"text-lg font-semibold\">Identified Risks</h3>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t@click=\"addRiskEntry\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PlusIcon class=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\tAdd Risk\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"overflow-x-auto\">\n\t\t\t\t\t\t<table class=\"min-w-full divide-y divide-gray-200\">\n\t\t\t\t\t\t\t<thead class=\"bg-gray-50\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tRisk ID\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tDescription\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tCategory\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tLikelihood\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tImpact\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tInherent Risk\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n\t\t\t\t\t\t\t\t\t\tActions\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t<tbody class=\"bg-white divide-y divide-gray-200\">\n\t\t\t\t\t\t\t\t<tr v-for=\"(risk, index) in assessment.risk_register\" :key=\"index\">\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n\t\t\t\t\t\t\t\t\t\t{{ risk.risk_id }}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 text-sm text-gray-900\">\n\t\t\t\t\t\t\t\t\t\t{{ risk.risk_title }}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t{{ risk.risk_category }}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t{{ risk.likelihood_score }}/5\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t{{ risk.impact_score }}/5\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t<Badge :variant=\"getRiskVariant(risk.inherent_risk_score)\">\n\t\t\t\t\t\t\t\t\t\t\t{{ risk.inherent_risk_score }}/25\n\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2\">\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"editRiskEntry(index)\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<EditIcon class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"removeRiskEntry(index)\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-red-600 hover:text-red-700\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<TrashIcon class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Risk Heat Map -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Risk Heat Map</template>\n\t\t\t\t<div class=\"flex justify-center\">\n\t\t\t\t\t<RiskHeatMap\n\t\t\t\t\t\t:risks=\"assessment.risk_register\"\n\t\t\t\t\t\t:heatMapData=\"assessment.risk_heat_map_data\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Action Plan -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Action Plan</template>\n\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t<div class=\"flex justify-between items-center\">\n\t\t\t\t\t\t<h3 class=\"text-lg font-semibold\">Mitigation Actions</h3>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t@click=\"addAction\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PlusIcon class=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\tAdd Action\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t\t<div v-for=\"(action, index) in assessment.action_plan\" :key=\"index\" class=\"p-4 border rounded-lg\">\n\t\t\t\t\t\t\t<div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Action ID\"\n\t\t\t\t\t\t\t\t\t:value=\"action.action_id\"\n\t\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Action Description\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.action_description\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Responsible Party\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.responsible_party\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Target Completion Date\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.target_completion_date\"\n\t\t\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Status\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.status\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<template #input>\n\t\t\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\t\t\tv-model=\"action.status\"\n\t\t\t\t\t\t\t\t\t\t\t:disabled=\"!isEditMode\"\n\t\t\t\t\t\t\t\t\t\t\t:options=\"actionStatusOptions\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Priority\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.priority\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<template #input>\n\t\t\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\t\t\tv-model=\"action.priority\"\n\t\t\t\t\t\t\t\t\t\t\t:disabled=\"!isEditMode\"\n\t\t\t\t\t\t\t\t\t\t\t:options=\"priorityOptions\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Estimated Cost\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.estimated_cost\"\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Actual Completion Date\"\n\t\t\t\t\t\t\t\t\tv-model=\"action.actual_completion_date\"\n\t\t\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Top Risks Summary -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Top Risks Summary</template>\n\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t<div v-for=\"risk in assessment.top_risks\" :key=\"risk.risk_id\" class=\"p-4 border rounded-lg\">\n\t\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h4 class=\"font-semibold\">{{ risk.risk_description }}</h4>\n\t\t\t\t\t\t\t\t<p class=\"text-sm text-gray-600\">Risk Score: {{ risk.inherent_risk_score }}/25</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Badge :variant=\"getRiskVariant(risk.inherent_risk_score)\">\n\t\t\t\t\t\t\t\t{{ getRiskLevel(risk.inherent_risk_score) }}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Assessment Summary & Recommendations -->\n\t\t\t<div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n\t\t\t\t<Card>\n\t\t\t\t\t<template #title>Assessment Summary</template>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"assessment.assessment_summary\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\t\trows=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t\t<Card>\n\t\t\t\t\t<template #title>Recommendations</template>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"assessment.recommendations\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\t\trows=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t<!-- Approval Information -->\n\t\t\t<Card>\n\t\t\t\t<template #title>Approval Information</template>\n\t\t\t\t<div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Prepared By\"\n\t\t\t\t\t\t:value=\"assessment.prepared_by\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Reviewed By\"\n\t\t\t\t\t\tv-model=\"assessment.reviewed_by\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Approved By\"\n\t\t\t\t\t\tv-model=\"assessment.approved_by\"\n\t\t\t\t\t\t:readonly=\"!isEditMode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Approval Date\"\n\t\t\t\t\t\t:value=\"assessment.approval_date\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</Card>\n\n\t\t\t<!-- Action Buttons -->\n\t\t\t<div class=\"flex justify-end space-x-4\">\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t@click=\"cancelChanges\"\n\t\t\t\t>\n\t\t\t\t\tCancel\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"isEditMode\"\n\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t@click=\"saveChanges\"\n\t\t\t\t\t:disabled=\"saving\"\n\t\t\t\t>\n\t\t\t\t\t<SaveIcon v-if=\"!saving\" class=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t<div v-else class=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n\t\t\t\t\t{{ saving ? 'Saving...' : 'Save Changes' }}\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Risk Entry Modal -->\n\t\t<Dialog v-model=\"showRiskModal\">\n\t\t\t<template #title>{{ editingRiskIndex !== null ? 'Edit Risk Entry' : 'Add Risk Entry' }}</template>\n\t\t\t<div class=\"space-y-4\">\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk ID\"\n\t\t\t\t\tv-model=\"riskForm.risk_id\"\n\t\t\t\t\trequired\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk Title\"\n\t\t\t\t\tv-model=\"riskForm.risk_title\"\n\t\t\t\t\trequired\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk Description\"\n\t\t\t\t\tv-model=\"riskForm.risk_description\"\n\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\trequired\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk Category\"\n\t\t\t\t\tv-model=\"riskForm.risk_category\"\n\t\t\t\t\trequired\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk Subcategory\"\n\t\t\t\t\tv-model=\"riskForm.risk_subcategory\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Auditable Entity\"\n\t\t\t\t\tv-model=\"riskForm.auditable_entity\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Threat Source\"\n\t\t\t\t\tv-model=\"riskForm.threat_source\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Vulnerability\"\n\t\t\t\t\tv-model=\"riskForm.vulnerability\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Likelihood Score (1-5)\"\n\t\t\t\t\t\tv-model.number=\"riskForm.likelihood_score\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\tmax=\"5\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tlabel=\"Impact Score (1-5)\"\n\t\t\t\t\t\tv-model.number=\"riskForm.impact_score\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\tmax=\"5\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Control Effectiveness\"\n\t\t\t\t\tv-model=\"riskForm.control_effectiveness\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Existing Controls\"\n\t\t\t\t\tv-model=\"riskForm.existing_controls\"\n\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk Owner\"\n\t\t\t\t\tv-model=\"riskForm.risk_owner\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Risk Response\"\n\t\t\t\t\tv-model=\"riskForm.risk_response\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Target Risk Score\"\n\t\t\t\t\tv-model.number=\"riskForm.target_risk_score\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<template #actions>\n\t\t\t\t<Button variant=\"outline\" @click=\"closeRiskModal\">\n\t\t\t\t\tCancel\n\t\t\t\t</Button>\n\t\t\t\t<Button @click=\"saveRiskEntry\">\n\t\t\t\t\t{{ editingRiskIndex !== null ? 'Update' : 'Add' }} Risk\n\t\t\t\t</Button>\n\t\t\t</template>\n\t\t</Dialog>\n\t</div>\n</template>\n\n<script setup>\nimport RiskHeatMap from \"@/components/RiskHeatMapGrid.vue\"\nimport AskAIButton from \"@/components/AskAIButton.vue\"\nimport { Badge, Button, Card, Dialog, FormControl, Select } from \"frappe-ui\"\nimport {\n\tArrowLeftIcon,\n\tCheckCircleIcon,\n\tEditIcon,\n\tPlusIcon,\n\tSaveIcon,\n\tTrashIcon,\n} from \"lucide-vue-next\"\nimport { computed, onMounted, ref, watch } from \"vue\"\nimport { useRoute, useRouter } from \"vue-router\"\n\n// Route and router\nconst route = useRoute()\nconst router = useRouter()\n\n// Props\nconst props = defineProps({\n\tassessmentId: {\n\t\ttype: String,\n\t\tdefault: null,\n\t},\n\tmode: {\n\t\ttype: String,\n\t\tdefault: \"view\", // 'view', 'edit', 'new'\n\t},\n})\n\n// Reactive data\nconst assessment = ref(null)\nconst loading = ref(true)\nconst saving = ref(false)\nconst isEditMode = ref(props.mode === \"edit\" || props.mode === \"new\")\nconst showRiskModal = ref(false)\nconst editingRiskIndex = ref(null)\n\n// Form data\nconst riskForm = ref({\n\trisk_id: \"\",\n\trisk_title: \"\",\n\trisk_description: \"\",\n\trisk_category: \"\",\n\trisk_subcategory: \"\",\n\tauditable_entity: \"\",\n\tthreat_source: \"\",\n\tvulnerability: \"\",\n\tlikelihood_score: 1,\n\timpact_score: 1,\n\tcontrol_effectiveness: \"\",\n\texisting_controls: \"\",\n\trisk_owner: \"\",\n\trisk_response: \"\",\n\ttarget_risk_score: 0,\n\tlikelihood_rationale: \"\",\n\timpact_rationale: \"\",\n})\n\n// Options\nconst periodOptions = [\n\t{ label: \"Annual\", value: \"Annual\" },\n\t{ label: \"Mid-Year\", value: \"Mid-Year\" },\n\t{ label: \"Quarterly\", value: \"Quarterly\" },\n\t{ label: \"Ad-hoc\", value: \"Ad-hoc\" },\n]\n\nconst statusOptions = [\n\t{ label: \"Planning\", value: \"Planning\" },\n\t{ label: \"In Progress\", value: \"In Progress\" },\n\t{ label: \"Review\", value: \"Review\" },\n\t{ label: \"Finalized\", value: \"Finalized\" },\n\t{ label: \"Approved\", value: \"Approved\" },\n]\n\nconst methodologyOptions = [\n\t{ label: \"Interview\", value: \"interview\" },\n\t{ label: \"Workshop\", value: \"workshop\" },\n\t{ label: \"Survey\", value: \"survey\" },\n\t{ label: \"Document Review\", value: \"document_review\" },\n\t{ label: \"Data Analysis\", value: \"data_analysis\" },\n]\n\nconst actionStatusOptions = [\n\t{ label: \"Planned\", value: \"Planned\" },\n\t{ label: \"In Progress\", value: \"In Progress\" },\n\t{ label: \"Completed\", value: \"Completed\" },\n\t{ label: \"Overdue\", value: \"Overdue\" },\n]\n\nconst priorityOptions = [\n\t{ label: \"Low\", value: \"Low\" },\n\t{ label: \"Medium\", value: \"Medium\" },\n\t{ label: \"High\", value: \"High\" },\n\t{ label: \"Critical\", value: \"Critical\" },\n]\n\n// Computed properties\nconst canEdit = computed(() => {\n\treturn assessment.value?.status !== \"Approved\"\n})\n\nconst canApprove = computed(() => {\n\t// Check user permissions for approval\n\treturn true // Placeholder - implement based on user roles\n})\n\n// Methods\nconst loadAssessment = async () => {\n\ttry {\n\t\tloading.value = true\n\n\t\tif (props.mode === \"new\") {\n\t\t\t// Create new assessment\n\t\t\tassessment.value = {\n\t\t\t\tassessment_id: \"\",\n\t\t\t\tassessment_name: \"\",\n\t\t\t\tassessment_date: new Date().toISOString().split(\"T\")[0],\n\t\t\t\tfiscal_year: new Date().getFullYear().toString(),\n\t\t\t\tassessment_period: \"Annual\",\n\t\t\t\tassessment_team: [],\n\t\t\t\tassessment_scope: \"\",\n\t\t\t\tmethodology: [],\n\t\t\t\tstatus: \"Planning\",\n\t\t\t\trisk_register: [],\n\t\t\t\taction_plan: [],\n\t\t\t\trisk_heat_map_data: {},\n\t\t\t\ttop_risks: [],\n\t\t\t\tassessment_summary: \"\",\n\t\t\t\trecommendations: \"\",\n\t\t\t\tprepared_by: \"\",\n\t\t\t\treviewed_by: \"\",\n\t\t\t\tapproved_by: \"\",\n\t\t\t\tapproval_date: \"\",\n\t\t\t}\n\t\t} else {\n\t\t\t// Load existing assessment\n\t\t\tconst assessmentId = props.assessmentId || route.params.id\n\t\t\tif (!assessmentId) {\n\t\t\t\tthrow new Error(\"Assessment ID is required\")\n\t\t\t}\n\n\t\t\t// TODO: Replace with actual Frappe API call\n\t\t\tconst response = await fetch(\n\t\t\t\t`/api/resource/Risk Assessment/${assessmentId}`,\n\t\t\t)\n\t\t\tif (response.ok) {\n\t\t\t\tassessment.value = await response.json()\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Failed to load assessment\")\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\tconsole.error(\"Error loading assessment:\", error)\n\n\t\t// For now, create mock data for existing assessments\n\t\tif (props.mode !== \"new\") {\n\t\t\tconst assessmentId = props.assessmentId || route.params.id\n\t\t\tassessment.value = {\n\t\t\t\tname: assessmentId,\n\t\t\t\tassessment_id: `RA-2024-${String(assessmentId).padStart(4, \"0\")}`,\n\t\t\t\tassessment_name: \"Annual Risk Assessment 2024\",\n\t\t\t\tassessment_date: \"2024-01-15\",\n\t\t\t\tfiscal_year: \"2024\",\n\t\t\t\tassessment_period: \"Annual\",\n\t\t\t\tassessment_team: [\n\t\t\t\t\t{ team_member: \"John Doe\", role: \"Lead\" },\n\t\t\t\t\t{ team_member: \"Jane Smith\", role: \"Member\" },\n\t\t\t\t],\n\t\t\t\tassessment_scope:\n\t\t\t\t\t\"Comprehensive risk assessment covering all business units and processes.\",\n\t\t\t\tmethodology: [\"interview\", \"workshop\", \"document_review\"],\n\t\t\t\tstatus: \"In Progress\",\n\t\t\t\trisk_register: [\n\t\t\t\t\t{\n\t\t\t\t\t\trisk_id: \"R001\",\n\t\t\t\t\t\trisk_title: \"Financial reporting errors\",\n\t\t\t\t\t\trisk_description:\n\t\t\t\t\t\t\t\"Financial reporting errors due to manual processes\",\n\t\t\t\t\t\trisk_category: \"Operational\",\n\t\t\t\t\t\trisk_subcategory: \"Financial Reporting\",\n\t\t\t\t\t\tauditable_entity: \"Finance Department\",\n\t\t\t\t\t\tthreat_source: \"Human error\",\n\t\t\t\t\t\tvulnerability: \"Manual data entry\",\n\t\t\t\t\t\tlikelihood_score: 4,\n\t\t\t\t\t\timpact_score: 5,\n\t\t\t\t\t\tinherent_risk_score: 20,\n\t\t\t\t\t\tcontrol_effectiveness: \"Adequate\",\n\t\t\t\t\t\texisting_controls: \"Basic review process\",\n\t\t\t\t\t\trisk_owner: \"Finance Manager\",\n\t\t\t\t\t\trisk_response: \"Mitigate\",\n\t\t\t\t\t\ttarget_risk_score: 10,\n\t\t\t\t\t\tlikelihood_rationale: \"High volume of manual entries\",\n\t\t\t\t\t\timpact_rationale: \"Material impact on financial statements\",\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\taction_plan: [\n\t\t\t\t\t{\n\t\t\t\t\t\taction_id: \"A001\",\n\t\t\t\t\t\taction_description:\n\t\t\t\t\t\t\t\"Implement automated financial reporting system\",\n\t\t\t\t\t\taction_type: \"System Enhancement\",\n\t\t\t\t\t\tpriority: \"High\",\n\t\t\t\t\t\tresponsible_party: \"IT Department\",\n\t\t\t\t\t\ttarget_completion_date: \"2024-06-30\",\n\t\t\t\t\t\testimated_cost: 50000,\n\t\t\t\t\t\tresource_required: \"IT team and software licenses\",\n\t\t\t\t\t\tstatus: \"In Progress\",\n\t\t\t\t\t\tactual_completion_date: \"\",\n\t\t\t\t\t\teffectiveness_review_date: \"\",\n\t\t\t\t\t\treview_notes: \"\",\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\trisk_heat_map_data: {},\n\t\t\t\ttop_risks: [],\n\t\t\t\tassessment_summary: \"The assessment identified several key risks...\",\n\t\t\t\trecommendations: \"Implement automated systems and enhance training...\",\n\t\t\t\tprepared_by: \"John Doe\",\n\t\t\t\treviewed_by: \"\",\n\t\t\t\tapproved_by: \"\",\n\t\t\t\tapproval_date: \"\",\n\t\t\t}\n\t\t}\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n\nconst toggleEditMode = () => {\n\tif (props.mode === \"view\") {\n\t\t// Navigate to edit route\n\t\trouter.push(\n\t\t\t`/audit-planning/risk-assessment/${props.assessmentId || route.params.id}/edit`,\n\t\t)\n\t} else {\n\t\t// Cancel edit mode\n\t\tcancelChanges()\n\t}\n}\n\nconst saveChanges = async () => {\n\ttry {\n\t\tsaving.value = true\n\n\t\t// Calculate inherent risk scores\n\t\tassessment.value.risk_register.forEach((risk) => {\n\t\t\trisk.inherent_risk_score = risk.likelihood_score * risk.impact_score\n\t\t})\n\n\t\t// Generate assessment ID if creating new\n\t\tif (props.mode === \"new\" && !assessment.value.assessment_id) {\n\t\t\tconst year = assessment.value.fiscal_year.slice(-2)\n\t\t\t// TODO: Get next number from API\n\t\t\tconst nextNumber = Math.floor(Math.random() * 1000) + 1\n\t\t\tassessment.value.assessment_id = `RA-${assessment.value.fiscal_year}-${String(nextNumber).padStart(4, \"0\")}`\n\t\t}\n\n\t\tlet response\n\t\tif (props.mode === \"new\") {\n\t\t\t// TODO: Replace with actual Frappe API call for creating\n\t\t\tresponse = await fetch(\"/api/resource/Risk Assessment\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify(assessment.value),\n\t\t\t})\n\t\t} else {\n\t\t\t// TODO: Replace with actual Frappe API call for updating\n\t\t\tconst assessmentId = props.assessmentId || route.params.id\n\t\t\tresponse = await fetch(`/api/resource/Risk Assessment/${assessmentId}`, {\n\t\t\t\tmethod: \"PUT\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify(assessment.value),\n\t\t\t})\n\t\t}\n\n\t\tif (response.ok) {\n\t\t\tconst savedAssessment = await response.json()\n\n\t\t\tif (props.mode === \"new\") {\n\t\t\t\t// Redirect to detail view after creating\n\t\t\t\trouter.push(`/audit-planning/risk-assessment/${savedAssessment.name}`)\n\t\t\t} else {\n\t\t\t\tisEditMode.value = false\n\t\t\t\t// Reload to get updated data\n\t\t\t\tawait loadAssessment()\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(\"Failed to save changes\")\n\t\t}\n\t} catch (error) {\n\t\tconsole.error(\"Error saving changes:\", error)\n\t} finally {\n\t\tsaving.value = false\n\t}\n}\n\nconst cancelChanges = () => {\n\tif (props.mode === \"new\") {\n\t\t// Go back to list for new assessments\n\t\trouter.push(\"/audit-planning/risk-assessment\")\n\t} else if (props.mode === \"edit\") {\n\t\t// Go back to view mode for existing assessments\n\t\trouter.push(\n\t\t\t`/audit-planning/risk-assessment/${props.assessmentId || route.params.id}`,\n\t\t)\n\t} else {\n\t\t// Just exit edit mode\n\t\tisEditMode.value = false\n\t\tloadAssessment()\n\t}\n}\n\nconst approveAssessment = async () => {\n\ttry {\n\t\tassessment.value.status = \"Approved\"\n\t\tassessment.value.approved_by = \"Current User\" // TODO: Get from session\n\t\tassessment.value.approval_date = new Date().toISOString().split(\"T\")[0]\n\t\tawait saveChanges()\n\t} catch (error) {\n\t\tconsole.error(\"Error approving assessment:\", error)\n\t}\n}\n\nconst addTeamMember = () => {\n\tassessment.value.assessment_team.push({\n\t\tteam_member: \"\",\n\t\trole: \"\",\n\t})\n}\n\nconst removeTeamMember = (index) => {\n\tassessment.value.assessment_team.splice(index, 1)\n}\n\nconst addRiskEntry = () => {\n\teditingRiskIndex.value = null\n\triskForm.value = {\n\t\trisk_id: `R${String(assessment.value.risk_register.length + 1).padStart(3, \"0\")}`,\n\t\trisk_title: \"\",\n\t\trisk_description: \"\",\n\t\trisk_category: \"\",\n\t\trisk_subcategory: \"\",\n\t\tauditable_entity: \"\",\n\t\tthreat_source: \"\",\n\t\tvulnerability: \"\",\n\t\tlikelihood_score: 1,\n\t\timpact_score: 1,\n\t\tcontrol_effectiveness: \"\",\n\t\texisting_controls: \"\",\n\t\trisk_owner: \"\",\n\t\trisk_response: \"\",\n\t\ttarget_risk_score: 0,\n\t\tlikelihood_rationale: \"\",\n\t\timpact_rationale: \"\",\n\t}\n\tshowRiskModal.value = true\n}\n\nconst editRiskEntry = (index) => {\n\teditingRiskIndex.value = index\n\triskForm.value = { ...assessment.value.risk_register[index] }\n\tshowRiskModal.value = true\n}\n\nconst removeRiskEntry = (index) => {\n\tassessment.value.risk_register.splice(index, 1)\n}\n\nconst saveRiskEntry = () => {\n\tconst riskData = {\n\t\t...riskForm.value,\n\t\tinherent_risk_score:\n\t\t\triskForm.value.likelihood_score * riskForm.value.impact_score,\n\t}\n\n\tif (editingRiskIndex.value !== null) {\n\t\tassessment.value.risk_register[editingRiskIndex.value] = riskData\n\t} else {\n\t\tassessment.value.risk_register.push(riskData)\n\t}\n\n\tcloseRiskModal()\n}\n\nconst closeRiskModal = () => {\n\tshowRiskModal.value = false\n\teditingRiskIndex.value = null\n\triskForm.value = {\n\t\trisk_id: \"\",\n\t\trisk_title: \"\",\n\t\trisk_description: \"\",\n\t\trisk_category: \"\",\n\t\trisk_subcategory: \"\",\n\t\tauditable_entity: \"\",\n\t\tthreat_source: \"\",\n\t\tvulnerability: \"\",\n\t\tlikelihood_score: 1,\n\t\timpact_score: 1,\n\t\tcontrol_effectiveness: \"\",\n\t\texisting_controls: \"\",\n\t\trisk_owner: \"\",\n\t\trisk_response: \"\",\n\t\ttarget_risk_score: 0,\n\t\tlikelihood_rationale: \"\",\n\t\timpact_rationale: \"\",\n\t}\n}\n\nconst addAction = () => {\n\tassessment.value.action_plan.push({\n\t\taction_id: `A${String(assessment.value.action_plan.length + 1).padStart(3, \"0\")}`,\n\t\taction_description: \"\",\n\t\taction_type: \"\",\n\t\tpriority: \"Medium\",\n\t\tresponsible_party: \"\",\n\t\ttarget_completion_date: \"\",\n\t\testimated_cost: 0,\n\t\tresource_required: \"\",\n\t\tstatus: \"Not Started\",\n\t\tactual_completion_date: \"\",\n\t\teffectiveness_review_date: \"\",\n\t\treview_notes: \"\",\n\t})\n}\n\nconst removeAction = (index) => {\n\tassessment.value.action_plan.splice(index, 1)\n}\n\nconst getStatusVariant = (status) => {\n\tconst variants = {\n\t\tPlanning: \"secondary\",\n\t\t\"In Progress\": \"warning\",\n\t\tReview: \"info\",\n\t\tFinalized: \"success\",\n\t\tApproved: \"success\",\n\t}\n\treturn variants[status] || \"secondary\"\n}\n\nconst getRiskVariant = (score) => {\n\tif (score >= 20) return \"destructive\"\n\tif (score >= 15) return \"warning\"\n\tif (score >= 10) return \"secondary\"\n\treturn \"success\"\n}\n\nconst getRiskLevel = (score) => {\n\tif (score >= 20) return \"Critical\"\n\tif (score >= 15) return \"High\"\n\tif (score >= 10) return \"Medium\"\n\treturn \"Low\"\n}\n\nconst getRiskAssessmentContext = () => {\n\tif (!assessment.value) return {}\n\n\treturn {\n\t\tassessmentId: assessment.value.name || assessment.value.assessment_id,\n\t\tassessmentName: assessment.value.assessment_name,\n\t\tfiscalYear: assessment.value.fiscal_year,\n\t\tassessmentPeriod: assessment.value.assessment_period,\n\t\tstatus: assessment.value.status,\n\t\tscope: assessment.value.assessment_scope,\n\t\tmethodology: assessment.value.methodology,\n\t\tteamMembers: assessment.value.assessment_team?.length || 0,\n\t\triskCount: assessment.value.risk_register?.length || 0,\n\t\tactionCount: assessment.value.action_plan?.length || 0,\n\t\thighRiskCount: assessment.value.risk_register?.filter(r => r.inherent_risk_score >= 15).length || 0,\n\t\tcriticalRiskCount: assessment.value.risk_register?.filter(r => r.inherent_risk_score >= 20).length || 0,\n\t\tassessmentSummary: assessment.value.assessment_summary,\n\t\trecommendations: assessment.value.recommendations,\n\t\tpreparedBy: assessment.value.prepared_by,\n\t\t// Include key risk data for AI analysis\n\t\ttopRisks: assessment.value.top_risks?.slice(0, 3).map(r => ({\n\t\t\tid: r.risk_id,\n\t\t\ttitle: r.risk_title,\n\t\t\tscore: r.inherent_risk_score,\n\t\t\tcategory: r.risk_category,\n\t\t\towner: r.risk_owner\n\t\t})) || [],\n\t\t// Include action plan summary\n\t\tpendingActions: assessment.value.action_plan?.filter(a => a.status !== 'Completed').length || 0,\n\t\tcompletedActions: assessment.value.action_plan?.filter(a => a.status === 'Completed').length || 0\n\t}\n}\n\n// Watch for risk register changes to update heat map\nwatch(\n\t() => assessment.value?.risk_register,\n\t(newRisks) => {\n\t\tif (newRisks) {\n\t\t\tupdateHeatMapData()\n\t\t}\n\t},\n\t{ deep: true },\n)\n\nconst updateHeatMapData = () => {\n\tif (!assessment.value) return\n\n\tconst heatMap = {}\n\tassessment.value.risk_register.forEach((risk) => {\n\t\tconst key = `${risk.likelihood_score}-${risk.impact_score}`\n\t\theatMap[key] = (heatMap[key] || 0) + 1\n\t})\n\n\tassessment.value.risk_heat_map_data = heatMap\n\n\t// Update top risks\n\tassessment.value.top_risks = [...assessment.value.risk_register]\n\t\t.sort((a, b) => b.inherent_risk_score - a.inherent_risk_score)\n\t\t.slice(0, 5)\n}\n\n// Lifecycle\nonMounted(() => {\n\tloadAssessment()\n})\n</script>"],"names":["props","__props","showDetailsModal","ref","selectedCell","cellRisks","computed","risk","getCellClass","likelihood","impact","riskScore","count","getCellCount","baseClass","key","onCellClick","getRiskVariant","score","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_Fragment","_renderList","_hoisted_3","_toDisplayString","$event","_hoisted_4","_createVNode","_unref","Dialog","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","Badge","route","useRoute","router","useRouter","assessment","loading","saving","isEditMode","showRiskModal","editingRiskIndex","riskForm","periodOptions","statusOptions","methodologyOptions","actionStatusOptions","priorityOptions","canEdit","_a","canApprove","loadAssessment","__async","assessmentId","response","error","toggleEditMode","cancelChanges","saveChanges","year","nextNumber","savedAssessment","approveAssessment","addTeamMember","removeTeamMember","index","addRiskEntry","editRiskEntry","__spreadValues","removeRiskEntry","saveRiskEntry","riskData","__spreadProps","closeRiskModal","addAction","getStatusVariant","status","getRiskLevel","getRiskAssessmentContext","_b","_c","_d","r","_e","_f","_g","a","_h","watch","newRisks","updateHeatMapData","heatMap","b","onMounted","Button","_cache","$router","ArrowLeftIcon","_createTextVNode","_createBlock","EditIcon","CheckCircleIcon","AskAIButton","Card","FormControl","Select","member","TrashIcon","PlusIcon","method","_vModelCheckbox","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","RiskHeatMap","_hoisted_28","_hoisted_29","_hoisted_30","action","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","SaveIcon","_hoisted_40","_hoisted_41"],"mappings":"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"}