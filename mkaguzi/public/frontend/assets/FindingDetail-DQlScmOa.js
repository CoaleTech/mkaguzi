var q=Object.defineProperty,H=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var B=(u,d,r)=>d in u?q(u,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[d]=r,E=(u,d)=>{for(var r in d||(d={}))U.call(d,r)&&B(u,r,d[r]);if(S)for(var r of S(d))G.call(d,r)&&B(u,r,d[r]);return u},I=(u,d)=>H(u,Q(d));var N=(u,d,r)=>new Promise((s,_)=>{var A=p=>{try{b(r.next(p))}catch(h){_(h)}},D=p=>{try{b(r.throw(p))}catch(h){_(h)}},b=p=>p.done?s(p.value):Promise.resolve(p.value).then(A,D);b((r=r.apply(u,d)).next())});import{a as x,A as J,S as K,c as F,m as W}from"./index-qIC3Tfxg.js";import{ap as X,r as R,Q as Y,l as m,p as c,q as t,A as a,s as o,y as Z,H as tt,u as g,z as v,v as l,F as C,x as k}from"./vue-DciwFjI_.js";import{a0 as et,aa as st,n as it,F as at,N as V,d as nt,b8 as ot}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const lt={class:"space-y-6"},rt={class:"flex items-center justify-between"},dt={class:"text-2xl font-bold text-gray-900"},ct={class:"text-gray-600 mt-1"},ut={class:"flex items-center space-x-3"},mt={key:0,class:"flex justify-center items-center py-12"},gt={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},vt={class:"lg:col-span-2 space-y-6"},pt={class:"bg-white rounded-lg border border-gray-200 p-6"},yt={class:"grid grid-cols-2 gap-4"},xt={class:"font-medium"},ft={class:"font-medium"},_t={class:"font-medium"},bt={class:"font-medium"},ht={class:"bg-white rounded-lg border border-gray-200 p-6"},wt={class:"prose prose-sm max-w-none"},Ct={class:"bg-white rounded-lg border border-gray-200 p-6"},kt={class:"prose prose-sm max-w-none"},At={class:"bg-white rounded-lg border border-gray-200 p-6"},Dt={class:"space-y-4"},Ft={class:"text-gray-700"},St={class:"text-gray-700"},Bt={class:"text-gray-700"},Et={class:"bg-white rounded-lg border border-gray-200 p-6"},It={class:"space-y-2"},Nt={class:"text-gray-700"},Rt={class:"bg-white rounded-lg border border-gray-200 p-6"},Vt={class:"space-y-4"},Mt={class:"flex items-start justify-between"},Pt={class:"flex-1"},Tt={class:"font-medium text-gray-900"},jt={class:"text-gray-600 mt-1"},Lt={class:"flex items-center space-x-4 mt-2"},$t={class:"text-sm text-gray-500"},zt={class:"text-sm text-gray-500"},Ot={class:"space-y-6"},qt={class:"bg-white rounded-lg border border-gray-200 p-6"},Ht={class:"space-y-3"},Qt={class:"flex items-center"},Ut={class:"font-medium text-sm"},Gt={class:"text-xs text-gray-600"},Jt={class:"bg-white rounded-lg border border-gray-200 p-6"},Kt={class:"space-y-4"},Wt={class:"ml-4"},Xt={class:"text-sm font-medium text-gray-900"},Yt={class:"text-xs text-gray-600"},Zt={class:"bg-white rounded-lg border border-gray-200 p-6"},te={class:"space-y-2"},ee={key:2,class:"text-center py-12"},re={__name:"FindingDetail",setup(u){const d=X(),r=R(!0),s=R(null),_=()=>N(this,null,function*(){r.value=!0;try{const i=yield W({url:"frappe.client.get",params:{doctype:"Audit Finding",name:d.params.id}}).fetch();i&&(s.value=I(E({},i),{title:i.finding_title,description:i.finding_description,severity:i.risk_rating,status:i.finding_status,reportedBy:i.responsible_person,reportedDate:i.creation,engagement:i.engagement_reference,category:i.finding_category,rootCause:i.root_cause_analysis,impact:{financial:i.financial_impact,operational:i.operational_impact,compliance:i.compliance_impact},recommendations:i.recommendations?i.recommendations.split(`
`).filter(e=>e.trim()).map((e,f)=>({id:f+1,description:e.trim()})):[],correctiveActions:[],evidence:i.finding_evidence||[],timeline:[]}))}catch(i){console.error("Failed to load finding:",i)}finally{r.value=!1}}),A=i=>({High:"danger",Medium:"warning",Low:"success"})[i]||"secondary",D=i=>({Open:"danger","In Progress":"warning",Resolved:"success",Closed:"secondary"})[i]||"secondary",b=i=>({Pending:"secondary","In Progress":"warning",Completed:"success",Overdue:"danger"})[i]||"secondary",p=i=>new Date(i).toLocaleDateString(),h=()=>{},M=()=>{},P=i=>{},T=i=>{},j=()=>{},L=()=>{},$=()=>{},z=()=>{},O=()=>{var i,e,f,w,n;return s.value?{findingId:s.value.name||s.value.id,title:s.value.title,severity:s.value.severity,status:s.value.status,category:s.value.category,entityName:s.value.entityName,description:s.value.description,rootCause:s.value.rootCause,recommendation:s.value.recommendation,reportedBy:s.value.reportedBy,reportedDate:s.value.reportedDate,dueDate:s.value.dueDate,correctiveActionsCount:((i=s.value.correctiveActions)==null?void 0:i.length)||0,evidenceCount:((e=s.value.evidence)==null?void 0:e.length)||0,openActions:((f=s.value.correctiveActions)==null?void 0:f.filter(y=>y.status!=="Completed").length)||0,completedActions:((w=s.value.correctiveActions)==null?void 0:w.filter(y=>y.status==="Completed").length)||0,overdueActions:((n=s.value.correctiveActions)==null?void 0:n.filter(y=>y.dueDate&&new Date(y.dueDate)<new Date&&y.status!=="Completed").length)||0}:{}};return Y(()=>{_()}),(i,e)=>{var f,w;return c(),m("div",lt,[t("div",rt,[t("div",null,[t("h1",dt,a(((f=s.value)==null?void 0:f.title)||"Finding Details"),1),t("p",ct,a(((w=s.value)==null?void 0:w.description)||"Loading finding details..."),1)]),t("div",ut,[o(l(x),{variant:"outline",onClick:h},{default:g(()=>[o(l(et),{class:"h-4 w-4 mr-2"}),e[0]||(e[0]=v(" Export ",-1))]),_:1}),o(l(x),{onClick:M},{default:g(()=>[o(l(st),{class:"h-4 w-4 mr-2"}),e[1]||(e[1]=v(" Edit ",-1))]),_:1}),s.value?(c(),Z(J,{key:0,contextType:"audit-finding",contextData:O(),capability:"finding-analysis"},null,8,["contextData"])):tt("",!0)])]),r.value?(c(),m("div",mt,[o(l(K),{class:"h-8 w-8"})])):s.value?(c(),m("div",gt,[t("div",vt,[t("div",pt,[e[8]||(e[8]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Details",-1)),t("div",yt,[t("div",null,[e[2]||(e[2]=t("p",{class:"text-sm text-gray-600"},"Severity",-1)),o(l(F),{variant:A(s.value.severity),class:"mt-1"},{default:g(()=>[v(a(s.value.severity),1)]),_:1},8,["variant"])]),t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-600"},"Status",-1)),o(l(F),{variant:D(s.value.status),class:"mt-1"},{default:g(()=>[v(a(s.value.status),1)]),_:1},8,["variant"])]),t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-600"},"Reported By",-1)),t("p",xt,a(s.value.reportedBy),1)]),t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-600"},"Reported Date",-1)),t("p",ft,a(p(s.value.reportedDate)),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-600"},"Engagement",-1)),t("p",_t,a(s.value.engagement),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-600"},"Category",-1)),t("p",bt,a(s.value.category),1)])])]),t("div",ht,[e[9]||(e[9]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Description",-1)),t("div",wt,[t("p",null,a(s.value.description),1)])]),t("div",Ct,[e[10]||(e[10]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Root Cause Analysis",-1)),t("div",kt,[t("p",null,a(s.value.rootCause),1)])]),t("div",At,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Impact Assessment",-1)),t("div",Dt,[t("div",null,[e[11]||(e[11]=t("h3",{class:"font-medium text-gray-900"},"Financial Impact",-1)),t("p",Ft,a(s.value.impact.financial),1)]),t("div",null,[e[12]||(e[12]=t("h3",{class:"font-medium text-gray-900"},"Operational Impact",-1)),t("p",St,a(s.value.impact.operational),1)]),t("div",null,[e[13]||(e[13]=t("h3",{class:"font-medium text-gray-900"},"Compliance Impact",-1)),t("p",Bt,a(s.value.impact.compliance),1)])])]),t("div",Et,[e[15]||(e[15]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Recommendations",-1)),t("ul",It,[(c(!0),m(C,null,k(s.value.recommendations,n=>(c(),m("li",{key:n.id,class:"flex items-start"},[o(l(it),{class:"h-5 w-5 text-blue-500 mt-0.5 mr-2 flex-shrink-0"}),t("span",Nt,a(n.description),1)]))),128))])]),t("div",Rt,[e[17]||(e[17]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Corrective Actions",-1)),t("div",Vt,[(c(!0),m(C,null,k(s.value.correctiveActions,n=>(c(),m("div",{key:n.id,class:"border border-gray-200 rounded-lg p-4"},[t("div",Mt,[t("div",Pt,[t("h3",Tt,a(n.title),1),t("p",jt,a(n.description),1),t("div",Lt,[o(l(F),{variant:b(n.status)},{default:g(()=>[v(a(n.status),1)]),_:2},1032,["variant"]),t("span",$t," Due: "+a(p(n.dueDate)),1),t("span",zt," Assigned to: "+a(n.assignedTo),1)])]),o(l(x),{variant:"ghost",size:"sm",onClick:y=>P()},{default:g(()=>[...e[16]||(e[16]=[v(" Update ",-1)])]),_:1},8,["onClick"])])]))),128))])])]),t("div",Ot,[t("div",qt,[e[20]||(e[20]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Evidence",-1)),t("div",Ht,[(c(!0),m(C,null,k(s.value.evidence,n=>(c(),m("div",{key:n.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",Qt,[o(l(at),{class:"h-5 w-5 text-gray-400 mr-3"}),t("div",null,[t("p",Ut,a(n.name),1),t("p",Gt,a(n.type),1)])]),o(l(x),{variant:"ghost",size:"sm",onClick:y=>T()},{default:g(()=>[...e[18]||(e[18]=[v(" View ",-1)])]),_:1},8,["onClick"])]))),128))]),o(l(x),{variant:"outline",block:"",class:"mt-4",onClick:j},{default:g(()=>[o(l(V),{class:"h-4 w-4 mr-2"}),e[19]||(e[19]=v(" Add Evidence ",-1))]),_:1})]),t("div",Jt,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Timeline",-1)),t("div",Kt,[(c(!0),m(C,null,k(s.value.timeline,n=>(c(),m("div",{key:n.id,class:"flex"},[e[21]||(e[21]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-2 h-2 bg-blue-600 rounded-full mt-2"})],-1)),t("div",Wt,[t("p",Xt,a(n.title),1),t("p",Yt,a(p(n.date)),1)])]))),128))])]),t("div",Zt,[e[26]||(e[26]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),t("div",te,[o(l(x),{variant:"outline",block:"",onClick:L},{default:g(()=>[o(l(V),{class:"h-4 w-4 mr-2"}),e[23]||(e[23]=v(" Add Action ",-1))]),_:1}),o(l(x),{variant:"outline",block:"",onClick:$},{default:g(()=>[o(l(nt),{class:"h-4 w-4 mr-2"}),e[24]||(e[24]=v(" Schedule Follow-up ",-1))]),_:1}),o(l(x),{variant:"outline",block:"",onClick:z},{default:g(()=>[o(l(ot),{class:"h-4 w-4 mr-2"}),e[25]||(e[25]=v(" Notify Management ",-1))]),_:1})])])])])):(c(),m("div",ee,[e[28]||(e[28]=t("p",{class:"text-gray-600"},"Failed to load finding details.",-1)),o(l(x),{onClick:_,class:"mt-4"},{default:g(()=>[...e[27]||(e[27]=[v("Retry",-1)])]),_:1})]))])}}};export{re as default};
//# sourceMappingURL=FindingDetail-DQlScmOa.js.map
