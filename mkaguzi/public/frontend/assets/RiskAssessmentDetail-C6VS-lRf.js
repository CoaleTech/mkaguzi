var be=Object.defineProperty,Ve=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var Z=(b,f,v)=>f in b?be(b,f,{enumerable:!0,configurable:!0,writable:!0,value:v}):b[f]=v,P=(b,f)=>{for(var v in f||(f={}))he.call(f,v)&&Z(b,v,f[v]);if(X)for(var v of X(f))$e.call(f,v)&&Z(b,v,f[v]);return b},ee=(b,f)=>Ve(b,we(f));var T=(b,f,v)=>new Promise((k,l)=>{var A=V=>{try{n(v.next(V))}catch(y){l(y)}},h=V=>{try{n(v.throw(V))}catch(y){l(y)}},n=V=>V.done?k(V.value):Promise.resolve(V.value).then(A,h);n((v=v.apply(b,f)).next())});import{y as H,z as Ce,B as le,b as c,d as u,g as a,i as _,t as p,e as o,f as w,D as O,r as M,c as F,G as Re,F as I,q as D,p as Ue,h as i,j as s,k as j,J as ae,a as Ae,u as Se,w as Me,o as Ie,A as De,_ as $,l as C,S as te,K as Ee,L as m,m as q,T as se,P as B,M as Le,N as Pe,O as Te,x as N}from"./index-DyBJn5r4.js";const qe={name:"Loading",props:{text:{type:String,default:"Loading..."}},components:{LoadingIndicator:Ce}},je={class:"flex items-center text-base text-ink-gray-4"};function ze(b,f,v,k,l,A){const h=le("LoadingIndicator");return u(),c("div",je,[a(h,{class:"-ml-1 mr-2 h-3 w-3"}),_(" "+p(v.text),1)])}const Oe=H(qe,[["render",ze]]),Be={name:"Card",props:{title:{type:String},subtitle:{type:String},loading:{type:Boolean}},components:{LoadingText:Oe}},Ne={class:"flex flex-col rounded-lg border bg-white px-6 py-5 shadow"},Fe={class:"flex items-baseline justify-between"},He={class:"flex items-baseline space-x-2"},Ye={key:0,class:"flex items-center space-x-2"},Qe={class:"text-xl font-semibold"},Ge={key:0,class:"flex items-center space-x-2"},Je={key:0,class:"mt-1.5 text-base text-gray-600"},Ke={key:1,class:"mt-4 flex flex-auto flex-col items-center justify-center rounded-md"},We={key:2,class:"mt-4 flex-auto overflow-auto"};function Xe(b,f,v,k,l,A){const h=le("LoadingText");return u(),c("div",Ne,[o("div",Fe,[o("div",He,[b.$slots["actions-left"]?(u(),c("div",Ye,[O(b.$slots,"actions-left")])):w("",!0),o("h2",Qe,p(v.title),1)]),b.$slots.actions?(u(),c("div",Ge,[O(b.$slots,"actions")])):w("",!0)]),v.subtitle?(u(),c("p",Je,p(v.subtitle),1)):w("",!0),v.loading?(u(),c("div",Ke,[a(h)])):b.$slots.default?(u(),c("div",We,[O(b.$slots,"default")])):w("",!0)])}const R=H(Be,[["render",Xe]]),Ze={class:"risk-heat-map"},et={class:"grid grid-cols-6 gap-1 max-w-md mx-auto"},tt={class:"text-center text-sm font-medium text-gray-700 p-2 flex items-center justify-center"},st=["onClick"],lt={class:"space-y-4 max-h-96 overflow-y-auto"},at={key:0,class:"text-center text-gray-500 py-8"},ot={key:1,class:"space-y-3"},dt={class:"flex items-start justify-between"},rt={class:"flex-1"},it={class:"font-medium text-sm"},nt={class:"text-sm text-gray-600 mt-1"},ut={class:"text-xs text-gray-500 mt-1"},mt={__name:"RiskHeatMap",props:{risks:{type:Array,default:()=>[]},heatMapData:{type:Object,default:()=>({})}},setup(b){const f=b,v=M(!1),k=M({likelihood:0,impact:0}),l=F(()=>!k.value.likelihood||!k.value.impact?[]:f.risks.filter(y=>y.likelihood_score===k.value.likelihood&&y.impact_score===k.value.impact)),A=(y,r)=>{const g=y*r,E=h(y,r);let S="border-gray-200";return g>=19?S="bg-red-100 border-red-300 text-red-800":g>=13?S="bg-orange-100 border-orange-300 text-orange-800":g>=7?S="bg-yellow-100 border-yellow-300 text-yellow-800":S="bg-green-100 border-green-300 text-green-800",E>0&&(S+=" font-bold"),S},h=(y,r)=>{const g=`${y}-${r}`;return f.heatMapData[g]||0},n=(y,r)=>{k.value={likelihood:y,impact:r},v.value=!0},V=y=>y>=20?"destructive":y>=15?"warning":y>=10?"secondary":"success";return(y,r)=>(u(),c("div",Ze,[o("div",et,[r[1]||(r[1]=o("div",{class:"col-span-1"},null,-1)),(u(),c(I,null,D(5,g=>o("div",{key:`impact-${g}`,class:"text-center text-sm font-medium text-gray-700 p-2"},p(g),1)),64)),(u(),c(I,null,D(5,g=>o("div",{key:`likelihood-${g}`,class:"contents"},[o("div",tt,p(g),1),(u(),c(I,null,D(5,E=>o("div",{key:`cell-${g}-${E}`,class:Ue([A(g,E),"aspect-square rounded border cursor-pointer transition-all duration-200 hover:scale-105 flex items-center justify-center text-xs font-medium"]),onClick:S=>n(g,E)},p(h(g,E)),11,st)),64))])),64))]),r[2]||(r[2]=Re('<div class="flex justify-center mt-6 space-x-4" data-v-d855dd81><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-green-100 border border-green-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>Low (1-6)</span></div><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-yellow-100 border border-yellow-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>Medium (7-12)</span></div><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-orange-100 border border-orange-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>High (13-18)</span></div><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-red-100 border border-red-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>Critical (19-25)</span></div></div><div class="text-center mt-4" data-v-d855dd81><div class="grid grid-cols-2 gap-8 max-w-md mx-auto" data-v-d855dd81><div class="text-sm text-gray-600" data-v-d855dd81><div class="font-medium" data-v-d855dd81>Likelihood</div><div class="text-xs" data-v-d855dd81>1 = Rare, 5 = Almost Certain</div></div><div class="text-sm text-gray-600" data-v-d855dd81><div class="font-medium" data-v-d855dd81>Impact</div><div class="text-xs" data-v-d855dd81>1 = Minor, 5 = Catastrophic</div></div></div></div>',2)),a(s(ae),{modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=g=>v.value=g)},{title:i(()=>[_("Risks in "+p(k.value.likelihood)+"x"+p(k.value.impact)+" Cell",1)]),default:i(()=>[o("div",lt,[l.value.length===0?(u(),c("div",at," No risks in this cell ")):(u(),c("div",ot,[(u(!0),c(I,null,D(l.value,g=>(u(),c("div",{key:g.risk_id,class:"p-3 border rounded-lg"},[o("div",dt,[o("div",rt,[o("div",it,p(g.risk_id),1),o("div",nt,p(g.risk_description),1),o("div",ut," Category: "+p(g.risk_category),1)]),a(s(j),{variant:V(g.inherent_risk_score),class:"ml-2"},{default:i(()=>[_(p(g.inherent_risk_score)+"/25 ",1)]),_:2},1032,["variant"])])]))),128))]))])]),_:1},8,["modelValue"])]))}},vt=H(mt,[["__scopeId","data-v-d855dd81"]]),pt={class:"space-y-6"},ct={class:"flex items-center justify-between"},_t={class:"flex items-center space-x-4"},yt={class:"text-sm text-gray-600"},gt={class:"flex items-center space-x-2"},ft={key:0,class:"flex justify-center items-center py-12"},kt={key:1,class:"space-y-6"},xt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},bt={class:"space-y-4"},Vt={class:"flex items-end space-x-2"},wt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ht={class:"space-y-4"},$t=["id","value","disabled"],Ct=["for"],Rt={class:"space-y-4"},Ut={class:"flex justify-between items-center"},At={class:"overflow-x-auto"},St={class:"min-w-full divide-y divide-gray-200"},Mt={class:"bg-white divide-y divide-gray-200"},It={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Dt={class:"px-6 py-4 text-sm text-gray-900"},Et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Pt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Tt={class:"px-6 py-4 whitespace-nowrap"},qt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},jt={class:"flex justify-center"},zt={class:"space-y-4"},Ot={class:"flex justify-between items-center"},Bt={class:"space-y-4"},Nt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Ft={class:"space-y-4"},Ht={class:"flex items-center justify-between"},Yt={class:"font-semibold"},Qt={class:"text-sm text-gray-600"},Gt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Jt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Kt={class:"flex justify-end space-x-4"},Wt={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Xt={class:"space-y-4"},Zt={class:"grid grid-cols-2 gap-4"},ss={__name:"RiskAssessmentDetail",props:{assessmentId:{type:String,default:null},mode:{type:String,default:"view"}},setup(b){const f=Ae(),v=Se(),k=b,l=M(null),A=M(!0),h=M(!1),n=M(k.mode==="edit"||k.mode==="new"),V=M(!1),y=M(null),r=M({risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""}),g=[{label:"Annual",value:"Annual"},{label:"Mid-Year",value:"Mid-Year"},{label:"Quarterly",value:"Quarterly"},{label:"Ad-hoc",value:"Ad-hoc"}],E=[{label:"Planning",value:"Planning"},{label:"In Progress",value:"In Progress"},{label:"Review",value:"Review"},{label:"Finalized",value:"Finalized"},{label:"Approved",value:"Approved"}],S=[{label:"Interview",value:"interview"},{label:"Workshop",value:"workshop"},{label:"Survey",value:"survey"},{label:"Document Review",value:"document_review"},{label:"Data Analysis",value:"data_analysis"}],oe=[{label:"Planned",value:"Planned"},{label:"In Progress",value:"In Progress"},{label:"Completed",value:"Completed"},{label:"Overdue",value:"Overdue"}],de=[{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],re=F(()=>{var d;return((d=l.value)==null?void 0:d.status)!=="Approved"}),ie=F(()=>!0),z=()=>T(this,null,function*(){A.value=!0;try{if(k.mode==="new")l.value={assessment_id:"",assessment_name:"",assessment_date:new Date().toISOString().split("T")[0],fiscal_year:new Date().getFullYear().toString(),assessment_period:"Annual",assessment_team:[],assessment_scope:"",methodology:[],status:"Planning",risk_register:[],action_plan:[],risk_heat_map_data:{},top_risks:[],assessment_summary:"",recommendations:"",prepared_by:"",reviewed_by:"",approved_by:"",approval_date:""};else{const d=k.assessmentId||f.params.id;if(!d)throw new Error("Assessment ID is required");const e=yield N({url:"frappe.client.get",params:{doctype:"Risk Assessment",name:d}}).fetch();l.value=e}}catch(d){console.error("Error loading assessment:",d)}finally{A.value=!1}}),ne=()=>{k.mode==="view"?v.push(`/audit-planning/risk-assessment/${k.assessmentId||f.params.id}/edit`):Q()},Y=()=>T(this,null,function*(){h.value=!0;try{if(l.value.risk_register.forEach(d=>{d.inherent_risk_score=d.likelihood_score*d.impact_score}),k.mode==="new"&&!l.value.assessment_id){const d=l.value.fiscal_year.slice(-2),e=Math.floor(Math.random()*1e3)+1;l.value.assessment_id=`RA-${l.value.fiscal_year}-${String(e).padStart(4,"0")}`}if(k.mode==="new"){const d=yield N({url:"frappe.client.insert",params:{doc:P({doctype:"Risk Assessment"},l.value)}}).fetch();v.push(`/audit-planning/risk-assessment/${d.name}`)}else{const d=k.assessmentId||f.params.id,e=P({doctype:"Risk Assessment",name:d},l.value);yield N({url:"frappe.client.save",params:{doc:e}}).fetch(),n.value=!1,yield z()}}catch(d){console.error("Error saving changes:",d)}finally{h.value=!1}}),Q=()=>{k.mode==="new"?v.push("/audit-planning/risk-assessment"):k.mode==="edit"?v.push(`/audit-planning/risk-assessment/${k.assessmentId||f.params.id}`):(n.value=!1,z())},ue=()=>T(this,null,function*(){try{l.value.status="Approved",l.value.approved_by="Current User",l.value.approval_date=new Date().toISOString().split("T")[0],yield Y()}catch(d){console.error("Error approving assessment:",d)}}),me=()=>{l.value.assessment_team.push({team_member:"",role:""})},ve=d=>{l.value.assessment_team.splice(d,1)},pe=()=>{y.value=null,r.value={risk_id:`R${String(l.value.risk_register.length+1).padStart(3,"0")}`,risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""},V.value=!0},ce=d=>{y.value=d,r.value=P({},l.value.risk_register[d]),V.value=!0},_e=d=>{l.value.risk_register.splice(d,1)},ye=()=>{const d=ee(P({},r.value),{inherent_risk_score:r.value.likelihood_score*r.value.impact_score});y.value!==null?l.value.risk_register[y.value]=d:l.value.risk_register.push(d),G()},G=()=>{V.value=!1,y.value=null,r.value={risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""}},ge=()=>{l.value.action_plan.push({action_id:`A${String(l.value.action_plan.length+1).padStart(3,"0")}`,action_description:"",action_type:"",priority:"Medium",responsible_party:"",target_completion_date:"",estimated_cost:0,resource_required:"",status:"Not Started",actual_completion_date:"",effectiveness_review_date:"",review_notes:""})},fe=d=>({Planning:"secondary","In Progress":"warning",Review:"info",Finalized:"success",Approved:"success"})[d]||"secondary",J=d=>d>=20?"destructive":d>=15?"warning":d>=10?"secondary":"success",ke=d=>d>=20?"Critical":d>=15?"High":d>=10?"Medium":"Low";Me(()=>{var d;return(d=l.value)==null?void 0:d.risk_register},d=>{d&&xe()},{deep:!0});const xe=()=>{if(!l.value)return;const d={};l.value.risk_register.forEach(e=>{const L=`${e.likelihood_score}-${e.impact_score}`;d[L]=(d[L]||0)+1}),l.value.risk_heat_map_data=d,l.value.top_risks=[...l.value.risk_register].sort((e,L)=>L.inherent_risk_score-e.inherent_risk_score).slice(0,5)};return Ie(()=>{z()}),(d,e)=>{var L,K,W;return u(),c("div",pt,[o("div",ct,[o("div",_t,[a(s($),{variant:"ghost",size:"sm",onClick:e[0]||(e[0]=t=>d.$router.go(-1)),class:"flex items-center space-x-2"},{default:i(()=>[a(s(De),{class:"h-4 w-4"}),e[30]||(e[30]=o("span",null,"Back",-1))]),_:1}),o("div",null,[e[31]||(e[31]=o("h1",{class:"text-2xl font-bold text-gray-900"}," Risk Assessment Details ",-1)),o("p",yt,p(((L=l.value)==null?void 0:L.assessment_id)||"Loading..."),1)])]),o("div",gt,[a(s(j),{variant:fe((K=l.value)==null?void 0:K.status),class:"capitalize"},{default:i(()=>{var t;return[_(p(((t=l.value)==null?void 0:t.status)||"Draft"),1)]}),_:1},8,["variant"]),re.value?(u(),C(s($),{key:0,variant:"outline",size:"sm",onClick:ne},{default:i(()=>[a(s(te),{class:"h-4 w-4 mr-2"}),_(" "+p(n.value?"Cancel":"Edit"),1)]),_:1})):w("",!0),ie.value&&((W=l.value)==null?void 0:W.status)==="Review"?(u(),C(s($),{key:1,variant:"default",size:"sm",onClick:ue},{default:i(()=>[a(s(Ee),{class:"h-4 w-4 mr-2"}),e[32]||(e[32]=_(" Approve ",-1))]),_:1})):w("",!0)])]),A.value?(u(),c("div",ft,[...e[33]||(e[33]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):l.value?(u(),c("div",kt,[a(s(R),null,{title:i(()=>[...e[34]||(e[34]=[_("Assessment Information",-1)])]),default:i(()=>[o("div",xt,[a(s(m),{label:"Assessment ID",value:l.value.assessment_id,readonly:""},null,8,["value"]),a(s(m),{label:"Assessment Name",modelValue:l.value.assessment_name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.assessment_name=t),readonly:!n.value,required:""},null,8,["modelValue","readonly"]),a(s(m),{label:"Fiscal Year",modelValue:l.value.fiscal_year,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.fiscal_year=t),readonly:!n.value,required:""},null,8,["modelValue","readonly"]),a(s(m),{label:"Assessment Date",modelValue:l.value.assessment_date,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.assessment_date=t),type:"date",readonly:!n.value,required:""},null,8,["modelValue","readonly"]),a(s(m),{label:"Assessment Period",modelValue:l.value.assessment_period,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.assessment_period=t),readonly:!n.value,required:""},{input:i(()=>[a(s(q),{modelValue:l.value.assessment_period,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.assessment_period=t),disabled:!n.value,options:g},null,8,["modelValue","disabled"])]),_:1},8,["modelValue","readonly"]),a(s(m),{label:"Status",modelValue:l.value.status,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.status=t),readonly:!n.value,required:""},{input:i(()=>[a(s(q),{modelValue:l.value.status,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.status=t),disabled:!n.value,options:E},null,8,["modelValue","disabled"])]),_:1},8,["modelValue","readonly"])])]),_:1}),a(s(R),null,{title:i(()=>[...e[35]||(e[35]=[_("Assessment Team",-1)])]),default:i(()=>[o("div",bt,[(u(!0),c(I,null,D(l.value.assessment_team,(t,U)=>(u(),c("div",{key:U,class:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-lg"},[a(s(m),{label:"Team Member",modelValue:t.team_member,"onUpdate:modelValue":x=>t.team_member=x,readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Role",modelValue:t.role,"onUpdate:modelValue":x=>t.role=x,readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),o("div",Vt,[n.value?(u(),C(s($),{key:0,variant:"outline",size:"sm",onClick:x=>ve(U),class:"text-red-600 hover:text-red-700"},{default:i(()=>[a(s(se),{class:"h-4 w-4"})]),_:1},8,["onClick"])):w("",!0)])]))),128)),n.value?(u(),C(s($),{key:0,variant:"outline",size:"sm",onClick:me,class:"w-full"},{default:i(()=>[a(s(B),{class:"h-4 w-4 mr-2"}),e[36]||(e[36]=_(" Add Team Member ",-1))]),_:1})):w("",!0)])]),_:1}),o("div",wt,[a(s(R),null,{title:i(()=>[...e[37]||(e[37]=[_("Assessment Scope",-1)])]),default:i(()=>[a(s(m),{modelValue:l.value.assessment_scope,"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.assessment_scope=t),readonly:!n.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1}),a(s(R),null,{title:i(()=>[...e[38]||(e[38]=[_("Methodology",-1)])]),default:i(()=>[o("div",ht,[(u(),c(I,null,D(S,t=>o("div",{key:t.value,class:"flex items-center space-x-2"},[Le(o("input",{id:`method-${t.value}`,"onUpdate:modelValue":e[9]||(e[9]=U=>l.value.methodology=U),value:t.value,type:"checkbox",disabled:!n.value,class:"rounded border-gray-300"},null,8,$t),[[Pe,l.value.methodology]]),o("label",{for:`method-${t.value}`,class:"text-sm"},p(t.label),9,Ct)])),64))])]),_:1})]),a(s(R),null,{title:i(()=>[...e[39]||(e[39]=[_("Risk Register",-1)])]),default:i(()=>[o("div",Rt,[o("div",Ut,[e[41]||(e[41]=o("h3",{class:"text-lg font-semibold"},"Identified Risks",-1)),n.value?(u(),C(s($),{key:0,variant:"outline",size:"sm",onClick:pe},{default:i(()=>[a(s(B),{class:"h-4 w-4 mr-2"}),e[40]||(e[40]=_(" Add Risk ",-1))]),_:1})):w("",!0)]),o("div",At,[o("table",St,[e[42]||(e[42]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Risk ID "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Description "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Category "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Likelihood "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Impact "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Inherent Risk "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),o("tbody",Mt,[(u(!0),c(I,null,D(l.value.risk_register,(t,U)=>(u(),c("tr",{key:U},[o("td",It,p(t.risk_id),1),o("td",Dt,p(t.risk_title),1),o("td",Et,p(t.risk_category),1),o("td",Lt,p(t.likelihood_score)+"/5 ",1),o("td",Pt,p(t.impact_score)+"/5 ",1),o("td",Tt,[a(s(j),{variant:J(t.inherent_risk_score)},{default:i(()=>[_(p(t.inherent_risk_score)+"/25 ",1)]),_:2},1032,["variant"])]),o("td",qt,[n.value?(u(),C(s($),{key:0,variant:"ghost",size:"sm",onClick:x=>ce(U)},{default:i(()=>[a(s(te),{class:"h-4 w-4"})]),_:1},8,["onClick"])):w("",!0),n.value?(u(),C(s($),{key:1,variant:"ghost",size:"sm",onClick:x=>_e(U),class:"text-red-600 hover:text-red-700"},{default:i(()=>[a(s(se),{class:"h-4 w-4"})]),_:1},8,["onClick"])):w("",!0)])]))),128))])])])])]),_:1}),a(s(R),null,{title:i(()=>[...e[43]||(e[43]=[_("Risk Heat Map",-1)])]),default:i(()=>[o("div",jt,[a(vt,{risks:l.value.risk_register,heatMapData:l.value.risk_heat_map_data},null,8,["risks","heatMapData"])])]),_:1}),a(s(R),null,{title:i(()=>[...e[44]||(e[44]=[_("Action Plan",-1)])]),default:i(()=>[o("div",zt,[o("div",Ot,[e[46]||(e[46]=o("h3",{class:"text-lg font-semibold"},"Mitigation Actions",-1)),n.value?(u(),C(s($),{key:0,variant:"outline",size:"sm",onClick:ge},{default:i(()=>[a(s(B),{class:"h-4 w-4 mr-2"}),e[45]||(e[45]=_(" Add Action ",-1))]),_:1})):w("",!0)]),o("div",Bt,[(u(!0),c(I,null,D(l.value.action_plan,(t,U)=>(u(),c("div",{key:U,class:"p-4 border rounded-lg"},[o("div",Nt,[a(s(m),{label:"Action ID",value:t.action_id,readonly:""},null,8,["value"]),a(s(m),{label:"Action Description",modelValue:t.action_description,"onUpdate:modelValue":x=>t.action_description=x,readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Responsible Party",modelValue:t.responsible_party,"onUpdate:modelValue":x=>t.responsible_party=x,readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Target Completion Date",modelValue:t.target_completion_date,"onUpdate:modelValue":x=>t.target_completion_date=x,type:"date",readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Status",modelValue:t.status,"onUpdate:modelValue":x=>t.status=x,readonly:!n.value},{input:i(()=>[a(s(q),{modelValue:t.status,"onUpdate:modelValue":x=>t.status=x,disabled:!n.value,options:oe},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Priority",modelValue:t.priority,"onUpdate:modelValue":x=>t.priority=x,readonly:!n.value},{input:i(()=>[a(s(q),{modelValue:t.priority,"onUpdate:modelValue":x=>t.priority=x,disabled:!n.value,options:de},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Estimated Cost",modelValue:t.estimated_cost,"onUpdate:modelValue":x=>t.estimated_cost=x,type:"number",readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),a(s(m),{label:"Actual Completion Date",modelValue:t.actual_completion_date,"onUpdate:modelValue":x=>t.actual_completion_date=x,type:"date",readonly:!n.value},null,8,["modelValue","onUpdate:modelValue","readonly"])])]))),128))])])]),_:1}),a(s(R),null,{title:i(()=>[...e[47]||(e[47]=[_("Top Risks Summary",-1)])]),default:i(()=>[o("div",Ft,[(u(!0),c(I,null,D(l.value.top_risks,t=>(u(),c("div",{key:t.risk_id,class:"p-4 border rounded-lg"},[o("div",Ht,[o("div",null,[o("h4",Yt,p(t.risk_description),1),o("p",Qt,"Risk Score: "+p(t.inherent_risk_score)+"/25",1)]),a(s(j),{variant:J(t.inherent_risk_score)},{default:i(()=>[_(p(ke(t.inherent_risk_score)),1)]),_:2},1032,["variant"])])]))),128))])]),_:1}),o("div",Gt,[a(s(R),null,{title:i(()=>[...e[48]||(e[48]=[_("Assessment Summary",-1)])]),default:i(()=>[a(s(m),{modelValue:l.value.assessment_summary,"onUpdate:modelValue":e[10]||(e[10]=t=>l.value.assessment_summary=t),readonly:!n.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1}),a(s(R),null,{title:i(()=>[...e[49]||(e[49]=[_("Recommendations",-1)])]),default:i(()=>[a(s(m),{modelValue:l.value.recommendations,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.recommendations=t),readonly:!n.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1})]),a(s(R),null,{title:i(()=>[...e[50]||(e[50]=[_("Approval Information",-1)])]),default:i(()=>[o("div",Jt,[a(s(m),{label:"Prepared By",value:l.value.prepared_by,readonly:""},null,8,["value"]),a(s(m),{label:"Reviewed By",modelValue:l.value.reviewed_by,"onUpdate:modelValue":e[12]||(e[12]=t=>l.value.reviewed_by=t),readonly:!n.value},null,8,["modelValue","readonly"]),a(s(m),{label:"Approved By",modelValue:l.value.approved_by,"onUpdate:modelValue":e[13]||(e[13]=t=>l.value.approved_by=t),readonly:!n.value},null,8,["modelValue","readonly"]),a(s(m),{label:"Approval Date",value:l.value.approval_date,readonly:""},null,8,["value"])])]),_:1}),o("div",Kt,[n.value?(u(),C(s($),{key:0,variant:"outline",onClick:Q},{default:i(()=>[...e[51]||(e[51]=[_(" Cancel ",-1)])]),_:1})):w("",!0),n.value?(u(),C(s($),{key:1,variant:"default",onClick:Y,disabled:h.value},{default:i(()=>[h.value?(u(),c("div",Wt)):(u(),C(s(Te),{key:0,class:"h-4 w-4 mr-2"})),_(" "+p(h.value?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"])):w("",!0)])])):w("",!0),a(s(ae),{modelValue:V.value,"onUpdate:modelValue":e[29]||(e[29]=t=>V.value=t)},{title:i(()=>[_(p(y.value!==null?"Edit Risk Entry":"Add Risk Entry"),1)]),actions:i(()=>[a(s($),{variant:"outline",onClick:G},{default:i(()=>[...e[52]||(e[52]=[_(" Cancel ",-1)])]),_:1}),a(s($),{onClick:ye},{default:i(()=>[_(p(y.value!==null?"Update":"Add")+" Risk ",1)]),_:1})]),default:i(()=>[o("div",Xt,[a(s(m),{label:"Risk ID",modelValue:r.value.risk_id,"onUpdate:modelValue":e[14]||(e[14]=t=>r.value.risk_id=t),required:""},null,8,["modelValue"]),a(s(m),{label:"Risk Title",modelValue:r.value.risk_title,"onUpdate:modelValue":e[15]||(e[15]=t=>r.value.risk_title=t),required:""},null,8,["modelValue"]),a(s(m),{label:"Risk Description",modelValue:r.value.risk_description,"onUpdate:modelValue":e[16]||(e[16]=t=>r.value.risk_description=t),type:"textarea",required:""},null,8,["modelValue"]),a(s(m),{label:"Risk Category",modelValue:r.value.risk_category,"onUpdate:modelValue":e[17]||(e[17]=t=>r.value.risk_category=t),required:""},null,8,["modelValue"]),a(s(m),{label:"Risk Subcategory",modelValue:r.value.risk_subcategory,"onUpdate:modelValue":e[18]||(e[18]=t=>r.value.risk_subcategory=t)},null,8,["modelValue"]),a(s(m),{label:"Auditable Entity",modelValue:r.value.auditable_entity,"onUpdate:modelValue":e[19]||(e[19]=t=>r.value.auditable_entity=t)},null,8,["modelValue"]),a(s(m),{label:"Threat Source",modelValue:r.value.threat_source,"onUpdate:modelValue":e[20]||(e[20]=t=>r.value.threat_source=t)},null,8,["modelValue"]),a(s(m),{label:"Vulnerability",modelValue:r.value.vulnerability,"onUpdate:modelValue":e[21]||(e[21]=t=>r.value.vulnerability=t)},null,8,["modelValue"]),o("div",Zt,[a(s(m),{label:"Likelihood Score (1-5)",modelValue:r.value.likelihood_score,"onUpdate:modelValue":e[22]||(e[22]=t=>r.value.likelihood_score=t),modelModifiers:{number:!0},type:"number",min:"1",max:"5",required:""},null,8,["modelValue"]),a(s(m),{label:"Impact Score (1-5)",modelValue:r.value.impact_score,"onUpdate:modelValue":e[23]||(e[23]=t=>r.value.impact_score=t),modelModifiers:{number:!0},type:"number",min:"1",max:"5",required:""},null,8,["modelValue"])]),a(s(m),{label:"Control Effectiveness",modelValue:r.value.control_effectiveness,"onUpdate:modelValue":e[24]||(e[24]=t=>r.value.control_effectiveness=t)},null,8,["modelValue"]),a(s(m),{label:"Existing Controls",modelValue:r.value.existing_controls,"onUpdate:modelValue":e[25]||(e[25]=t=>r.value.existing_controls=t),type:"textarea"},null,8,["modelValue"]),a(s(m),{label:"Risk Owner",modelValue:r.value.risk_owner,"onUpdate:modelValue":e[26]||(e[26]=t=>r.value.risk_owner=t)},null,8,["modelValue"]),a(s(m),{label:"Risk Response",modelValue:r.value.risk_response,"onUpdate:modelValue":e[27]||(e[27]=t=>r.value.risk_response=t)},null,8,["modelValue"]),a(s(m),{label:"Target Risk Score",modelValue:r.value.target_risk_score,"onUpdate:modelValue":e[28]||(e[28]=t=>r.value.target_risk_score=t),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}};export{ss as default};
//# sourceMappingURL=RiskAssessmentDetail-C6VS-lRf.js.map
