var ge=Object.defineProperty,ke=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var K=(x,f,g)=>f in x?ge(x,f,{enumerable:!0,configurable:!0,writable:!0,value:g}):x[f]=g,F=(x,f)=>{for(var g in f||(f={}))be.call(f,g)&&K(x,g,f[g]);if(G)for(var g of G(f))xe.call(f,g)&&K(x,g,f[g]);return x},W=(x,f)=>ke(x,fe(f));var T=(x,f,g)=>new Promise((_,t)=>{var P=V=>{try{d(g.next(V))}catch(v){t(v)}},R=V=>{try{d(g.throw(V))}catch(v){t(v)}},d=V=>V.done?_(V.value):Promise.resolve(V.value).then(P,R);d((g=g.apply(x,f)).next())});import{x as Ve,r as M,c as L,b,d as m,e as o,y as we,g as l,F as I,q as D,t as y,p as he,h as i,j as a,k as j,i as c,D as ee,a as Ce,u as Ae,w as Re,o as Ue,f as h,A as Se,_ as w,l as C,S as X,z as $e,B as u,m as q,T as Z,P as O,G as Me,J as Ie,K as De}from"./index-DzpD5d1M.js";import{C as A}from"./Card-DR4eQ-uz.js";const Ee={class:"risk-heat-map"},Pe={class:"grid grid-cols-6 gap-1 max-w-md mx-auto"},Te={class:"text-center text-sm font-medium text-gray-700 p-2 flex items-center justify-center"},qe=["onClick"],je={class:"space-y-4 max-h-96 overflow-y-auto"},ze={key:0,class:"text-center text-gray-500 py-8"},Fe={key:1,class:"space-y-3"},Oe={class:"flex items-start justify-between"},Le={class:"flex-1"},Be={class:"font-medium text-sm"},He={class:"text-sm text-gray-600 mt-1"},Ne={class:"text-xs text-gray-500 mt-1"},Je={__name:"RiskHeatMap",props:{risks:{type:Array,default:()=>[]},heatMapData:{type:Object,default:()=>({})}},setup(x){const f=x,g=M(!1),_=M({likelihood:0,impact:0}),t=L(()=>!_.value.likelihood||!_.value.impact?[]:f.risks.filter(v=>v.likelihood_score===_.value.likelihood&&v.impact_score===_.value.impact)),P=(v,r)=>{const p=v*r,E=R(v,r);let S="border-gray-200";return p>=19?S="bg-red-100 border-red-300 text-red-800":p>=13?S="bg-orange-100 border-orange-300 text-orange-800":p>=7?S="bg-yellow-100 border-yellow-300 text-yellow-800":S="bg-green-100 border-green-300 text-green-800",E>0&&(S+=" font-bold"),S},R=(v,r)=>{const p=`${v}-${r}`;return f.heatMapData[p]||0},d=(v,r)=>{_.value={likelihood:v,impact:r},g.value=!0},V=v=>v>=20?"destructive":v>=15?"warning":v>=10?"secondary":"success";return(v,r)=>(m(),b("div",Ee,[o("div",Pe,[r[1]||(r[1]=o("div",{class:"col-span-1"},null,-1)),(m(),b(I,null,D(5,p=>o("div",{key:`impact-${p}`,class:"text-center text-sm font-medium text-gray-700 p-2"},y(p),1)),64)),(m(),b(I,null,D(5,p=>o("div",{key:`likelihood-${p}`,class:"contents"},[o("div",Te,y(p),1),(m(),b(I,null,D(5,E=>o("div",{key:`cell-${p}-${E}`,class:he([P(p,E),"aspect-square rounded border cursor-pointer transition-all duration-200 hover:scale-105 flex items-center justify-center text-xs font-medium"]),onClick:S=>d(p,E)},y(R(p,E)),11,qe)),64))])),64))]),r[2]||(r[2]=we('<div class="flex justify-center mt-6 space-x-4" data-v-d855dd81><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-green-100 border border-green-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>Low (1-6)</span></div><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-yellow-100 border border-yellow-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>Medium (7-12)</span></div><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-orange-100 border border-orange-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>High (13-18)</span></div><div class="flex items-center space-x-2" data-v-d855dd81><div class="w-4 h-4 bg-red-100 border border-red-300 rounded" data-v-d855dd81></div><span class="text-sm text-gray-600" data-v-d855dd81>Critical (19-25)</span></div></div><div class="text-center mt-4" data-v-d855dd81><div class="grid grid-cols-2 gap-8 max-w-md mx-auto" data-v-d855dd81><div class="text-sm text-gray-600" data-v-d855dd81><div class="font-medium" data-v-d855dd81>Likelihood</div><div class="text-xs" data-v-d855dd81>1 = Rare, 5 = Almost Certain</div></div><div class="text-sm text-gray-600" data-v-d855dd81><div class="font-medium" data-v-d855dd81>Impact</div><div class="text-xs" data-v-d855dd81>1 = Minor, 5 = Catastrophic</div></div></div></div>',2)),l(a(ee),{modelValue:g.value,"onUpdate:modelValue":r[0]||(r[0]=p=>g.value=p)},{title:i(()=>[c("Risks in "+y(_.value.likelihood)+"x"+y(_.value.impact)+" Cell",1)]),default:i(()=>[o("div",je,[t.value.length===0?(m(),b("div",ze," No risks in this cell ")):(m(),b("div",Fe,[(m(!0),b(I,null,D(t.value,p=>(m(),b("div",{key:p.risk_id,class:"p-3 border rounded-lg"},[o("div",Oe,[o("div",Le,[o("div",Be,y(p.risk_id),1),o("div",He,y(p.risk_description),1),o("div",Ne," Category: "+y(p.risk_category),1)]),l(a(j),{variant:V(p.inherent_risk_score),class:"ml-2"},{default:i(()=>[c(y(p.inherent_risk_score)+"/25 ",1)]),_:2},1032,["variant"])])]))),128))]))])]),_:1},8,["modelValue"])]))}},Ye=Ve(Je,[["__scopeId","data-v-d855dd81"]]),Qe={class:"space-y-6"},Ge={class:"flex items-center justify-between"},Ke={class:"flex items-center space-x-4"},We={class:"text-sm text-gray-600"},Xe={class:"flex items-center space-x-2"},Ze={key:0,class:"flex justify-center items-center py-12"},es={key:1,class:"space-y-6"},ss={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},as={class:"space-y-4"},ts={class:"flex items-end space-x-2"},ls={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},os={class:"space-y-4"},rs=["id","value","disabled"],is=["for"],ns={class:"space-y-4"},ds={class:"flex justify-between items-center"},us={class:"overflow-x-auto"},ms={class:"min-w-full divide-y divide-gray-200"},vs={class:"bg-white divide-y divide-gray-200"},ps={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},cs={class:"px-6 py-4 text-sm text-gray-900"},_s={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ys={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},gs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ks={class:"px-6 py-4 whitespace-nowrap"},fs={class:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},bs={class:"flex justify-center"},xs={class:"space-y-4"},Vs={class:"flex justify-between items-center"},ws={class:"space-y-4"},hs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Cs={class:"space-y-4"},As={class:"flex items-center justify-between"},Rs={class:"font-semibold"},Us={class:"text-sm text-gray-600"},Ss={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},$s={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ms={class:"flex justify-end space-x-4"},Is={key:1,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ds={class:"space-y-4"},Es={class:"grid grid-cols-2 gap-4"},js={__name:"RiskAssessmentDetail",props:{assessmentId:{type:String,default:null},mode:{type:String,default:"view"}},setup(x){const f=Ce(),g=Ae(),_=x,t=M(null),P=M(!0),R=M(!1),d=M(_.mode==="edit"||_.mode==="new"),V=M(!1),v=M(null),r=M({risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""}),p=[{label:"Annual",value:"Annual"},{label:"Mid-Year",value:"Mid-Year"},{label:"Quarterly",value:"Quarterly"},{label:"Ad-hoc",value:"Ad-hoc"}],E=[{label:"Planning",value:"Planning"},{label:"In Progress",value:"In Progress"},{label:"Review",value:"Review"},{label:"Finalized",value:"Finalized"},{label:"Approved",value:"Approved"}],S=[{label:"Interview",value:"interview"},{label:"Workshop",value:"workshop"},{label:"Survey",value:"survey"},{label:"Document Review",value:"document_review"},{label:"Data Analysis",value:"data_analysis"}],se=[{label:"Planned",value:"Planned"},{label:"In Progress",value:"In Progress"},{label:"Completed",value:"Completed"},{label:"Overdue",value:"Overdue"}],ae=[{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],te=L(()=>{var n;return((n=t.value)==null?void 0:n.status)!=="Approved"}),le=L(()=>!0),z=()=>T(this,null,function*(){try{if(P.value=!0,_.mode==="new")t.value={assessment_id:"",assessment_name:"",assessment_date:new Date().toISOString().split("T")[0],fiscal_year:new Date().getFullYear().toString(),assessment_period:"Annual",assessment_team:[],assessment_scope:"",methodology:[],status:"Planning",risk_register:[],action_plan:[],risk_heat_map_data:{},top_risks:[],assessment_summary:"",recommendations:"",prepared_by:"",reviewed_by:"",approved_by:"",approval_date:""};else{const n=_.assessmentId||f.params.id;if(!n)throw new Error("Assessment ID is required");const e=yield fetch(`/api/resource/Risk Assessment/${n}`);if(e.ok)t.value=yield e.json();else throw new Error("Failed to load assessment")}}catch(n){if(console.error("Error loading assessment:",n),_.mode!=="new"){const e=_.assessmentId||f.params.id;t.value={name:e,assessment_id:`RA-2024-${String(e).padStart(4,"0")}`,assessment_name:"Annual Risk Assessment 2024",assessment_date:"2024-01-15",fiscal_year:"2024",assessment_period:"Annual",assessment_team:[{team_member:"John Doe",role:"Lead"},{team_member:"Jane Smith",role:"Member"}],assessment_scope:"Comprehensive risk assessment covering all business units and processes.",methodology:["interview","workshop","document_review"],status:"In Progress",risk_register:[{risk_id:"R001",risk_title:"Financial reporting errors",risk_description:"Financial reporting errors due to manual processes",risk_category:"Operational",risk_subcategory:"Financial Reporting",auditable_entity:"Finance Department",threat_source:"Human error",vulnerability:"Manual data entry",likelihood_score:4,impact_score:5,inherent_risk_score:20,control_effectiveness:"Adequate",existing_controls:"Basic review process",risk_owner:"Finance Manager",risk_response:"Mitigate",target_risk_score:10,likelihood_rationale:"High volume of manual entries",impact_rationale:"Material impact on financial statements"}],action_plan:[{action_id:"A001",action_description:"Implement automated financial reporting system",action_type:"System Enhancement",priority:"High",responsible_party:"IT Department",target_completion_date:"2024-06-30",estimated_cost:5e4,resource_required:"IT team and software licenses",status:"In Progress",actual_completion_date:"",effectiveness_review_date:"",review_notes:""}],risk_heat_map_data:{},top_risks:[],assessment_summary:"The assessment identified several key risks...",recommendations:"Implement automated systems and enhance training...",prepared_by:"John Doe",reviewed_by:"",approved_by:"",approval_date:""}}}finally{P.value=!1}}),oe=()=>{_.mode==="view"?g.push(`/audit-planning/risk-assessment/${_.assessmentId||f.params.id}/edit`):H()},B=()=>T(this,null,function*(){try{if(R.value=!0,t.value.risk_register.forEach(e=>{e.inherent_risk_score=e.likelihood_score*e.impact_score}),_.mode==="new"&&!t.value.assessment_id){const e=t.value.fiscal_year.slice(-2),$=Math.floor(Math.random()*1e3)+1;t.value.assessment_id=`RA-${t.value.fiscal_year}-${String($).padStart(4,"0")}`}let n;if(_.mode==="new")n=yield fetch("/api/resource/Risk Assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.value)});else{const e=_.assessmentId||f.params.id;n=yield fetch(`/api/resource/Risk Assessment/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.value)})}if(n.ok){const e=yield n.json();_.mode==="new"?g.push(`/audit-planning/risk-assessment/${e.name}`):(d.value=!1,yield z())}else throw new Error("Failed to save changes")}catch(n){console.error("Error saving changes:",n)}finally{R.value=!1}}),H=()=>{_.mode==="new"?g.push("/audit-planning/risk-assessment"):_.mode==="edit"?g.push(`/audit-planning/risk-assessment/${_.assessmentId||f.params.id}`):(d.value=!1,z())},re=()=>T(this,null,function*(){try{t.value.status="Approved",t.value.approved_by="Current User",t.value.approval_date=new Date().toISOString().split("T")[0],yield B()}catch(n){console.error("Error approving assessment:",n)}}),ie=()=>{t.value.assessment_team.push({team_member:"",role:""})},ne=n=>{t.value.assessment_team.splice(n,1)},de=()=>{v.value=null,r.value={risk_id:`R${String(t.value.risk_register.length+1).padStart(3,"0")}`,risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""},V.value=!0},ue=n=>{v.value=n,r.value=F({},t.value.risk_register[n]),V.value=!0},me=n=>{t.value.risk_register.splice(n,1)},ve=()=>{const n=W(F({},r.value),{inherent_risk_score:r.value.likelihood_score*r.value.impact_score});v.value!==null?t.value.risk_register[v.value]=n:t.value.risk_register.push(n),N()},N=()=>{V.value=!1,v.value=null,r.value={risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:1,impact_score:1,control_effectiveness:"",existing_controls:"",risk_owner:"",risk_response:"",target_risk_score:0,likelihood_rationale:"",impact_rationale:""}},pe=()=>{t.value.action_plan.push({action_id:`A${String(t.value.action_plan.length+1).padStart(3,"0")}`,action_description:"",action_type:"",priority:"Medium",responsible_party:"",target_completion_date:"",estimated_cost:0,resource_required:"",status:"Not Started",actual_completion_date:"",effectiveness_review_date:"",review_notes:""})},ce=n=>({Planning:"secondary","In Progress":"warning",Review:"info",Finalized:"success",Approved:"success"})[n]||"secondary",J=n=>n>=20?"destructive":n>=15?"warning":n>=10?"secondary":"success",_e=n=>n>=20?"Critical":n>=15?"High":n>=10?"Medium":"Low";Re(()=>{var n;return(n=t.value)==null?void 0:n.risk_register},n=>{n&&ye()},{deep:!0});const ye=()=>{if(!t.value)return;const n={};t.value.risk_register.forEach(e=>{const $=`${e.likelihood_score}-${e.impact_score}`;n[$]=(n[$]||0)+1}),t.value.risk_heat_map_data=n,t.value.top_risks=[...t.value.risk_register].sort((e,$)=>$.inherent_risk_score-e.inherent_risk_score).slice(0,5)};return Ue(()=>{z()}),(n,e)=>{var $,Y,Q;return m(),b("div",Qe,[o("div",Ge,[o("div",Ke,[l(a(w),{variant:"ghost",size:"sm",onClick:e[0]||(e[0]=s=>n.$router.go(-1)),class:"flex items-center space-x-2"},{default:i(()=>[l(a(Se),{class:"h-4 w-4"}),e[30]||(e[30]=o("span",null,"Back",-1))]),_:1}),o("div",null,[e[31]||(e[31]=o("h1",{class:"text-2xl font-bold text-gray-900"}," Risk Assessment Details ",-1)),o("p",We,y((($=t.value)==null?void 0:$.assessment_id)||"Loading..."),1)])]),o("div",Xe,[l(a(j),{variant:ce((Y=t.value)==null?void 0:Y.status),class:"capitalize"},{default:i(()=>{var s;return[c(y(((s=t.value)==null?void 0:s.status)||"Draft"),1)]}),_:1},8,["variant"]),te.value?(m(),C(a(w),{key:0,variant:"outline",size:"sm",onClick:oe},{default:i(()=>[l(a(X),{class:"h-4 w-4 mr-2"}),c(" "+y(d.value?"Cancel":"Edit"),1)]),_:1})):h("",!0),le.value&&((Q=t.value)==null?void 0:Q.status)==="Review"?(m(),C(a(w),{key:1,variant:"default",size:"sm",onClick:re},{default:i(()=>[l(a($e),{class:"h-4 w-4 mr-2"}),e[32]||(e[32]=c(" Approve ",-1))]),_:1})):h("",!0)])]),P.value?(m(),b("div",Ze,[...e[33]||(e[33]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):t.value?(m(),b("div",es,[l(a(A),null,{title:i(()=>[...e[34]||(e[34]=[c("Assessment Information",-1)])]),default:i(()=>[o("div",ss,[l(a(u),{label:"Assessment ID",value:t.value.assessment_id,readonly:""},null,8,["value"]),l(a(u),{label:"Assessment Name",modelValue:t.value.assessment_name,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.assessment_name=s),readonly:!d.value,required:""},null,8,["modelValue","readonly"]),l(a(u),{label:"Fiscal Year",modelValue:t.value.fiscal_year,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.fiscal_year=s),readonly:!d.value,required:""},null,8,["modelValue","readonly"]),l(a(u),{label:"Assessment Date",modelValue:t.value.assessment_date,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.assessment_date=s),type:"date",readonly:!d.value,required:""},null,8,["modelValue","readonly"]),l(a(u),{label:"Assessment Period",modelValue:t.value.assessment_period,"onUpdate:modelValue":e[5]||(e[5]=s=>t.value.assessment_period=s),readonly:!d.value,required:""},{input:i(()=>[l(a(q),{modelValue:t.value.assessment_period,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.assessment_period=s),disabled:!d.value,options:p},null,8,["modelValue","disabled"])]),_:1},8,["modelValue","readonly"]),l(a(u),{label:"Status",modelValue:t.value.status,"onUpdate:modelValue":e[7]||(e[7]=s=>t.value.status=s),readonly:!d.value,required:""},{input:i(()=>[l(a(q),{modelValue:t.value.status,"onUpdate:modelValue":e[6]||(e[6]=s=>t.value.status=s),disabled:!d.value,options:E},null,8,["modelValue","disabled"])]),_:1},8,["modelValue","readonly"])])]),_:1}),l(a(A),null,{title:i(()=>[...e[35]||(e[35]=[c("Assessment Team",-1)])]),default:i(()=>[o("div",as,[(m(!0),b(I,null,D(t.value.assessment_team,(s,U)=>(m(),b("div",{key:U,class:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border rounded-lg"},[l(a(u),{label:"Team Member",modelValue:s.team_member,"onUpdate:modelValue":k=>s.team_member=k,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Role",modelValue:s.role,"onUpdate:modelValue":k=>s.role=k,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),o("div",ts,[d.value?(m(),C(a(w),{key:0,variant:"outline",size:"sm",onClick:k=>ne(U),class:"text-red-600 hover:text-red-700"},{default:i(()=>[l(a(Z),{class:"h-4 w-4"})]),_:1},8,["onClick"])):h("",!0)])]))),128)),d.value?(m(),C(a(w),{key:0,variant:"outline",size:"sm",onClick:ie,class:"w-full"},{default:i(()=>[l(a(O),{class:"h-4 w-4 mr-2"}),e[36]||(e[36]=c(" Add Team Member ",-1))]),_:1})):h("",!0)])]),_:1}),o("div",ls,[l(a(A),null,{title:i(()=>[...e[37]||(e[37]=[c("Assessment Scope",-1)])]),default:i(()=>[l(a(u),{modelValue:t.value.assessment_scope,"onUpdate:modelValue":e[8]||(e[8]=s=>t.value.assessment_scope=s),readonly:!d.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1}),l(a(A),null,{title:i(()=>[...e[38]||(e[38]=[c("Methodology",-1)])]),default:i(()=>[o("div",os,[(m(),b(I,null,D(S,s=>o("div",{key:s.value,class:"flex items-center space-x-2"},[Me(o("input",{id:`method-${s.value}`,"onUpdate:modelValue":e[9]||(e[9]=U=>t.value.methodology=U),value:s.value,type:"checkbox",disabled:!d.value,class:"rounded border-gray-300"},null,8,rs),[[Ie,t.value.methodology]]),o("label",{for:`method-${s.value}`,class:"text-sm"},y(s.label),9,is)])),64))])]),_:1})]),l(a(A),null,{title:i(()=>[...e[39]||(e[39]=[c("Risk Register",-1)])]),default:i(()=>[o("div",ns,[o("div",ds,[e[41]||(e[41]=o("h3",{class:"text-lg font-semibold"},"Identified Risks",-1)),d.value?(m(),C(a(w),{key:0,variant:"outline",size:"sm",onClick:de},{default:i(()=>[l(a(O),{class:"h-4 w-4 mr-2"}),e[40]||(e[40]=c(" Add Risk ",-1))]),_:1})):h("",!0)]),o("div",us,[o("table",ms,[e[42]||(e[42]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Risk ID "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Description "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Category "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Likelihood "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Impact "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Inherent Risk "),o("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),o("tbody",vs,[(m(!0),b(I,null,D(t.value.risk_register,(s,U)=>(m(),b("tr",{key:U},[o("td",ps,y(s.risk_id),1),o("td",cs,y(s.risk_title),1),o("td",_s,y(s.risk_category),1),o("td",ys,y(s.likelihood_score)+"/5 ",1),o("td",gs,y(s.impact_score)+"/5 ",1),o("td",ks,[l(a(j),{variant:J(s.inherent_risk_score)},{default:i(()=>[c(y(s.inherent_risk_score)+"/25 ",1)]),_:2},1032,["variant"])]),o("td",fs,[d.value?(m(),C(a(w),{key:0,variant:"ghost",size:"sm",onClick:k=>ue(U)},{default:i(()=>[l(a(X),{class:"h-4 w-4"})]),_:1},8,["onClick"])):h("",!0),d.value?(m(),C(a(w),{key:1,variant:"ghost",size:"sm",onClick:k=>me(U),class:"text-red-600 hover:text-red-700"},{default:i(()=>[l(a(Z),{class:"h-4 w-4"})]),_:1},8,["onClick"])):h("",!0)])]))),128))])])])])]),_:1}),l(a(A),null,{title:i(()=>[...e[43]||(e[43]=[c("Risk Heat Map",-1)])]),default:i(()=>[o("div",bs,[l(Ye,{risks:t.value.risk_register,heatMapData:t.value.risk_heat_map_data},null,8,["risks","heatMapData"])])]),_:1}),l(a(A),null,{title:i(()=>[...e[44]||(e[44]=[c("Action Plan",-1)])]),default:i(()=>[o("div",xs,[o("div",Vs,[e[46]||(e[46]=o("h3",{class:"text-lg font-semibold"},"Mitigation Actions",-1)),d.value?(m(),C(a(w),{key:0,variant:"outline",size:"sm",onClick:pe},{default:i(()=>[l(a(O),{class:"h-4 w-4 mr-2"}),e[45]||(e[45]=c(" Add Action ",-1))]),_:1})):h("",!0)]),o("div",ws,[(m(!0),b(I,null,D(t.value.action_plan,(s,U)=>(m(),b("div",{key:U,class:"p-4 border rounded-lg"},[o("div",hs,[l(a(u),{label:"Action ID",value:s.action_id,readonly:""},null,8,["value"]),l(a(u),{label:"Action Description",modelValue:s.action_description,"onUpdate:modelValue":k=>s.action_description=k,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Responsible Party",modelValue:s.responsible_party,"onUpdate:modelValue":k=>s.responsible_party=k,readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Target Completion Date",modelValue:s.target_completion_date,"onUpdate:modelValue":k=>s.target_completion_date=k,type:"date",readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Status",modelValue:s.status,"onUpdate:modelValue":k=>s.status=k,readonly:!d.value},{input:i(()=>[l(a(q),{modelValue:s.status,"onUpdate:modelValue":k=>s.status=k,disabled:!d.value,options:se},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Priority",modelValue:s.priority,"onUpdate:modelValue":k=>s.priority=k,readonly:!d.value},{input:i(()=>[l(a(q),{modelValue:s.priority,"onUpdate:modelValue":k=>s.priority=k,disabled:!d.value,options:ae},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Estimated Cost",modelValue:s.estimated_cost,"onUpdate:modelValue":k=>s.estimated_cost=k,type:"number",readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"]),l(a(u),{label:"Actual Completion Date",modelValue:s.actual_completion_date,"onUpdate:modelValue":k=>s.actual_completion_date=k,type:"date",readonly:!d.value},null,8,["modelValue","onUpdate:modelValue","readonly"])])]))),128))])])]),_:1}),l(a(A),null,{title:i(()=>[...e[47]||(e[47]=[c("Top Risks Summary",-1)])]),default:i(()=>[o("div",Cs,[(m(!0),b(I,null,D(t.value.top_risks,s=>(m(),b("div",{key:s.risk_id,class:"p-4 border rounded-lg"},[o("div",As,[o("div",null,[o("h4",Rs,y(s.risk_description),1),o("p",Us,"Risk Score: "+y(s.inherent_risk_score)+"/25",1)]),l(a(j),{variant:J(s.inherent_risk_score)},{default:i(()=>[c(y(_e(s.inherent_risk_score)),1)]),_:2},1032,["variant"])])]))),128))])]),_:1}),o("div",Ss,[l(a(A),null,{title:i(()=>[...e[48]||(e[48]=[c("Assessment Summary",-1)])]),default:i(()=>[l(a(u),{modelValue:t.value.assessment_summary,"onUpdate:modelValue":e[10]||(e[10]=s=>t.value.assessment_summary=s),readonly:!d.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1}),l(a(A),null,{title:i(()=>[...e[49]||(e[49]=[c("Recommendations",-1)])]),default:i(()=>[l(a(u),{modelValue:t.value.recommendations,"onUpdate:modelValue":e[11]||(e[11]=s=>t.value.recommendations=s),readonly:!d.value,type:"textarea",rows:"6"},null,8,["modelValue","readonly"])]),_:1})]),l(a(A),null,{title:i(()=>[...e[50]||(e[50]=[c("Approval Information",-1)])]),default:i(()=>[o("div",$s,[l(a(u),{label:"Prepared By",value:t.value.prepared_by,readonly:""},null,8,["value"]),l(a(u),{label:"Reviewed By",modelValue:t.value.reviewed_by,"onUpdate:modelValue":e[12]||(e[12]=s=>t.value.reviewed_by=s),readonly:!d.value},null,8,["modelValue","readonly"]),l(a(u),{label:"Approved By",modelValue:t.value.approved_by,"onUpdate:modelValue":e[13]||(e[13]=s=>t.value.approved_by=s),readonly:!d.value},null,8,["modelValue","readonly"]),l(a(u),{label:"Approval Date",value:t.value.approval_date,readonly:""},null,8,["value"])])]),_:1}),o("div",Ms,[d.value?(m(),C(a(w),{key:0,variant:"outline",onClick:H},{default:i(()=>[...e[51]||(e[51]=[c(" Cancel ",-1)])]),_:1})):h("",!0),d.value?(m(),C(a(w),{key:1,variant:"default",onClick:B,disabled:R.value},{default:i(()=>[R.value?(m(),b("div",Is)):(m(),C(a(De),{key:0,class:"h-4 w-4 mr-2"})),c(" "+y(R.value?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"])):h("",!0)])])):h("",!0),l(a(ee),{modelValue:V.value,"onUpdate:modelValue":e[29]||(e[29]=s=>V.value=s)},{title:i(()=>[c(y(v.value!==null?"Edit Risk Entry":"Add Risk Entry"),1)]),actions:i(()=>[l(a(w),{variant:"outline",onClick:N},{default:i(()=>[...e[52]||(e[52]=[c(" Cancel ",-1)])]),_:1}),l(a(w),{onClick:ve},{default:i(()=>[c(y(v.value!==null?"Update":"Add")+" Risk ",1)]),_:1})]),default:i(()=>[o("div",Ds,[l(a(u),{label:"Risk ID",modelValue:r.value.risk_id,"onUpdate:modelValue":e[14]||(e[14]=s=>r.value.risk_id=s),required:""},null,8,["modelValue"]),l(a(u),{label:"Risk Title",modelValue:r.value.risk_title,"onUpdate:modelValue":e[15]||(e[15]=s=>r.value.risk_title=s),required:""},null,8,["modelValue"]),l(a(u),{label:"Risk Description",modelValue:r.value.risk_description,"onUpdate:modelValue":e[16]||(e[16]=s=>r.value.risk_description=s),type:"textarea",required:""},null,8,["modelValue"]),l(a(u),{label:"Risk Category",modelValue:r.value.risk_category,"onUpdate:modelValue":e[17]||(e[17]=s=>r.value.risk_category=s),required:""},null,8,["modelValue"]),l(a(u),{label:"Risk Subcategory",modelValue:r.value.risk_subcategory,"onUpdate:modelValue":e[18]||(e[18]=s=>r.value.risk_subcategory=s)},null,8,["modelValue"]),l(a(u),{label:"Auditable Entity",modelValue:r.value.auditable_entity,"onUpdate:modelValue":e[19]||(e[19]=s=>r.value.auditable_entity=s)},null,8,["modelValue"]),l(a(u),{label:"Threat Source",modelValue:r.value.threat_source,"onUpdate:modelValue":e[20]||(e[20]=s=>r.value.threat_source=s)},null,8,["modelValue"]),l(a(u),{label:"Vulnerability",modelValue:r.value.vulnerability,"onUpdate:modelValue":e[21]||(e[21]=s=>r.value.vulnerability=s)},null,8,["modelValue"]),o("div",Es,[l(a(u),{label:"Likelihood Score (1-5)",modelValue:r.value.likelihood_score,"onUpdate:modelValue":e[22]||(e[22]=s=>r.value.likelihood_score=s),modelModifiers:{number:!0},type:"number",min:"1",max:"5",required:""},null,8,["modelValue"]),l(a(u),{label:"Impact Score (1-5)",modelValue:r.value.impact_score,"onUpdate:modelValue":e[23]||(e[23]=s=>r.value.impact_score=s),modelModifiers:{number:!0},type:"number",min:"1",max:"5",required:""},null,8,["modelValue"])]),l(a(u),{label:"Control Effectiveness",modelValue:r.value.control_effectiveness,"onUpdate:modelValue":e[24]||(e[24]=s=>r.value.control_effectiveness=s)},null,8,["modelValue"]),l(a(u),{label:"Existing Controls",modelValue:r.value.existing_controls,"onUpdate:modelValue":e[25]||(e[25]=s=>r.value.existing_controls=s),type:"textarea"},null,8,["modelValue"]),l(a(u),{label:"Risk Owner",modelValue:r.value.risk_owner,"onUpdate:modelValue":e[26]||(e[26]=s=>r.value.risk_owner=s)},null,8,["modelValue"]),l(a(u),{label:"Risk Response",modelValue:r.value.risk_response,"onUpdate:modelValue":e[27]||(e[27]=s=>r.value.risk_response=s)},null,8,["modelValue"]),l(a(u),{label:"Target Risk Score",modelValue:r.value.target_risk_score,"onUpdate:modelValue":e[28]||(e[28]=s=>r.value.target_risk_score=s),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}};export{js as default};
//# sourceMappingURL=RiskAssessmentDetail-C7ytOJPV.js.map
