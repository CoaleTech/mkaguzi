var _s=Object.defineProperty,hs=Object.defineProperties;var ks=Object.getOwnPropertyDescriptors;var os=Object.getOwnPropertySymbols;var ws=Object.prototype.hasOwnProperty,$s=Object.prototype.propertyIsEnumerable;var as=(b,g,m)=>g in b?_s(b,g,{enumerable:!0,configurable:!0,writable:!0,value:m}):b[g]=m,Ie=(b,g)=>{for(var m in g||(g={}))ws.call(g,m)&&as(b,m,g[m]);if(os)for(var m of os(g))$s.call(g,m)&&as(b,m,g[m]);return b},Ke=(b,g)=>hs(b,ks(g));var _e=(b,g,m)=>new Promise((L,j)=>{var D=U=>{try{V(m.next(U))}catch(E){j(E)}},n=U=>{try{V(m.throw(U))}catch(E){j(E)}},V=U=>U.done?L(U.value):Promise.resolve(U.value).then(D,n);V((m=m.apply(b,g)).next())});import{j as k,l as y,p as v,q as e,s as i,v as t,u as p,z as w,A as r,y as G,C as he,H as J,r as I,am as gs,F as Q,x as W,$ as ke,B as O,a6 as Ae,b as Le,w as oe,ac as ie,ad as ue,aq as Cs,ab as Rs}from"./vue-DciwFjI_.js";import{d as Ve,a as _,_ as fs,e as me,b as Se,L as Ue,I as Ss,C as rs,c as Be,D as Ee,f as As}from"./index-qIC3Tfxg.js";import{m as xs,a2 as Vs,_ as Ne,ah as js,aH as Ds,a4 as es,l as ss,N as Oe,bb as Ms,T as pe,a6 as Ts,a1 as Fs,b3 as Ps,a as Is,a7 as ze,C as Ze,ad as Us,b as ns,n as Ye,o as ds,F as qe,a0 as cs,$ as zs,a8 as us,a9 as ms,aa as ps,ak as vs,av as Ls,ab as Es}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const Os={class:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm"},qs={class:"flex flex-wrap items-center justify-between gap-4"},Bs={class:"flex flex-wrap items-center gap-4"},Ns={class:"flex items-center space-x-2"},Ys={class:"relative"},Hs=["value"],Qs={class:"flex items-center space-x-2"},Ws={class:"p-1"},Gs={class:"p-1"},Xs={class:"p-1"},Js={class:"flex items-center space-x-2 text-sm text-gray-600"},Ks={__name:"RiskAssessmentFilters",props:{searchQuery:{type:String,default:""},filterStatus:{type:String,default:""},filterPeriod:{type:String,default:""},filterYear:{type:String,default:""},viewMode:{type:String,default:"table"},selectedCount:{type:Number,default:0},filteredCount:{type:Number,default:0},totalCount:{type:Number,default:0}},emits:["update:searchQuery","update:filterStatus","update:filterPeriod","update:filterYear","bulk-action","show-analytics","toggle-view","clear-filters"],setup(b){const g=b,m=[{label:"Annual",value:"Annual"},{label:"Mid-Year",value:"Mid-Year"},{label:"Quarterly",value:"Quarterly"},{label:"Ad-hoc",value:"Ad-hoc"}],L=[{label:"Planning",value:"Planning"},{label:"In Progress",value:"In Progress"},{label:"Review",value:"Review"},{label:"Finalized",value:"Finalized"},{label:"Approved",value:"Approved"}],j=new Date().getFullYear(),D=[];for(let R=j-2;R<=j+2;R++)D.push({label:R.toString(),value:R.toString()});const n=k(()=>[{label:"All Statuses",value:""},...L]),V=k(()=>[{label:"All Periods",value:""},...m]),U=k(()=>[{label:"All Years",value:""},...D]),E=k(()=>g.searchQuery||g.filterStatus||g.filterPeriod||g.filterYear);return(R,f)=>(v(),y("div",Os,[e("div",qs,[e("div",Bs,[f[8]||(f[8]=e("h3",{class:"text-sm font-semibold text-gray-900"},"Quick Actions",-1)),e("div",Ns,[e("div",Ys,[i(t(xs),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e("input",{value:b.searchQuery,onInput:f[0]||(f[0]=M=>R.$emit("update:searchQuery",M.target.value)),type:"text",placeholder:"Search assessments...",class:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm w-48"},null,40,Hs)]),i(t(Ve),{modelValue:b.filterStatus,"onUpdate:modelValue":f[1]||(f[1]=M=>R.$emit("update:filterStatus",M)),options:n.value,class:"min-w-36"},null,8,["modelValue","options"]),i(t(Ve),{modelValue:b.filterPeriod,"onUpdate:modelValue":f[2]||(f[2]=M=>R.$emit("update:filterPeriod",M)),options:V.value,class:"min-w-36"},null,8,["modelValue","options"]),i(t(Ve),{modelValue:b.filterYear,"onUpdate:modelValue":f[3]||(f[3]=M=>R.$emit("update:filterYear",M)),options:U.value,class:"min-w-28"},null,8,["modelValue","options"])])]),e("div",Qs,[e("div",Ws,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:f[4]||(f[4]=M=>R.$emit("bulk-action")),disabled:b.selectedCount===0},{prefix:p(()=>[i(t(Vs),{class:"h-3.5 w-3.5"})]),default:p(()=>[w(" Bulk Actions ("+r(b.selectedCount)+") ",1)]),_:1},8,["disabled"])]),e("div",Gs,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:f[5]||(f[5]=M=>R.$emit("show-analytics"))},{prefix:p(()=>[i(t(Ne),{class:"h-3.5 w-3.5"})]),default:p(()=>[f[9]||(f[9]=w(" Risk Analytics ",-1))]),_:1})]),e("div",Xs,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:f[6]||(f[6]=M=>R.$emit("toggle-view"))},{prefix:p(()=>[(v(),G(he(b.viewMode==="table"?t(js):t(Ds)),{class:"h-3.5 w-3.5"}))]),default:p(()=>[w(" "+r(b.viewMode==="table"?"Card View":"Table View"),1)]),_:1})])]),e("div",Js,[e("span",null,"Showing "+r(b.filteredCount)+" of "+r(b.totalCount)+" assessments",1),E.value?(v(),G(t(_),{key:0,variant:"ghost",size:"sm",onClick:f[7]||(f[7]=M=>R.$emit("clear-filters"))},{default:p(()=>[i(t(es),{class:"h-3.5 w-3.5 mr-1"}),f[10]||(f[10]=w(" Clear ",-1))]),_:1})):J("",!0)])])]))}},Zs={class:"risk-heatmap"},et={class:"heatmap-container"},st={class:"impact-labels"},tt=["title"],lt={class:"label-text"},it={class:"label-number"},ot={class:"matrix-grid"},at=["onClick"],rt={class:"cell-content"},nt={class:"risk-count"},dt={key:0,class:"risk-indicators"},ct=["title","onClick"],ut=["title"],mt={class:"cell-tooltip"},pt={class:"tooltip-header"},vt={key:0,class:"tooltip-risks"},gt={class:"tooltip-risk-count"},ft={key:0},xt={key:1,class:"no-risks"},bt={class:"likelihood-labels"},yt=["title"],_t={class:"label-number"},ht={class:"label-text"},kt={key:0,class:"risk-detail-panel"},wt={class:"panel-header"},$t={class:"cell-coordinates"},Ct={class:"panel-content"},Rt={key:0,class:"risks-list"},St=["onClick"],At={class:"risk-info"},Vt={class:"risk-title"},jt={class:"risk-meta"},Dt={class:"category"},Mt={class:"owner"},Tt={class:"status"},Ft={class:"risk-actions"},Pt=["checked","onChange"],It={key:1,class:"no-risks-message"},Ut={__name:"RiskHeatMap",props:{matrixData:{type:Array,default:()=>[]},likelihoodLevels:{type:Array,default:()=>[]},impactLevels:{type:Array,default:()=>[]},selectedRisks:{type:Array,default:()=>[]}},emits:["cell-click","risk-click","risk-select","create-risk"],setup(b,{emit:g}){const m=b,L=g,j=I(null),D=k(()=>[...m.impactLevels].reverse()),n={operational:Is,financial:Ps,compliance:Fs,strategic:Ts,reputational:pe,technology:Ms},V=$=>n[$]||pe,U=$=>({operational:"Operational",financial:"Financial",compliance:"Compliance",strategic:"Strategic",reputational:"Reputational",technology:"Technology"})[$]||$,E=$=>$.some(C=>m.selectedRisks.includes(C.name)),R=$=>{j.value=$,L("cell-click",$)},f=$=>{L("risk-click",$)},M=$=>{L("risk-select",$)},q=$=>{L("create-risk",{likelihood:$.likelihood,impact:$.impact})};return($,C)=>(v(),y("div",Zs,[C[7]||(C[7]=gs('<div class="heatmap-legend" data-v-ac904a79><h4 data-v-ac904a79>Risk Level Legend</h4><div class="legend-items" data-v-ac904a79><div class="legend-item critical" data-v-ac904a79><div class="legend-color" data-v-ac904a79></div><span data-v-ac904a79>Critical (16-25)</span></div><div class="legend-item high" data-v-ac904a79><div class="legend-color" data-v-ac904a79></div><span data-v-ac904a79>High (13-20)</span></div><div class="legend-item medium" data-v-ac904a79><div class="legend-color" data-v-ac904a79></div><span data-v-ac904a79>Medium (6-12)</span></div><div class="legend-item low" data-v-ac904a79><div class="legend-color" data-v-ac904a79></div><span data-v-ac904a79>Low (1-5)</span></div></div></div>',1)),e("div",et,[C[2]||(C[2]=e("div",{class:"y-axis-label"},[e("span",null,"Impact")],-1)),e("div",st,[(v(!0),y(Q,null,W(D.value,h=>(v(),y("div",{key:h.id,class:"impact-label",title:h.description},[e("span",lt,r(h.label),1),e("span",it,r(h.id),1)],8,tt))),128))]),e("div",ot,[(v(!0),y(Q,null,W(b.matrixData,(h,S)=>(v(),y("div",{key:S,class:"matrix-row"},[(v(!0),y(Q,null,W(h,(A,X)=>(v(),y("div",{key:`${S}-${X}`,class:O(["matrix-cell",[`risk-${A.level.toLowerCase()}`,{"has-risks":A.count>0,selected:E(A.risks)}]]),style:ke({backgroundColor:A.color+"20",borderColor:A.color}),onClick:T=>R(A)},[e("div",rt,[e("div",nt,r(A.count),1),A.count>0?(v(),y("div",dt,[(v(!0),y(Q,null,W(A.risks.slice(0,3),T=>(v(),y("div",{key:T.name,class:O(["risk-indicator",{selected:b.selectedRisks.includes(T.name)}]),title:T.title,onClick:Ae(ee=>f(T),["stop"])},[(v(),G(he(V(T.category)),{class:"h-3 w-3"}))],10,ct))),128)),A.count>3?(v(),y("div",{key:0,class:"risk-indicator more",title:`+${A.count-3} more risks`}," +"+r(A.count-3),9,ut)):J("",!0)])):J("",!0)]),e("div",mt,[e("div",pt,[e("strong",null,r(A.level)+" Risk",1),e("span",null,"(L:"+r(A.likelihood)+", I:"+r(A.impact)+")",1)]),A.count>0?(v(),y("div",vt,[e("div",gt,r(A.count)+" risk(s)",1),e("ul",null,[(v(!0),y(Q,null,W(A.risks.slice(0,5),T=>(v(),y("li",{key:T.name},r(T.title),1))),128)),A.count>5?(v(),y("li",ft," ...and "+r(A.count-5)+" more ",1)):J("",!0)])])):(v(),y("div",xt,"No risks in this category"))])],14,at))),128))]))),128))]),e("div",bt,[(v(!0),y(Q,null,W(b.likelihoodLevels,h=>(v(),y("div",{key:h.id,class:"likelihood-label",title:h.description},[e("span",_t,r(h.id),1),e("span",ht,r(h.label),1)],8,yt))),128))]),C[3]||(C[3]=e("div",{class:"x-axis-label"},[e("span",null,"Likelihood")],-1))]),j.value?(v(),y("div",kt,[e("div",wt,[e("h4",null,r(j.value.level)+" Risk Cell",1),e("div",$t," Likelihood: "+r(j.value.likelihood)+", Impact: "+r(j.value.impact),1),i(t(_),{variant:"ghost",size:"sm",onClick:C[0]||(C[0]=h=>j.value=null)},{default:p(()=>[i(t(es),{class:"h-4 w-4"})]),_:1})]),e("div",Ct,[j.value.count>0?(v(),y("div",Rt,[(v(!0),y(Q,null,W(j.value.risks,h=>(v(),y("div",{key:h.name,class:O(["risk-item",{selected:b.selectedRisks.includes(h.name)}]),onClick:S=>M(h.name)},[e("div",At,[e("div",Vt,r(h.title),1),e("div",jt,[e("span",Dt,r(U(h.category)),1),e("span",Mt,r(h.risk_owner),1),e("span",Tt,r(h.status),1)])]),e("div",Ft,[i(t(_),{variant:"outline",size:"sm",onClick:Ae(S=>f(h),["stop"])},{default:p(()=>[...C[4]||(C[4]=[w(" View ",-1)])]),_:1},8,["onClick"]),e("input",{type:"checkbox",checked:b.selectedRisks.includes(h.name),onChange:S=>$.$emit("risk-select",h.name)},null,40,Pt)])],10,St))),128))])):(v(),y("div",It,[i(t(ss),{class:"h-8 w-8 text-gray-300"}),C[6]||(C[6]=e("p",null,"No risks in this category",-1)),i(t(_),{variant:"outline",size:"sm",onClick:C[1]||(C[1]=h=>q(j.value))},{default:p(()=>[i(t(Oe),{class:"h-4 w-4 mr-1"}),C[5]||(C[5]=w(" Add Risk Here ",-1))]),_:1})]))])])):J("",!0)]))}},zt=fs(Ut,[["__scopeId","data-v-ac904a79"]]);function Lt(b={}){var be;const{sections:g=[],form:m=Le({}),validateSection:L=null,childTables:j={}}=b,D=I(((be=g[0])==null?void 0:be.id)||""),n=Le({}),V=Le({}),U=I(!1),E=I(!1),R=I(!1);oe(()=>m,()=>{R.value=!0},{deep:!0});const f=u=>{var ne;if(((ne=V[u])==null?void 0:ne.length)>0)return"error";const x=g.find(te=>te.id===u);if(!(x!=null&&x.requiredFields))return"incomplete";const F=x.requiredFields,K=F.filter(te=>{const B=m[te];return Array.isArray(B)?B.length>0:typeof B=="boolean"?!0:B!=null&&B!==""});return K.length===0?"incomplete":K.length===F.length?"complete":"partial"},M=u=>{const x=f(u),F={complete:"bg-green-500 text-white",partial:"bg-yellow-400 text-white",incomplete:"bg-gray-200 text-gray-600",error:"bg-red-500 text-white"};return F[x]||F.incomplete},q=k(()=>g.filter(u=>f(u.id)==="complete").length),$=k(()=>g.length===0?0:Math.round(q.value/g.length*100)),C=k(()=>g.filter(x=>x.required!==!1).every(x=>f(x.id)==="complete")),h=u=>{g.find(x=>x.id===u)&&(D.value=u)},S=()=>{const u=g.findIndex(x=>x.id===D.value);u<g.length-1&&(D.value=g[u+1].id)},A=()=>{const u=g.findIndex(x=>x.id===D.value);u>0&&(D.value=g[u-1].id)},X=k(()=>g.findIndex(u=>u.id===D.value)===0),T=k(()=>g.findIndex(u=>u.id===D.value)===g.length-1),ee=()=>{const u=g.find(x=>{const F=f(x.id);return F==="error"||F==="incomplete"});u&&(D.value=u.id)},ae=()=>{Object.keys(n).forEach(x=>delete n[x]),Object.keys(V).forEach(x=>delete V[x]);let u=!0;for(const x of g)if(L){const F=L(x.id,m);F&&Object.keys(F).length>0&&(V[x.id]=Object.keys(F),Object.assign(n,F),u=!1)}return u||ee(),u},ve=u=>{n[u]&&delete n[u]},se=()=>{Object.keys(n).forEach(u=>delete n[u]),Object.keys(V).forEach(u=>delete V[u])},ge=()=>{const u=Ie({},m);for(const[x,F]of Object.entries(j))Array.isArray(u[x])&&(u[x]=u[x].map(K=>Ke(Ie({},K),{doctype:F})));return u},fe=(u={})=>{var x;Object.keys(m).forEach(F=>{Array.isArray(m[F])?m[F]=[]:typeof m[F]=="object"&&m[F]!==null?m[F]={}:m[F]=""}),Object.assign(m,u),D.value=((x=g[0])==null?void 0:x.id)||"",se(),R.value=!1},re=u=>{u&&(Object.keys(m).forEach(x=>{u[x]!==void 0&&(m[x]=u[x])}),R.value=!1)},xe=u=>g.find(x=>x.id===u),we=k(()=>g.findIndex(u=>u.id===D.value)+1);return{activeSection:D,errors:n,sectionErrors:V,isSaving:U,isSavingDraft:E,hasUnsavedChanges:R,completedSections:q,formProgress:$,isFormValid:C,isFirstSection:X,isLastSection:T,currentSectionIndex:we,getSectionStatus:f,getSectionStatusClass:M,navigateToSection:h,nextSection:S,prevSection:A,navigateToFirstError:ee,validateForm:ae,clearError:ve,clearAllErrors:se,prepareFormData:ge,resetForm:fe,loadFormData:re,getSection:xe}}const Et={class:"flex h-[85vh] overflow-hidden bg-gray-50 -m-4"},Ot={class:"w-72 bg-white border-r border-gray-200 flex flex-col"},qt={class:"p-6 border-b border-gray-200 bg-gradient-to-r from-red-50 to-orange-50"},Bt={class:"flex items-center gap-3"},Nt={class:"h-12 w-12 rounded-xl bg-gradient-to-br from-red-500 to-orange-500 flex items-center justify-center shadow-lg"},Yt={class:"text-lg font-bold text-gray-900"},Ht={class:"text-sm text-gray-600"},Qt={class:"mt-4 h-2 bg-gray-200 rounded-full overflow-hidden"},Wt={class:"flex-1 overflow-y-auto p-4"},Gt={class:"space-y-1"},Xt=["onClick"],Jt={key:2},Kt={class:"flex-1 min-w-0"},Zt={class:"font-medium truncate"},el={class:"text-xs text-gray-500 truncate"},sl={class:"p-4 border-t border-gray-200 bg-gray-50 space-y-2"},tl={class:"text-xs text-center text-gray-500"},ll={class:"flex-1 flex flex-col overflow-hidden"},il={class:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},ol={class:"flex items-center gap-4"},al={class:"text-sm text-gray-600"},rl={class:"flex items-center gap-2"},nl={class:"flex-1 overflow-y-auto p-6"},dl={class:"space-y-6 max-w-4xl"},cl={class:"bg-white rounded-xl border border-gray-200 p-6 space-y-6"},ul={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ml={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},pl={class:"space-y-6 max-w-4xl"},vl={class:"bg-white rounded-xl border border-gray-200 p-6 space-y-6"},gl={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},fl=["value"],xl={class:"text-sm font-medium text-gray-700"},bl={class:"space-y-6 max-w-4xl"},yl={class:"bg-white rounded-xl border border-gray-200 p-6"},_l={class:"space-y-6 max-w-5xl"},hl={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},kl={class:"bg-red-50 rounded-xl border border-red-200 p-4"},wl={class:"text-2xl font-bold text-red-900"},$l={class:"bg-orange-50 rounded-xl border border-orange-200 p-4"},Cl={class:"text-2xl font-bold text-orange-900"},Rl={class:"bg-yellow-50 rounded-xl border border-yellow-200 p-4"},Sl={class:"text-2xl font-bold text-yellow-900"},Al={class:"bg-green-50 rounded-xl border border-green-200 p-4"},Vl={class:"text-2xl font-bold text-green-900"},jl={class:"bg-white rounded-xl border border-gray-200 p-6"},Dl={key:0,class:"bg-white rounded-xl border border-gray-200 p-6"},Ml={class:"space-y-6 max-w-5xl"},Tl={class:"bg-white rounded-xl border border-gray-200 p-6"},Fl={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Pl={class:"bg-gray-50 rounded-xl border border-gray-200 p-4"},Il={class:"text-2xl font-bold text-gray-900"},Ul={class:"bg-blue-50 rounded-xl border border-blue-200 p-4"},zl={class:"text-2xl font-bold text-blue-900"},Ll={class:"bg-yellow-50 rounded-xl border border-yellow-200 p-4"},El={class:"text-2xl font-bold text-yellow-900"},Ol={class:"bg-green-50 rounded-xl border border-green-200 p-4"},ql={class:"text-2xl font-bold text-green-900"},Bl={class:"space-y-6 max-w-4xl"},Nl={class:"bg-white rounded-xl border border-gray-200 p-6 space-y-6"},Yl={class:"bg-gradient-to-r from-red-50 to-orange-50 rounded-xl p-6 border border-red-200"},Hl={class:"flex items-center justify-between mb-4"},Ql={class:"text-right"},Wl={class:"h-3 bg-gray-200 rounded-full overflow-hidden"},Gl={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Xl={key:0,class:"bg-white rounded-xl border border-gray-200 p-6"},Jl={class:"space-y-3"},Kl={class:"flex-1"},Zl={class:"font-medium text-gray-900"},ei={class:"text-sm text-gray-600"},si={class:"space-y-6 max-w-4xl"},ti={class:"bg-white rounded-xl border border-gray-200 p-6 space-y-6"},li={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ii={class:"border-t border-gray-200 pt-6"},oi={class:"relative"},ai={class:"space-y-6"},ri={class:"relative flex items-start gap-4"},ni={class:"h-8 w-8 rounded-full bg-green-100 border-2 border-green-500 flex items-center justify-center z-10"},di={class:"text-sm text-gray-600"},ci={class:"relative flex items-start gap-4"},ui={class:"text-sm text-gray-600"},mi={class:"relative flex items-start gap-4"},pi={class:"text-sm text-gray-600"},vi={class:"bg-white border-t border-gray-200 px-6 py-4"},gi={class:"flex items-center justify-between"},fi={class:"flex items-center gap-2"},xi={class:"text-sm text-gray-500"},bi={class:"flex items-center gap-3"},yi={__name:"RiskAssessmentForm",props:{modelValue:{type:Boolean,default:!1},assessment:{type:Object,default:null},mode:{type:String,default:"create"}},emits:["update:modelValue","submit","cancel","save-draft"],setup(b,{emit:g}){const m=b,L=g,j=k({get:()=>m.modelValue,set:a=>L("update:modelValue",a)}),D=k(()=>m.mode==="edit"),n=Le({assessment_id:"",assessment_name:"",assessment_date:new Date().toISOString().split("T")[0],fiscal_year:"",assessment_period:"Annual",status:"Planning",assessment_scope:"",methodology:"",assessment_team:[],risk_register:[],action_plan:[],top_risks:[],overall_risk_score:0,overall_risk_rating:"",assessment_summary:"",recommendations:"",prepared_by:"",reviewed_by:"",approved_by:""}),V=I([]),U=[{id:"basic",label:"Basic Information",description:"Assessment details",requiredFields:["assessment_name","assessment_date","fiscal_year","assessment_period"]},{id:"scope",label:"Scope & Methodology",description:"Assessment scope",requiredFields:["assessment_scope"]},{id:"team",label:"Assessment Team",description:"Team members",requiredFields:[]},{id:"risks",label:"Risk Register",description:"Identified risks",requiredFields:[]},{id:"actions",label:"Action Plan",description:"Mitigation actions",requiredFields:[]},{id:"summary",label:"Summary",description:"Assessment summary",requiredFields:[]},{id:"approvals",label:"Approvals",description:"Review & approval",requiredFields:[]}],E={assessment_team:"Assessment Team Member",risk_register:"Risk Assessment Register",action_plan:"Risk Assessment Action"},R=(a,l)=>{const c={},H=U.find(Z=>Z.id===a);if(!H)return c;for(const Z of H.requiredFields||[]){const ce=l[Z];(!ce||Array.isArray(ce)&&ce.length===0)&&(c[Z]=`${Z.replace(/_/g," ")} is required`)}return c},{activeSection:f,errors:M,isSaving:q,isSavingDraft:$,hasUnsavedChanges:C,completedSections:h,formProgress:S,isFormValid:A,isFirstSection:X,isLastSection:T,currentSectionIndex:ee,getSectionStatus:ae,getSectionStatusClass:ve,navigateToSection:se,nextSection:ge,prevSection:fe,clearError:re,prepareFormData:xe,loadFormData:we}=Lt({sections:U,form:n,validateSection:R,childTables:E}),be=[{label:"Annual",value:"Annual"},{label:"Mid-Year",value:"Mid-Year"},{label:"Quarterly",value:"Quarterly"},{label:"Ad-hoc",value:"Ad-hoc"}],u=[{label:"Planning",value:"Planning"},{label:"In Progress",value:"In Progress"},{label:"Review",value:"Review"},{label:"Finalized",value:"Finalized"},{label:"Approved",value:"Approved"}],x=[{label:"Interview",value:"Interview"},{label:"Workshop",value:"Workshop"},{label:"Survey",value:"Survey"},{label:"Document Review",value:"Document Review"},{label:"Data Analysis",value:"Data Analysis"},{label:"Self-Assessment",value:"Self-Assessment"}],F=[{key:"team_member",label:"Team Member",type:"link",doctype:"User"},{key:"role",label:"Role",type:"select",options:["Lead","Member","Observer","SME"]}],K={team_member:"",role:"Member"},ne=[{key:"risk_id",label:"Risk ID",width:"100px"},{key:"risk_title",label:"Risk Title"},{key:"risk_category",label:"Category",width:"120px"},{key:"likelihood_score",label:"Likelihood",width:"90px"},{key:"impact_score",label:"Impact",width:"80px"},{key:"inherent_risk_score",label:"Score",width:"80px",computed:!0},{key:"inherent_risk_rating",label:"Rating",width:"100px"}],te=[{key:"risk_id",label:"Risk ID",type:"text",required:!0},{key:"risk_title",label:"Risk Title",type:"text",required:!0},{key:"risk_description",label:"Risk Description",type:"textarea",required:!0},{key:"risk_category",label:"Category",type:"select",options:["Strategic","Operational","Financial","Compliance","Technology","Reputational"],required:!0},{key:"risk_subcategory",label:"Subcategory",type:"text"},{key:"auditable_entity",label:"Auditable Entity",type:"link",doctype:"Audit Universe Entity"},{key:"threat_source",label:"Threat Source",type:"text"},{key:"vulnerability",label:"Vulnerability",type:"textarea"},{key:"likelihood_score",label:"Likelihood Score (1-5)",type:"rating",required:!0},{key:"likelihood_rationale",label:"Likelihood Rationale",type:"textarea"},{key:"impact_score",label:"Impact Score (1-5)",type:"rating",required:!0},{key:"impact_rationale",label:"Impact Rationale",type:"textarea"},{key:"control_effectiveness",label:"Control Effectiveness",type:"select",options:["Strong","Adequate","Weak","Non-existent"]},{key:"existing_controls",label:"Existing Controls",type:"textarea"},{key:"residual_likelihood",label:"Residual Likelihood (1-5)",type:"rating"},{key:"residual_impact",label:"Residual Impact (1-5)",type:"rating"},{key:"risk_owner",label:"Risk Owner",type:"link",doctype:"User"},{key:"risk_response",label:"Risk Response",type:"select",options:["Accept","Mitigate","Transfer","Avoid"]},{key:"target_risk_score",label:"Target Risk Score",type:"number"},{key:"risk_velocity",label:"Risk Velocity",type:"select",options:["Very Slow","Slow","Medium","Fast","Very Fast"]},{key:"risk_trend",label:"Risk Trend",type:"select",options:["Increasing","Stable","Decreasing"]},{key:"last_review_date",label:"Last Review Date",type:"date"},{key:"next_review_date",label:"Next Review Date",type:"date"},{key:"notes",label:"Notes",type:"textarea"}],B={risk_id:"",risk_title:"",risk_description:"",risk_category:"",risk_subcategory:"",auditable_entity:"",threat_source:"",vulnerability:"",likelihood_score:3,likelihood_rationale:"",impact_score:3,impact_rationale:"",inherent_risk_score:9,inherent_risk_rating:"Medium",control_effectiveness:"Adequate",existing_controls:"",residual_likelihood:0,residual_impact:0,residual_risk_score:0,residual_risk_rating:"",risk_owner:"",risk_response:"Mitigate",target_risk_score:0,risk_velocity:"Medium",risk_trend:"Stable",last_review_date:"",next_review_date:"",notes:""},He=[{key:"action_id",label:"Action ID",width:"100px"},{key:"action_description",label:"Description"},{key:"responsible_party",label:"Responsible",width:"150px"},{key:"target_completion_date",label:"Due Date",width:"120px"},{key:"priority",label:"Priority",width:"100px"},{key:"status",label:"Status",width:"120px"}],Qe=[{key:"action_id",label:"Action ID",type:"text",required:!0},{key:"action_description",label:"Action Description",type:"textarea",required:!0},{key:"action_type",label:"Action Type",type:"select",options:["Process Improvement","Control Enhancement","Training","System Enhancement","Policy Update"]},{key:"priority",label:"Priority",type:"select",options:["Low","Medium","High","Critical"],required:!0},{key:"responsible_party",label:"Responsible Party",type:"link",doctype:"User",required:!0},{key:"target_completion_date",label:"Target Completion Date",type:"date",required:!0},{key:"estimated_cost",label:"Estimated Cost",type:"currency"},{key:"resource_required",label:"Resources Required",type:"text"},{key:"status",label:"Status",type:"select",options:["Planned","In Progress","Completed","Overdue","Cancelled"]},{key:"actual_completion_date",label:"Actual Completion Date",type:"date"},{key:"effectiveness_review_date",label:"Effectiveness Review Date",type:"date"},{key:"review_notes",label:"Review Notes",type:"textarea"}],We={action_id:"",action_description:"",action_type:"",priority:"Medium",responsible_party:"",target_completion_date:"",estimated_cost:0,resource_required:"",status:"Planned",actual_completion_date:"",effectiveness_review_date:"",review_notes:""},Ge=[{id:1,label:"Rare",description:"Unlikely to occur"},{id:2,label:"Unlikely",description:"Could occur occasionally"},{id:3,label:"Possible",description:"Might occur sometime"},{id:4,label:"Likely",description:"Will probably occur"},{id:5,label:"Almost Certain",description:"Expected to occur"}],Xe=[{id:1,label:"Negligible",description:"Minimal impact"},{id:2,label:"Minor",description:"Some minor issues"},{id:3,label:"Moderate",description:"Noticeable impact"},{id:4,label:"Major",description:"Significant impact"},{id:5,label:"Catastrophic",description:"Severe impact"}],$e=I(null),je=k(()=>{if(!$e.value)return"not yet saved";const a=Date.now()-$e.value;return a<6e4?"just now":a<36e5?`${Math.floor(a/6e4)} minutes ago`:"over an hour ago"}),de=k(()=>{const a={critical:0,high:0,medium:0,low:0};return n.risk_register.forEach(l=>{const c=l.inherent_risk_score||l.likelihood_score*l.impact_score;c>=20?a.critical++:c>=15?a.high++:c>=10?a.medium++:a.low++}),a}),ye=k(()=>{const a={planned:0,inProgress:0,completed:0};return n.action_plan.forEach(l=>{l.status==="Planned"?a.planned++:l.status==="In Progress"?a.inProgress++:l.status==="Completed"&&a.completed++}),a}),Ce=k(()=>[...n.risk_register].map(a=>Ke(Ie({},a),{inherent_risk_score:a.inherent_risk_score||a.likelihood_score*a.impact_score})).sort((a,l)=>l.inherent_risk_score-a.inherent_risk_score).slice(0,5)),Je=k(()=>{const a=[];for(let l=5;l>=1;l--){const c=[];for(let H=1;H<=5;H++){const Z=n.risk_register.filter(is=>is.likelihood_score===H&&is.impact_score===l),ce=l*H;let Fe="Low",Pe="#22c55e";ce>=20?(Fe="Critical",Pe="#ef4444"):ce>=15?(Fe="High",Pe="#f97316"):ce>=10&&(Fe="Medium",Pe="#eab308"),c.push({likelihood:H,impact:l,level:Fe,color:Pe,count:Z.length,risks:Z})}a.push(c)}return a}),De=k(()=>{const a=n.overall_risk_score||d();return a>=20?"text-red-600":a>=15?"text-orange-600":a>=10?"text-yellow-600":"text-green-600"}),Me=k(()=>{const a=n.overall_risk_score||d();return a>=20?"destructive":a>=15?"warning":a>=10?"secondary":"success"}),Re=k(()=>{const a=n.overall_risk_score||d();return a>=20?"bg-red-500":a>=15?"bg-orange-500":a>=10?"bg-yellow-500":"bg-green-500"}),Te=a=>V.value.includes(a),d=()=>{if(n.risk_register.length===0)return 0;const a=n.risk_register.reduce((l,c)=>l+(c.inherent_risk_score||c.likelihood_score*c.impact_score),0);return Math.round(a/n.risk_register.length)},s=()=>{const a=d();return a>=20?"Critical":a>=15?"High":a>=10?"Medium":"Low"},o=a=>a>=20?"destructive":a>=15?"warning":a>=10?"secondary":"success",P=a=>a>=20?"border-red-200 bg-red-50":a>=15?"border-orange-200 bg-orange-50":a>=10?"border-yellow-200 bg-yellow-50":"border-green-200 bg-green-50",N=a=>a>=20?"bg-red-500":a>=15?"bg-orange-500":a>=10?"bg-yellow-500":"bg-green-500",z=a=>a?new Date(a).toLocaleDateString():null,Y=a=>{console.log("Risk clicked:",a)},le=a=>{console.log("Heat map risk clicked:",a)},bs=()=>_e(this,null,function*(){$.value=!0;try{n.methodology=V.value.join(", ");const a=xe();L("save-draft",a),$e.value=Date.now()}catch(a){console.error("Error saving draft:",a)}finally{$.value=!1}}),ts=()=>_e(this,null,function*(){q.value=!0;try{n.methodology=V.value.join(", "),n.risk_register.forEach(l=>{l.inherent_risk_score=l.likelihood_score*l.impact_score,l.inherent_risk_rating=ls(l.inherent_risk_score),l.residual_likelihood&&l.residual_impact&&(l.residual_risk_score=l.residual_likelihood*l.residual_impact,l.residual_risk_rating=ls(l.residual_risk_score))}),n.overall_risk_score=d(),n.overall_risk_rating=s(),n.top_risks=Ce.value.map(l=>({risk_description:l.risk_title,inherent_risk_score:l.inherent_risk_score}));const a=xe();L("submit",a),j.value=!1}catch(a){console.error("Error submitting form:",a)}finally{q.value=!1}}),ls=a=>a>=20?"Critical":a>=15?"High":a>=10?"Medium":"Low",ys=()=>{C.value?confirm("You have unsaved changes. Are you sure you want to close?")&&(L("cancel"),j.value=!1):(L("cancel"),j.value=!1)};return oe(()=>m.assessment,a=>{a&&(we(a),a.methodology&&(V.value=a.methodology.split(", ").filter(Boolean)))},{immediate:!0}),oe(V,a=>{n.methodology=a.join(", ")},{deep:!0}),(a,l)=>(v(),G(t(Ee),{modelValue:j.value,"onUpdate:modelValue":l[18]||(l[18]=c=>j.value=c),options:{title:"",size:"7xl"}},{body:p(()=>[e("div",Et,[e("div",Ot,[e("div",qt,[e("div",Bt,[e("div",Nt,[i(t(pe),{class:"h-6 w-6 text-white"})]),e("div",null,[e("h2",Yt,r(D.value?"Edit Risk Assessment":"New Risk Assessment"),1),e("p",Ht,r(t(S))+"% Complete",1)])]),e("div",Qt,[e("div",{class:"h-full bg-gradient-to-r from-red-500 to-orange-500 transition-all duration-500",style:ke({width:`${t(S)}%`})},null,4)])]),e("nav",Wt,[e("div",Gt,[(v(),y(Q,null,W(U,(c,H)=>e("button",{key:c.id,onClick:Z=>t(se)(c.id),class:O(["w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all duration-200",{"bg-red-50 text-red-700 border-2 border-red-200 shadow-sm":t(f)===c.id,"hover:bg-gray-50 text-gray-700":t(f)!==c.id}])},[e("div",{class:O(["flex-shrink-0 h-8 w-8 rounded-lg flex items-center justify-center text-sm font-semibold transition-colors",t(ve)(c.id)])},[t(ae)(c.id)==="complete"?(v(),G(he(t(ze)),{key:0,class:"h-4 w-4"})):t(ae)(c.id)==="error"?(v(),G(he(t(ss)),{key:1,class:"h-4 w-4"})):(v(),y("span",Jt,r(H+1),1))],2),e("div",Kt,[e("div",Zt,r(c.label),1),e("div",el,r(c.description),1)]),t(f)===c.id?(v(),G(t(Ze),{key:0,class:"h-4 w-4 text-red-500 flex-shrink-0"})):J("",!0)],10,Xt)),64))])]),e("div",sl,[i(t(_),{variant:"outline",class:"w-full justify-center",onClick:bs,loading:t($)},{default:p(()=>[i(t(Us),{class:"h-4 w-4 mr-2"}),l[19]||(l[19]=w(" Save Draft ",-1))]),_:1},8,["loading"]),e("div",tl," Draft saved "+r(je.value),1)])]),e("div",ll,[e("div",il,[e("div",ol,[i(t(_),{variant:"ghost",size:"sm",onClick:t(fe),disabled:t(X)},{default:p(()=>[i(t(ns),{class:"h-4 w-4 mr-1"}),l[20]||(l[20]=w(" Previous ",-1))]),_:1},8,["onClick","disabled"]),e("span",al," Step "+r(t(ee))+" of "+r(U.length),1),i(t(_),{variant:"ghost",size:"sm",onClick:t(ge),disabled:t(T)},{default:p(()=>[l[21]||(l[21]=w(" Next ",-1)),i(t(Ze),{class:"h-4 w-4 ml-1"})]),_:1},8,["onClick","disabled"])]),e("div",rl,[i(t(_),{variant:"ghost",size:"sm",onClick:ys},{default:p(()=>[i(t(es),{class:"h-4 w-4 mr-1"}),l[22]||(l[22]=w(" Cancel ",-1))]),_:1}),i(t(_),{variant:"solid",theme:"red",size:"sm",onClick:ts,loading:t(q),disabled:!t(A)},{default:p(()=>[i(t(Ye),{class:"h-4 w-4 mr-2"}),w(" "+r(D.value?"Update Assessment":"Create Assessment"),1)]),_:1},8,["loading","disabled"])])]),e("div",nl,[ie(e("div",dl,[i(me,{title:"Basic Information",description:"Provide essential details about the risk assessment",icon:"Info"}),e("div",cl,[e("div",ul,[i(t(Se),{label:"Assessment Name",modelValue:n.assessment_name,"onUpdate:modelValue":l[0]||(l[0]=c=>n.assessment_name=c),required:"",placeholder:"Enter assessment name",error:t(M).assessment_name,onInput:l[1]||(l[1]=c=>t(re)("assessment_name"))},null,8,["modelValue","error"]),i(t(Se),{label:"Assessment Date",type:"date",modelValue:n.assessment_date,"onUpdate:modelValue":l[2]||(l[2]=c=>n.assessment_date=c),required:"",error:t(M).assessment_date,onInput:l[3]||(l[3]=c=>t(re)("assessment_date"))},null,8,["modelValue","error"])]),e("div",ml,[e("div",null,[l[23]||(l[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"},[w(" Fiscal Year "),e("span",{class:"text-red-500"},"*")],-1)),i(Ue,{modelValue:n.fiscal_year,"onUpdate:modelValue":l[4]||(l[4]=c=>n.fiscal_year=c),doctype:"Fiscal Year",placeholder:"Select fiscal year",error:t(M).fiscal_year},null,8,["modelValue","error"])]),e("div",null,[l[24]||(l[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"},[w(" Assessment Period "),e("span",{class:"text-red-500"},"*")],-1)),i(t(Ve),{modelValue:n.assessment_period,"onUpdate:modelValue":l[5]||(l[5]=c=>n.assessment_period=c),options:be,placeholder:"Select period"},null,8,["modelValue"])]),e("div",null,[l[25]||(l[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"}," Status ",-1)),i(t(Ve),{modelValue:n.status,"onUpdate:modelValue":l[6]||(l[6]=c=>n.status=c),options:u,placeholder:"Select status"},null,8,["modelValue"])])])])],512),[[ue,t(f)==="basic"]]),ie(e("div",pl,[i(me,{title:"Scope & Methodology",description:"Define the assessment scope and methodologies to be used",icon:"Target"}),e("div",vl,[i(t(Se),{label:"Assessment Scope",type:"textarea",modelValue:n.assessment_scope,"onUpdate:modelValue":l[7]||(l[7]=c=>n.assessment_scope=c),placeholder:"Describe the scope of this risk assessment...",rows:"4",error:t(M).assessment_scope,onInput:l[8]||(l[8]=c=>t(re)("assessment_scope"))},null,8,["modelValue","error"]),e("div",null,[l[26]||(l[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Assessment Methodology ",-1)),e("div",gl,[(v(),y(Q,null,W(x,c=>e("label",{key:c.value,class:O(["flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",{"bg-red-50 border-red-200":Te(c.value)}])},[ie(e("input",{type:"checkbox",value:c.value,"onUpdate:modelValue":l[9]||(l[9]=H=>V.value=H),class:"rounded border-gray-300 text-red-600 focus:ring-red-500"},null,8,fl),[[Cs,V.value]]),e("span",xl,r(c.label),1)],2)),64))])])])],512),[[ue,t(f)==="scope"]]),ie(e("div",bl,[i(me,{title:"Assessment Team",description:"Add team members who will participate in this assessment",icon:"Users"}),e("div",yl,[i(Ss,{modelValue:n.assessment_team,"onUpdate:modelValue":l[10]||(l[10]=c=>n.assessment_team=c),title:"Team Members",columns:F,defaultRow:K,addButtonLabel:"Add Team Member"},null,8,["modelValue"])])],512),[[ue,t(f)==="team"]]),ie(e("div",_l,[i(me,{title:"Risk Register",description:"Identify and assess risks in this assessment",icon:"AlertTriangle"}),e("div",hl,[e("div",kl,[l[27]||(l[27]=e("p",{class:"text-xs font-semibold text-red-700 uppercase"},"Critical",-1)),e("p",wl,r(de.value.critical),1)]),e("div",$l,[l[28]||(l[28]=e("p",{class:"text-xs font-semibold text-orange-700 uppercase"},"High",-1)),e("p",Cl,r(de.value.high),1)]),e("div",Rl,[l[29]||(l[29]=e("p",{class:"text-xs font-semibold text-yellow-700 uppercase"},"Medium",-1)),e("p",Sl,r(de.value.medium),1)]),e("div",Al,[l[30]||(l[30]=e("p",{class:"text-xs font-semibold text-green-700 uppercase"},"Low",-1)),e("p",Vl,r(de.value.low),1)])]),e("div",jl,[i(rs,{modelValue:n.risk_register,"onUpdate:modelValue":l[11]||(l[11]=c=>n.risk_register=c),title:"Risk Register",columns:ne,formFields:te,defaultRow:B,addButtonLabel:"Add Risk",modalTitle:"Risk Entry",onRowClick:Y},null,8,["modelValue"])]),n.risk_register.length>0?(v(),y("div",Dl,[l[31]||(l[31]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Risk Heat Map",-1)),i(zt,{matrixData:Je.value,likelihoodLevels:Ge,impactLevels:Xe,selectedRisks:[],onRiskClick:le},null,8,["matrixData"])])):J("",!0)],512),[[ue,t(f)==="risks"]]),ie(e("div",Ml,[i(me,{title:"Action Plan",description:"Define mitigation actions for identified risks",icon:"ListChecks"}),e("div",Tl,[i(rs,{modelValue:n.action_plan,"onUpdate:modelValue":l[12]||(l[12]=c=>n.action_plan=c),title:"Mitigation Actions",columns:He,formFields:Qe,defaultRow:We,addButtonLabel:"Add Action",modalTitle:"Action Item"},null,8,["modelValue"])]),e("div",Fl,[e("div",Pl,[l[32]||(l[32]=e("p",{class:"text-xs font-semibold text-gray-600 uppercase"},"Total Actions",-1)),e("p",Il,r(n.action_plan.length),1)]),e("div",Ul,[l[33]||(l[33]=e("p",{class:"text-xs font-semibold text-blue-700 uppercase"},"Planned",-1)),e("p",zl,r(ye.value.planned),1)]),e("div",Ll,[l[34]||(l[34]=e("p",{class:"text-xs font-semibold text-yellow-700 uppercase"},"In Progress",-1)),e("p",El,r(ye.value.inProgress),1)]),e("div",Ol,[l[35]||(l[35]=e("p",{class:"text-xs font-semibold text-green-700 uppercase"},"Completed",-1)),e("p",ql,r(ye.value.completed),1)])])],512),[[ue,t(f)==="actions"]]),ie(e("div",Bl,[i(me,{title:"Summary & Recommendations",description:"Provide overall assessment summary and key recommendations",icon:"FileText"}),e("div",Nl,[e("div",Yl,[e("div",Hl,[l[36]||(l[36]=e("div",null,[e("h4",{class:"text-lg font-semibold text-gray-900"},"Overall Risk Score"),e("p",{class:"text-sm text-gray-600"},"Based on identified risks")],-1)),e("div",Ql,[e("p",{class:O(["text-3xl font-bold",De.value])},r(n.overall_risk_score||d()),3),i(t(Be),{variant:Me.value,size:"sm"},{default:p(()=>[w(r(n.overall_risk_rating||s()),1)]),_:1},8,["variant"])])]),e("div",Wl,[e("div",{class:O(["h-full transition-all duration-500",Re.value]),style:ke({width:`${(n.overall_risk_score||d())*4}%`})},null,6)])]),e("div",Gl,[i(t(Se),{label:"Assessment Summary",type:"textarea",modelValue:n.assessment_summary,"onUpdate:modelValue":l[13]||(l[13]=c=>n.assessment_summary=c),placeholder:"Summarize the key findings and conclusions...",rows:"6"},null,8,["modelValue"]),i(t(Se),{label:"Recommendations",type:"textarea",modelValue:n.recommendations,"onUpdate:modelValue":l[14]||(l[14]=c=>n.recommendations=c),placeholder:"Provide key recommendations based on the assessment...",rows:"6"},null,8,["modelValue"])])]),Ce.value.length>0?(v(),y("div",Xl,[l[37]||(l[37]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Top Risks",-1)),e("div",Jl,[(v(!0),y(Q,null,W(Ce.value,(c,H)=>(v(),y("div",{key:c.risk_id,class:O(["flex items-center gap-4 p-4 rounded-lg border",P(c.inherent_risk_score)])},[e("div",{class:O(["h-8 w-8 rounded-lg flex items-center justify-center text-white font-bold text-sm",N(c.inherent_risk_score)])},r(H+1),3),e("div",Kl,[e("p",Zl,r(c.risk_title),1),e("p",ei,r(c.risk_category),1)]),i(t(Be),{variant:o(c.inherent_risk_score),size:"sm"},{default:p(()=>[w(" Score: "+r(c.inherent_risk_score),1)]),_:2},1032,["variant"])],2))),128))])])):J("",!0)],512),[[ue,t(f)==="summary"]]),ie(e("div",si,[i(me,{title:"Approvals",description:"Track preparation, review, and approval of the assessment",icon:"UserCheck"}),e("div",ti,[e("div",li,[e("div",null,[l[38]||(l[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"}," Prepared By ",-1)),i(Ue,{modelValue:n.prepared_by,"onUpdate:modelValue":l[15]||(l[15]=c=>n.prepared_by=c),doctype:"User",placeholder:"Select preparer"},null,8,["modelValue"])]),e("div",null,[l[39]||(l[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"}," Reviewed By ",-1)),i(Ue,{modelValue:n.reviewed_by,"onUpdate:modelValue":l[16]||(l[16]=c=>n.reviewed_by=c),doctype:"User",placeholder:"Select reviewer"},null,8,["modelValue"])]),e("div",null,[l[40]||(l[40]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1.5"}," Approved By ",-1)),i(Ue,{modelValue:n.approved_by,"onUpdate:modelValue":l[17]||(l[17]=c=>n.approved_by=c),doctype:"User",placeholder:"Select approver"},null,8,["modelValue"])])]),e("div",ii,[l[45]||(l[45]=e("h4",{class:"text-sm font-semibold text-gray-700 mb-4"},"Approval Timeline",-1)),e("div",oi,[l[44]||(l[44]=e("div",{class:"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-200"},null,-1)),e("div",ai,[e("div",ri,[e("div",ni,[i(t(ze),{class:"h-4 w-4 text-green-600"})]),e("div",null,[l[41]||(l[41]=e("p",{class:"font-medium text-gray-900"},"Created",-1)),e("p",di,r(z(n.creation)||"Pending"),1)])]),e("div",ci,[e("div",{class:O(["h-8 w-8 rounded-full border-2 flex items-center justify-center z-10",n.reviewed_by?"bg-green-100 border-green-500":"bg-gray-100 border-gray-300"])},[(v(),G(he(n.reviewed_by?t(ze):t(ds)),{class:O(["h-4 w-4",n.reviewed_by?"text-green-600":"text-gray-400"])},null,8,["class"]))],2),e("div",null,[l[42]||(l[42]=e("p",{class:"font-medium text-gray-900"},"Reviewed",-1)),e("p",ui,r(n.reviewed_by||"Awaiting review"),1)])]),e("div",mi,[e("div",{class:O(["h-8 w-8 rounded-full border-2 flex items-center justify-center z-10",n.approved_by?"bg-green-100 border-green-500":"bg-gray-100 border-gray-300"])},[(v(),G(he(n.approved_by?t(ze):t(ds)),{class:O(["h-4 w-4",n.approved_by?"text-green-600":"text-gray-400"])},null,8,["class"]))],2),e("div",null,[l[43]||(l[43]=e("p",{class:"font-medium text-gray-900"},"Approved",-1)),e("p",pi,r(n.approved_by||"Awaiting approval"),1)])])])])])])],512),[[ue,t(f)==="approvals"]])]),e("div",vi,[e("div",gi,[i(t(_),{variant:"outline",onClick:t(fe),disabled:t(X)},{default:p(()=>[i(t(ns),{class:"h-4 w-4 mr-2"}),l[46]||(l[46]=w(" Previous ",-1))]),_:1},8,["onClick","disabled"]),e("div",fi,[e("span",xi,r(t(h))+" of "+r(U.length)+" sections complete ",1)]),e("div",bi,[t(T)?(v(),G(t(_),{key:1,variant:"solid",theme:"red",onClick:ts,loading:t(q),disabled:!t(A)},{default:p(()=>[i(t(Ye),{class:"h-4 w-4 mr-2"}),w(" "+r(D.value?"Update Assessment":"Create Assessment"),1)]),_:1},8,["loading","disabled"])):(v(),G(t(_),{key:0,variant:"solid",theme:"gray",onClick:t(ge)},{default:p(()=>[l[47]||(l[47]=w(" Next Section ",-1)),i(t(Ze),{class:"h-4 w-4 ml-2"})]),_:1},8,["onClick"]))])])])])])]),_:1},8,["modelValue"]))}},_i=fs(yi,[["__scopeId","data-v-7c73861b"]]),hi={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-4"},ki={class:"bg-blue-50 rounded-xl border border-blue-200 p-6 hover:shadow-lg transition-shadow"},wi={class:"flex items-center justify-between"},$i={class:"text-3xl font-bold text-blue-900 mt-1"},Ci={class:"p-3 bg-blue-500 rounded-xl shadow-sm"},Ri={class:"bg-red-50 rounded-xl border border-red-200 p-6 hover:shadow-lg transition-shadow"},Si={class:"flex items-center justify-between"},Ai={class:"text-3xl font-bold text-red-900 mt-1"},Vi={class:"p-3 bg-red-500 rounded-xl shadow-sm"},ji={class:"bg-orange-50 rounded-xl border border-orange-200 p-6 hover:shadow-lg transition-shadow"},Di={class:"flex items-center justify-between"},Mi={class:"text-3xl font-bold text-orange-900 mt-1"},Ti={class:"p-3 bg-orange-500 rounded-xl shadow-sm"},Fi={class:"bg-green-50 rounded-xl border border-green-200 p-6 hover:shadow-lg transition-shadow"},Pi={class:"flex items-center justify-between"},Ii={class:"text-3xl font-bold text-green-900 mt-1"},Ui={class:"p-3 bg-green-500 rounded-xl shadow-sm"},zi={class:"bg-purple-50 rounded-xl border border-purple-200 p-6 hover:shadow-lg transition-shadow"},Li={class:"flex items-center justify-between"},Ei={class:"text-3xl font-bold text-purple-900 mt-1"},Oi={class:"w-full bg-purple-200 rounded-full h-2 mt-2"},qi={class:"p-3 bg-purple-500 rounded-xl shadow-sm"},Bi={__name:"RiskAssessmentStats",props:{stats:{type:Object,required:!0,default:()=>({total:0,criticalRisks:0,highRisks:0,approved:0,averageRiskScore:0})}},setup(b){return(g,m)=>(v(),y("div",hi,[e("div",ki,[e("div",wi,[e("div",null,[m[0]||(m[0]=e("p",{class:"text-sm font-semibold text-blue-700 uppercase tracking-wide"},"Total Assessments",-1)),e("p",$i,r(b.stats.total),1),m[1]||(m[1]=e("p",{class:"text-xs text-blue-600 mt-1"},"Active assessments",-1))]),e("div",Ci,[i(t(qe),{class:"h-7 w-7 text-white"})])])]),e("div",Ri,[e("div",Si,[e("div",null,[m[2]||(m[2]=e("p",{class:"text-sm font-semibold text-red-700 uppercase tracking-wide"},"Critical Risks",-1)),e("p",Ai,r(b.stats.criticalRisks),1),m[3]||(m[3]=e("p",{class:"text-xs text-red-600 mt-1"},"High priority items",-1))]),e("div",Vi,[i(t(pe),{class:"h-7 w-7 text-white"})])])]),e("div",ji,[e("div",Di,[e("div",null,[m[4]||(m[4]=e("p",{class:"text-sm font-semibold text-orange-700 uppercase tracking-wide"},"High Risks",-1)),e("p",Mi,r(b.stats.highRisks),1),m[5]||(m[5]=e("p",{class:"text-xs text-orange-600 mt-1"},"Medium priority items",-1))]),e("div",Ti,[i(t(ss),{class:"h-7 w-7 text-white"})])])]),e("div",Fi,[e("div",Pi,[e("div",null,[m[6]||(m[6]=e("p",{class:"text-sm font-semibold text-green-700 uppercase tracking-wide"},"Approved",-1)),e("p",Ii,r(b.stats.approved),1),m[7]||(m[7]=e("p",{class:"text-xs text-green-600 mt-1"},"Completed assessments",-1))]),e("div",Ui,[i(t(Ye),{class:"h-7 w-7 text-white"})])])]),e("div",zi,[e("div",Li,[e("div",null,[m[8]||(m[8]=e("p",{class:"text-sm font-semibold text-purple-700 uppercase tracking-wide"},"Avg Risk Score",-1)),e("p",Ei,r(b.stats.averageRiskScore),1),e("div",Oi,[e("div",{class:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:ke({width:`${Math.min(b.stats.averageRiskScore,25)*4}%`})},null,4)])]),e("div",qi,[i(t(Ne),{class:"h-7 w-7 text-white"})])])])]))}},Ni={class:"space-y-6"},Yi={class:"flex flex-col lg:flex-row lg:items-center justify-between gap-4"},Hi={class:"flex items-center space-x-3"},Qi={class:"p-2 bg-red-100 rounded-lg"},Wi={class:"flex flex-wrap items-center gap-3"},Gi={class:"flex items-center space-x-2"},Xi={class:"p-1"},Ji={class:"p-1"},Ki={class:"p-1"},Zi={class:"p-1"},eo={class:"bg-white rounded-xl border border-gray-200 shadow-sm"},so={class:"px-6 py-4 border-b border-gray-200"},to={class:"flex items-center justify-between"},lo={class:"flex items-center space-x-2"},io={key:0,class:"p-1"},oo={key:0,class:"overflow-x-auto"},ao={class:"min-w-full divide-y divide-gray-200"},ro={class:"bg-gray-50"},no={class:"px-6 py-3 text-left"},co=["checked"],uo={class:"flex items-center space-x-1"},mo={class:"flex items-center space-x-1"},po={class:"bg-white divide-y divide-gray-200"},vo={class:"px-6 py-4"},go=["checked","onChange"],fo={class:"px-6 py-4 whitespace-nowrap"},xo={class:"flex items-center"},bo={class:"flex-shrink-0 h-10 w-10"},yo={class:"h-10 w-10 rounded-lg bg-red-500 flex items-center justify-center text-white font-bold text-sm"},_o={class:"ml-4"},ho={class:"text-sm font-semibold text-gray-900"},ko={class:"text-sm text-gray-500"},wo={class:"px-6 py-4"},$o={class:"text-sm font-medium text-gray-900"},Co={class:"text-sm text-gray-500"},Ro={class:"px-6 py-4 whitespace-nowrap"},So={class:"text-sm font-medium text-gray-900"},Ao={class:"px-6 py-4 whitespace-nowrap"},Vo={class:"flex items-center"},jo={class:"text-sm font-medium text-gray-900"},Do={class:"ml-2 w-12 bg-gray-200 rounded-full h-1.5"},Mo={class:"px-6 py-4 whitespace-nowrap"},To={class:"flex items-center space-x-2"},Fo={class:"text-sm font-medium text-gray-900"},Po={class:"px-6 py-4 whitespace-nowrap"},Io={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Uo={class:"flex items-center space-x-1"},zo={key:1,class:"p-6"},Lo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Eo=["onClick"],Oo={class:"flex items-start justify-between mb-4"},qo={class:"flex items-center space-x-3"},Bo={class:"h-12 w-12 rounded-xl bg-red-500 flex items-center justify-center text-white font-bold"},No={class:"text-lg font-semibold text-gray-900 group-hover:text-red-900"},Yo={class:"text-sm text-gray-600"},Ho={class:"space-y-3"},Qo={class:"flex justify-between items-center mb-1"},Wo={class:"text-sm font-medium"},Go={class:"w-full bg-gray-200 rounded-full h-2"},Xo={class:"flex justify-between items-center"},Jo={class:"text-sm font-medium"},Ko={class:"flex justify-between items-center"},Zo={class:"text-sm font-medium"},ea={class:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200"},sa={class:"flex items-center space-x-1"},ta={class:"text-xs text-gray-500"},la={key:2,class:"px-6 py-20 text-center"},ia={class:"mx-auto h-20 w-20 rounded-2xl bg-red-50 border-2 border-red-100 flex items-center justify-center mb-8 shadow-sm"},oa={class:"max-w-md mx-auto"},aa={class:"flex flex-col sm:flex-row justify-center gap-3"},ra={key:3,class:"px-6 py-12 text-center"},na={class:"p-1"},da={class:"space-y-6 p-6 bg-gray-50"},ca={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"},ua={class:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg hover:border-red-300 cursor-pointer transition-all duration-200 group"},ma={class:"flex items-start space-x-4 mb-5"},pa={class:"flex-shrink-0 p-3 bg-red-50 rounded-xl group-hover:bg-red-100 transition-colors"},va={class:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg hover:border-orange-300 cursor-pointer transition-all duration-200 group"},ga={class:"flex items-start space-x-4 mb-5"},fa={class:"flex-shrink-0 p-3 bg-orange-50 rounded-xl group-hover:bg-orange-100 transition-colors"},xa={class:"space-y-6"},ba={class:"bg-red-50 border border-red-200 rounded-lg p-4"},ya={class:"text-red-800"},_a={class:"font-semibold"},ha={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ka={class:"p-1"},wa={class:"flex flex-col items-center justify-center space-y-2"},$a={class:"p-1"},Ca={class:"flex flex-col items-center justify-center space-y-2"},Ra={class:"p-1"},Sa={class:"flex flex-col items-center justify-center space-y-2"},Aa={class:"p-1"},Va={class:"flex flex-col items-center justify-center space-y-2"},ja={class:"space-y-6"},Da={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ma={class:"bg-red-50 rounded-lg p-6"},Ta={class:"space-y-3"},Fa={class:"flex justify-between"},Pa={class:"font-medium text-red-900"},Ia={class:"flex justify-between"},Ua={class:"font-medium text-red-900"},za={class:"flex justify-between"},La={class:"font-medium text-red-900"},Ea={class:"bg-orange-50 rounded-lg p-6"},Oa={class:"space-y-3"},qa={class:"flex justify-between"},Ba={class:"font-medium text-orange-900"},Na={class:"flex justify-between"},Ya={class:"font-medium text-orange-900"},Ha={class:"flex justify-between"},Qa={class:"font-medium text-orange-900"},Wa={class:"bg-purple-50 rounded-lg p-6"},Ga={class:"space-y-3"},Xa={class:"flex justify-between"},Ja={class:"font-medium text-purple-900"},Ka={class:"flex justify-between"},Za={class:"font-medium text-purple-900"},er={class:"flex justify-between"},sr={class:"font-medium text-purple-900"},nr={__name:"RiskAssessments",setup(b){const g=Rs(),m=As(),L=I(!1),j=I(!1),D=I(!1),n=I(!1),V=I(!1),U=I(!1);I(!1);const E=I(!1),R=I(null),f=I("create"),M=I("table"),q=I(""),$=I(""),C=I(""),h=I(""),S=I([]),A=I("assessment_id"),X=I("asc"),T=k(()=>m.riskAssessments||[]),ee=k(()=>T.value.reduce((d,s)=>{var o;return d+(((o=s.top_risks)==null?void 0:o.filter(P=>P.inherent_risk_score>=20).length)||0)},0)),ae=k(()=>T.value.reduce((d,s)=>{var o;return d+(((o=s.top_risks)==null?void 0:o.filter(P=>P.inherent_risk_score>=15&&P.inherent_risk_score<20).length)||0)},0)),ve=k(()=>T.value.filter(d=>d.status==="Approved").length),se=k(()=>{const d=T.value;if(d.length===0)return 0;const s=d.reduce((o,P)=>o+B(P),0);return Math.round(s/d.length)}),ge=k(()=>({total:T.value.length,criticalRisks:ee.value,highRisks:ae.value,approved:ve.value,averageRiskScore:se.value})),fe=k(()=>T.value.reduce((d,s)=>{var o;return d+(((o=s.top_risks)==null?void 0:o.filter(P=>P.inherent_risk_score>=10&&P.inherent_risk_score<15).length)||0)},0)),re=k(()=>T.value.filter(d=>d.status==="In Progress").length),xe=k(()=>T.value.filter(d=>d.status==="Planning").length),we=k(()=>se.value>15?"Increasing":"Stable"),be=k(()=>"Operational");k(()=>{const d=new Date().getFullYear(),s=[];for(let o=d-2;o<=d+2;o++)s.push({label:o.toString(),value:o.toString()});return s});const u=k(()=>{let d=T.value;if(q.value){const s=q.value.toLowerCase();d=d.filter(o=>{var P,N,z;return((P=o.assessment_id)==null?void 0:P.toLowerCase().includes(s))||((N=o.assessment_name)==null?void 0:N.toLowerCase().includes(s))||((z=o.assessment_period)==null?void 0:z.toLowerCase().includes(s))})}return $.value&&(d=d.filter(s=>s.status===$.value)),C.value&&(d=d.filter(s=>s.assessment_period===C.value)),h.value&&(d=d.filter(s=>s.fiscal_year===h.value)),d}),x=()=>{q.value="",$.value="",C.value="",h.value=""},F=()=>{D.value=!0;try{const d=u.value.map(z=>{var Y,le;return{"Assessment ID":z.assessment_id,"Assessment Name":z.assessment_name,Period:z.assessment_period,Year:z.fiscal_year,Date:Re(z.assessment_date),Status:z.status,"Total Risks":((Y=z.risk_register)==null?void 0:Y.length)||0,"Critical Risks":((le=z.top_risks)==null?void 0:le.length)||0,"Average Risk Score":B(z)}}),s=[Object.keys(d[0]).join(","),...d.map(z=>Object.values(z).map(Y=>`"${Y}"`).join(","))].join(`
`),o=new Blob([s],{type:"text/csv"}),P=window.URL.createObjectURL(o),N=document.createElement("a");N.href=P,N.download=`risk-assessments-${new Date().toISOString().split("T")[0]}.csv`,N.click(),window.URL.revokeObjectURL(P)}finally{D.value=!1}},K=()=>{S.value.length===u.value.length?S.value=[]:S.value=u.value.map(d=>d.name)},ne=d=>{const s=S.value.indexOf(d);s>-1?S.value.splice(s,1):S.value.push(d)},te=d=>{A.value===d?X.value=X.value==="asc"?"desc":"asc":(A.value=d,X.value="asc")},B=d=>{if(!d.top_risks||d.top_risks.length===0)return 0;const s=d.top_risks.reduce((o,P)=>o+(P.inherent_risk_score||0),0);return Math.round(s/d.top_risks.length)},He=d=>d>=20?"bg-red-500":d>=15?"bg-orange-500":d>=10?"bg-yellow-500":"bg-green-500",Qe=(d,s)=>{console.log("Show menu for assessment:",d.name)},We=()=>{console.log("Bulk update status for selected assessments")},Ge=()=>{console.log("Bulk export selected assessments")},Xe=()=>{console.log("Generate reports for selected assessments")},$e=()=>{console.log("Bulk delete selected assessments")},je=()=>{R.value=null,f.value="create",E.value=!0},de=d=>{g.push(`/audit-planning/risk-assessment/${d.name}`)},ye=d=>{R.value=d,f.value="edit",E.value=!0},Ce=d=>_e(this,null,function*(){try{j.value=!0,f.value==="create"?yield m.createRiskAssessment(d):yield m.updateRiskAssessment(R.value.name,d),E.value=!1,yield De()}catch(s){console.error("Error saving assessment:",s)}finally{j.value=!1}}),Je=()=>{E.value=!1,R.value=null},De=()=>_e(this,null,function*(){L.value=!0;try{yield m.fetchRiskAssessments()}catch(d){console.error("Error refreshing data:",d)}finally{L.value=!1}}),Me=d=>_e(this,null,function*(){try{(yield m.fetchRiskAssessmentDetails(d.name))&&g.push("/audit-planning/risk-assessment/new")}catch(s){console.error("Error duplicating assessment:",s)}}),Re=d=>d?new Date(d).toLocaleDateString():"",Te=d=>({Planning:"secondary","In Progress":"warning",Review:"info",Finalized:"success",Approved:"success"})[d]||"secondary";return oe(u,()=>{S.value=[]}),oe(q,()=>{}),oe($,()=>{S.value=[]}),oe(C,()=>{S.value=[]}),oe(h,()=>{S.value=[]}),(d,s)=>(v(),y("div",Ni,[e("div",Yi,[e("div",null,[e("div",Hi,[e("div",Qi,[i(t(pe),{class:"h-6 w-6 text-red-600"})]),s[15]||(s[15]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Risk Assessments"),e("p",{class:"text-gray-600 mt-1"}," Conduct and manage comprehensive risk assessments with advanced analytics ")],-1))])]),e("div",Wi,[e("div",Gi,[e("div",Xi,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:F,loading:D.value},{prefix:p(()=>[i(t(cs),{class:"h-3.5 w-3.5"})]),default:p(()=>[s[16]||(s[16]=w(" Export ",-1))]),_:1},8,["loading"])]),e("div",Ji,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:s[0]||(s[0]=o=>n.value=!0)},{prefix:p(()=>[i(t(qe),{class:"h-3.5 w-3.5"})]),default:p(()=>[s[17]||(s[17]=w(" Templates ",-1))]),_:1})]),e("div",Ki,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:De,loading:L.value},{prefix:p(()=>[i(t(zs),{class:"h-3.5 w-3.5"})]),default:p(()=>[s[18]||(s[18]=w(" Refresh ",-1))]),_:1},8,["loading"])]),e("div",Zi,[i(t(_),{variant:"solid",theme:"red",size:"sm",onClick:je},{prefix:p(()=>[i(t(Oe),{class:"h-3.5 w-3.5"})]),default:p(()=>[s[19]||(s[19]=w(" New Assessment ",-1))]),_:1})])])])]),i(Bi,{stats:ge.value},null,8,["stats"]),i(Ks,{searchQuery:q.value,"onUpdate:searchQuery":s[1]||(s[1]=o=>q.value=o),filterStatus:$.value,"onUpdate:filterStatus":s[2]||(s[2]=o=>$.value=o),filterPeriod:C.value,"onUpdate:filterPeriod":s[3]||(s[3]=o=>C.value=o),filterYear:h.value,"onUpdate:filterYear":s[4]||(s[4]=o=>h.value=o),viewMode:M.value,selectedCount:S.value.length,filteredCount:u.value.length,totalCount:T.value.length,onBulkAction:s[5]||(s[5]=o=>V.value=!0),onShowAnalytics:s[6]||(s[6]=o=>U.value=!0),onToggleView:s[7]||(s[7]=o=>M.value=M.value==="table"?"cards":"table"),onClearFilters:x},null,8,["searchQuery","filterStatus","filterPeriod","filterYear","viewMode","selectedCount","filteredCount","totalCount"]),e("div",eo,[e("div",so,[e("div",to,[s[20]||(s[20]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Risk Assessments",-1)),e("div",lo,[M.value==="table"&&u.value.length>0?(v(),y("div",io,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:K},{default:p(()=>[w(r(S.value.length===u.value.length?"Deselect All":"Select All"),1)]),_:1})])):J("",!0)])])]),M.value==="table"?(v(),y("div",oo,[e("table",ao,[e("thead",ro,[e("tr",null,[e("th",no,[e("input",{type:"checkbox",class:"rounded border-gray-300 text-red-600 focus:ring-red-500",checked:S.value.length===u.value.length&&u.value.length>0,onChange:K},null,40,co)]),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:s[8]||(s[8]=o=>te("assessment_id"))},[e("div",uo,[s[21]||(s[21]=e("span",null,"Assessment ID",-1)),i(t(us),{class:"h-3 w-3"})])]),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:s[9]||(s[9]=o=>te("assessment_name"))},[e("div",mo,[s[22]||(s[22]=e("span",null,"Name",-1)),i(t(us),{class:"h-3 w-3"})])]),s[23]||(s[23]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Period ",-1)),s[24]||(s[24]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Risk Score ",-1)),s[25]||(s[25]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Critical Risks ",-1)),s[26]||(s[26]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status ",-1)),s[27]||(s[27]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",po,[(v(!0),y(Q,null,W(u.value,o=>{var P,N,z;return v(),y("tr",{key:o.name,class:O(["hover:bg-gray-50 transition-colors",{"bg-red-50":S.value.includes(o.name)}])},[e("td",vo,[e("input",{type:"checkbox",class:"rounded border-gray-300 text-red-600 focus:ring-red-500",checked:S.value.includes(o.name),onChange:Y=>ne(o.name)},null,40,go)]),e("td",fo,[e("div",xo,[e("div",bo,[e("div",yo,r(((N=(P=o.assessment_id)==null?void 0:P.charAt(0))==null?void 0:N.toUpperCase())||"R"),1)]),e("div",_o,[e("div",ho,r(o.assessment_id),1),e("div",ko,r(Re(o.assessment_date)),1)])])]),e("td",wo,[e("div",$o,r(o.assessment_name),1),e("div",Co,r(o.fiscal_year),1)]),e("td",Ro,[e("div",So,r(o.assessment_period),1)]),e("td",Ao,[e("div",Vo,[e("span",jo,r(B(o)),1),e("div",Do,[e("div",{class:O(["h-1.5 rounded-full transition-all duration-300",He(B(o))]),style:ke({width:`${Math.min(B(o),25)*4}%`})},null,6)])])]),e("td",Mo,[e("div",To,[e("span",Fo,r(((z=o.top_risks)==null?void 0:z.length)||0),1),s[28]||(s[28]=e("span",{class:"text-xs text-red-600"},"critical",-1))])]),e("td",Po,[i(t(Be),{variant:Te(o.status),size:"sm",class:"font-medium"},{default:p(()=>[w(r(o.status),1)]),_:2},1032,["variant"])]),e("td",Io,[e("div",Uo,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Y=>de(o),class:"!p-1.5"},{default:p(()=>[i(t(ms),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"]),i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Y=>ye(o),class:"!p-1.5"},{default:p(()=>[i(t(ps),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"]),i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Y=>Me(o),class:"!p-1.5"},{default:p(()=>[i(t(vs),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"]),i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Y=>Qe(o),class:"!p-1.5"},{default:p(()=>[i(t(Ls),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"])])])],2)}),128))])])])):(v(),y("div",zo,[e("div",Lo,[(v(!0),y(Q,null,W(u.value,o=>{var P,N,z,Y;return v(),y("div",{key:o.name,class:O(["bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 cursor-pointer group",{"ring-2 ring-red-500 bg-red-50":S.value.includes(o.name)}]),onClick:le=>ne(o.name)},[e("div",Oo,[e("div",qo,[e("div",Bo,r(((N=(P=o.assessment_id)==null?void 0:P.charAt(0))==null?void 0:N.toUpperCase())||"R"),1),e("div",null,[e("h3",No,r(o.assessment_name),1),e("p",Yo,r(o.assessment_period)+" "+r(o.fiscal_year),1)])]),i(t(Be),{variant:Te(o.status),size:"sm",class:"font-medium"},{default:p(()=>[w(r(o.status),1)]),_:2},1032,["variant"])]),e("div",Ho,[e("div",null,[e("div",Qo,[s[29]||(s[29]=e("span",{class:"text-sm text-gray-600"},"Risk Score",-1)),e("span",Wo,r(B(o)),1)]),e("div",Go,[e("div",{class:"bg-red-500 h-2 rounded-full transition-all duration-300",style:ke({width:`${Math.min(B(o),25)*4}%`})},null,4)])]),e("div",Xo,[s[30]||(s[30]=e("span",{class:"text-sm text-gray-600"},"Critical Risks",-1)),e("span",Jo,r(((z=o.top_risks)==null?void 0:z.length)||0),1)]),e("div",Ko,[s[31]||(s[31]=e("span",{class:"text-sm text-gray-600"},"Total Risks",-1)),e("span",Zo,r(((Y=o.risk_register)==null?void 0:Y.length)||0),1)])]),e("div",ea,[e("div",sa,[i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Ae(le=>de(o),["stop"]),class:"!p-1.5"},{default:p(()=>[i(t(ms),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"]),i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Ae(le=>ye(o),["stop"]),class:"!p-1.5"},{default:p(()=>[i(t(ps),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"]),i(t(_),{variant:"solid",theme:"gray",size:"sm",onClick:Ae(le=>Me(o),["stop"]),class:"!p-1.5"},{default:p(()=>[i(t(vs),{class:"h-3.5 w-3.5"})]),_:1},8,["onClick"])]),e("div",ta,r(Re(o.modified)),1)])],10,Eo)}),128))])])),u.value.length===0&&T.value.length===0?(v(),y("div",la,[e("div",ia,[i(t(pe),{class:"h-10 w-10 text-red-500"})]),e("div",oa,[s[34]||(s[34]=e("h3",{class:"text-2xl font-bold text-gray-900 mb-3"},"Welcome to Risk Assessments",-1)),s[35]||(s[35]=e("p",{class:"text-gray-600 mb-8 leading-relaxed"}," Conduct comprehensive risk assessments to identify, evaluate, and prioritize organizational risks. Build a robust risk management framework. ",-1)),e("div",aa,[i(t(_),{variant:"solid",theme:"red",size:"lg",onClick:je,class:"shadow-sm hover:shadow-md transition-shadow"},{prefix:p(()=>[i(t(Oe),{class:"h-5 w-5"})]),default:p(()=>[s[32]||(s[32]=w(" Create Your First Assessment ",-1))]),_:1}),i(t(_),{variant:"outline",theme:"gray",size:"lg",onClick:s[10]||(s[10]=o=>n.value=!0),class:"border-gray-300 hover:border-gray-400"},{prefix:p(()=>[i(t(qe),{class:"h-5 w-5"})]),default:p(()=>[s[33]||(s[33]=w(" Browse Templates ",-1))]),_:1})])]),s[36]||(s[36]=gs('<div class="mt-12 max-w-2xl mx-auto"><div class="bg-gray-50 border border-gray-200 rounded-xl p-6"><h4 class="text-lg font-semibold text-gray-900 mb-4 flex items-center"><div class="h-2 w-2 bg-red-500 rounded-full mr-3"></div> Quick Start Tips </h4><div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"><div class="flex items-start space-x-3"><div class="flex-shrink-0 h-6 w-6 bg-red-100 rounded-lg flex items-center justify-center mt-0.5"><span class="text-red-600 font-semibold text-xs">1</span></div><div><p class="font-medium text-gray-900">Define Scope</p><p class="text-gray-600">Set clear assessment boundaries and objectives</p></div></div><div class="flex items-start space-x-3"><div class="flex-shrink-0 h-6 w-6 bg-orange-100 rounded-lg flex items-center justify-center mt-0.5"><span class="text-orange-600 font-semibold text-xs">2</span></div><div><p class="font-medium text-gray-900">Identify Risks</p><p class="text-gray-600">Use multiple methodologies to identify risks</p></div></div><div class="flex items-start space-x-3"><div class="flex-shrink-0 h-6 w-6 bg-green-100 rounded-lg flex items-center justify-center mt-0.5"><span class="text-green-600 font-semibold text-xs">3</span></div><div><p class="font-medium text-gray-900">Assess &amp; Prioritize</p><p class="text-gray-600">Evaluate impact and likelihood for prioritization</p></div></div></div></div></div>',1))])):u.value.length===0?(v(),y("div",ra,[i(t(xs),{class:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s[38]||(s[38]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No assessments found",-1)),s[39]||(s[39]=e("p",{class:"text-gray-600 mb-6"}," Try adjusting your search or filter criteria to find the assessments you're looking for. ",-1)),e("div",na,[i(t(_),{variant:"solid",theme:"gray",onClick:x},{default:p(()=>[...s[37]||(s[37]=[w(" Clear Filters ",-1)])]),_:1})])])):J("",!0)]),i(t(Ee),{modelValue:n.value,"onUpdate:modelValue":s[11]||(s[11]=o=>n.value=o),title:"Assessment Templates",options:{size:"custom",width:"70vw"}},{body:p(()=>[e("div",da,[s[46]||(s[46]=e("div",{class:"bg-red-50 border border-red-200 rounded-lg p-4"},[e("p",{class:"text-red-800 text-sm"},[w("  "),e("strong",null,"Pro Tip:"),w(" Templates provide a structured starting point with predefined risk categories and assessment methodologies. ")])],-1)),e("div",ca,[e("div",ua,[e("div",ma,[e("div",pa,[i(t(pe),{class:"h-6 w-6 text-red-600"})]),s[40]||(s[40]=e("div",{class:"flex-1"},[e("h3",{class:"font-bold text-gray-900 text-lg mb-2 group-hover:text-red-900 transition-colors"},"Comprehensive Risk Assessment"),e("p",{class:"text-gray-600 text-sm leading-relaxed"},"Complete risk assessment covering all major risk categories")],-1))]),s[42]||(s[42]=e("div",{class:"mb-6"},[e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Includes:"),e("ul",{class:"text-sm text-gray-600 space-y-2"},[e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-red-400 rounded-full"}),e("span",null,"Strategic risks")]),e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-red-400 rounded-full"}),e("span",null,"Operational risks")]),e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-red-400 rounded-full"}),e("span",null,"Financial risks")]),e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-red-400 rounded-full"}),e("span",null,"Compliance risks")])])],-1)),i(t(_),{variant:"solid",theme:"red",size:"md",class:"w-full shadow-sm hover:shadow-md transition-shadow"},{prefix:p(()=>[i(t(Oe),{class:"h-4 w-4"})]),default:p(()=>[s[41]||(s[41]=w(" Use This Template ",-1))]),_:1})]),e("div",va,[e("div",ga,[e("div",fa,[i(t(Ne),{class:"h-6 w-6 text-orange-600"})]),s[43]||(s[43]=e("div",{class:"flex-1"},[e("h3",{class:"font-bold text-gray-900 text-lg mb-2 group-hover:text-orange-900 transition-colors"},"IT Risk Assessment"),e("p",{class:"text-gray-600 text-sm leading-relaxed"},"Technology-focused risk assessment with cybersecurity emphasis")],-1))]),s[45]||(s[45]=e("div",{class:"mb-6"},[e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Includes:"),e("ul",{class:"text-sm text-gray-600 space-y-2"},[e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-orange-400 rounded-full"}),e("span",null,"Cybersecurity risks")]),e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-orange-400 rounded-full"}),e("span",null,"Data privacy risks")]),e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-orange-400 rounded-full"}),e("span",null,"System availability risks")]),e("li",{class:"flex items-center space-x-2"},[e("div",{class:"h-1.5 w-1.5 bg-orange-400 rounded-full"}),e("span",null,"Technology change risks")])])],-1)),i(t(_),{variant:"solid",theme:"gray",size:"md",class:"w-full shadow-sm hover:shadow-md transition-shadow bg-orange-500 hover:bg-orange-600 text-white border-orange-500"},{prefix:p(()=>[i(t(Ne),{class:"h-4 w-4"})]),default:p(()=>[s[44]||(s[44]=w(" Use This Template ",-1))]),_:1})])])])]),_:1},8,["modelValue"]),i(t(Ee),{modelValue:V.value,"onUpdate:modelValue":s[12]||(s[12]=o=>V.value=o),title:"Bulk Actions",size:"xl"},{body:p(()=>[e("div",xa,[e("div",ba,[e("p",ya,[e("span",_a,r(S.value.length),1),s[47]||(s[47]=w(" assessment(s) selected for bulk action. ",-1))])]),e("div",ha,[e("div",ka,[i(t(_),{variant:"solid",theme:"green",class:"h-20 w-full",onClick:We},{default:p(()=>[e("div",wa,[i(t(Ye),{class:"h-5 w-5"}),s[48]||(s[48]=e("span",{class:"text-sm font-medium"},"Update Status",-1))])]),_:1})]),e("div",$a,[i(t(_),{variant:"solid",theme:"blue",class:"h-20 w-full",onClick:Ge},{default:p(()=>[e("div",Ca,[i(t(cs),{class:"h-5 w-5"}),s[49]||(s[49]=e("span",{class:"text-sm font-medium"},"Export Selected",-1))])]),_:1})]),e("div",Ra,[i(t(_),{variant:"solid",theme:"purple",class:"h-20 w-full",onClick:Xe},{default:p(()=>[e("div",Sa,[i(t(qe),{class:"h-5 w-5"}),s[50]||(s[50]=e("span",{class:"text-sm font-medium"},"Generate Reports",-1))])]),_:1})]),e("div",Aa,[i(t(_),{variant:"solid",theme:"red",class:"h-20 w-full",onClick:$e},{default:p(()=>[e("div",Va,[i(t(Es),{class:"h-5 w-5"}),s[51]||(s[51]=e("span",{class:"text-sm font-medium"},"Delete Selected",-1))])]),_:1})])])])]),_:1},8,["modelValue"]),i(t(Ee),{modelValue:U.value,"onUpdate:modelValue":s[13]||(s[13]=o=>U.value=o),title:"Risk Analytics Dashboard",size:"5xl"},{body:p(()=>[e("div",ja,[e("div",Da,[e("div",Ma,[s[55]||(s[55]=e("h3",{class:"text-lg font-semibold text-red-900 mb-4"},"Risk Distribution",-1)),e("div",Ta,[e("div",Fa,[s[52]||(s[52]=e("span",{class:"text-red-700"},"Critical Risks",-1)),e("span",Pa,r(ee.value),1)]),e("div",Ia,[s[53]||(s[53]=e("span",{class:"text-red-700"},"High Risks",-1)),e("span",Ua,r(ae.value),1)]),e("div",za,[s[54]||(s[54]=e("span",{class:"text-red-700"},"Medium Risks",-1)),e("span",La,r(fe.value),1)])])]),e("div",Ea,[s[59]||(s[59]=e("h3",{class:"text-lg font-semibold text-orange-900 mb-4"},"Assessment Progress",-1)),e("div",Oa,[e("div",qa,[s[56]||(s[56]=e("span",{class:"text-orange-700"},"Completed",-1)),e("span",Ba,r(ve.value),1)]),e("div",Na,[s[57]||(s[57]=e("span",{class:"text-orange-700"},"In Progress",-1)),e("span",Ya,r(re.value),1)]),e("div",Ha,[s[58]||(s[58]=e("span",{class:"text-orange-700"},"Planning",-1)),e("span",Qa,r(xe.value),1)])])]),e("div",Wa,[s[63]||(s[63]=e("h3",{class:"text-lg font-semibold text-purple-900 mb-4"},"Risk Trends",-1)),e("div",Ga,[e("div",Xa,[s[60]||(s[60]=e("span",{class:"text-purple-700"},"Average Score",-1)),e("span",Ja,r(se.value),1)]),e("div",Ka,[s[61]||(s[61]=e("span",{class:"text-purple-700"},"Trend",-1)),e("span",Za,r(we.value),1)]),e("div",er,[s[62]||(s[62]=e("span",{class:"text-purple-700"},"Top Category",-1)),e("span",sr,r(be.value),1)])])])]),s[64]||(s[64]=e("div",{class:"bg-white border border-gray-200 rounded-lg p-6"},[e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Risk Heat Map"),e("div",{class:"h-64 flex items-center justify-center bg-gray-50 rounded-lg"},[e("p",{class:"text-gray-500"},"Risk heat map visualization would be displayed here")])],-1))])]),_:1},8,["modelValue"]),i(_i,{modelValue:E.value,"onUpdate:modelValue":s[14]||(s[14]=o=>E.value=o),assessment:R.value,mode:f.value,onSubmit:Ce,onCancel:Je},null,8,["modelValue","assessment","mode"])]))}};export{nr as default};
//# sourceMappingURL=RiskAssessments-ihfrTXjy.js.map
