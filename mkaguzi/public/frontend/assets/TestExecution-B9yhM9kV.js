var Be=Object.defineProperty;var $e=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var Ce=(S,m,w)=>m in S?Be(S,m,{enumerable:!0,configurable:!0,writable:!0,value:w}):S[m]=w,fe=(S,m)=>{for(var w in m||(m={}))Ne.call(m,w)&&Ce(S,w,m[w]);if($e)for(var w of $e(m))Oe.call(m,w)&&Ce(S,w,m[w]);return S};var D=(S,m,w)=>new Promise((O,p)=>{var A=y=>{try{x(w.next(y))}catch(t){p(t)}},R=y=>{try{x(w.throw(y))}catch(t){p(t)}},x=y=>y.done?O(y.value):Promise.resolve(y.value).then(A,R);x((w=w.apply(S,m)).next())});import{b as N,L as ve,d as ce,a as I,c as W,e as Ie,I as xe,k as Te,D as Pe,l as je,m as z,_ as Qe,f as ze,i as Ee}from"./index-qIC3Tfxg.js";import{m as qe,a4 as le,$ as Ke,a3 as _e,o as ye,bf as He,n as Ge,af as We,aK as Xe,bg as De,T as Ze,D as Re,ao as Je,d as Ye,bh as et,_ as tt,F as st,bi as Ve,f as lt,ae as at,bj as ot,V as nt,b as Le,C as Ue,ad as it,k as rt,a9 as ke,a0 as Se,b6 as Fe,aO as dt}from"./icons-CtLkBOsu.js";import{b as Ae,w as he,j as E,l as P,p as h,q as e,H as j,s as o,u as b,v as n,y as q,z as F,A as c,F as pe,x as me,B as Z,C as Me,$ as be,r as T,ac as ne,ad as ie,Q as ut}from"./vue-DciwFjI_.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const ct={class:"bg-white rounded-xl border p-4"},pt={class:"flex flex-wrap items-center gap-4"},mt={class:"flex-1 min-w-[200px] max-w-md"},gt={class:"w-48"},vt={class:"w-36"},ft={class:"w-32"},_t={class:"w-36"},xt={class:"w-40"},yt={class:"w-40"},bt={class:"flex items-center gap-2 ml-auto"},ht={key:0,class:"flex flex-wrap items-center gap-2 mt-3 pt-3 border-t"},wt={__name:"ExecutionFilters",props:{filters:{type:Object,default:()=>({})}},emits:["update:filters","refresh","create"],setup(S,{emit:m}){const w=S,O=m,p=Ae({search:"",testLibrary:"",executionType:"",priority:"",status:"",dateFrom:"",dateTo:""});he(()=>w.filters,V=>{V&&Object.assign(p,V)},{immediate:!0,deep:!0});const A=[{label:"All Types",value:""},{label:"Manual",value:"Manual"},{label:"Scheduled",value:"Scheduled"},{label:"Batch",value:"Batch"},{label:"API",value:"API"}],R=[{label:"All Priorities",value:""},{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],x=[{label:"All Status",value:""},{label:"Pending",value:"Pending"},{label:"Queued",value:"Queued"},{label:"Running",value:"Running"},{label:"Completed",value:"Completed"},{label:"Failed",value:"Failed"},{label:"Cancelled",value:"Cancelled"},{label:"Paused",value:"Paused"}],y=E(()=>Object.values(p).some(V=>V!==""));function t(){O("update:filters",fe({},p))}function $(V){V==="dateRange"?(p.dateFrom="",p.dateTo=""):p[V]="",t()}function L(){Object.keys(p).forEach(V=>{p[V]=""}),t()}return(V,g)=>(h(),P("div",ct,[e("div",pt,[e("div",mt,[o(n(N),{modelValue:p.search,"onUpdate:modelValue":[g[0]||(g[0]=C=>p.search=C),t],type:"text",placeholder:"Search by name, ID, or test...",debounce:300},{prefix:b(()=>[o(n(qe),{class:"h-4 w-4 text-gray-400"})]),_:1},8,["modelValue"])]),e("div",gt,[o(ve,{modelValue:p.testLibrary,"onUpdate:modelValue":[g[1]||(g[1]=C=>p.testLibrary=C),t],doctype:"Audit Test Library",placeholder:"All Tests"},null,8,["modelValue"])]),e("div",vt,[o(n(ce),{modelValue:p.executionType,"onUpdate:modelValue":[g[2]||(g[2]=C=>p.executionType=C),t],options:A,placeholder:"All Types"},null,8,["modelValue"])]),e("div",ft,[o(n(ce),{modelValue:p.priority,"onUpdate:modelValue":[g[3]||(g[3]=C=>p.priority=C),t],options:R,placeholder:"Priority"},null,8,["modelValue"])]),e("div",_t,[o(n(ce),{modelValue:p.status,"onUpdate:modelValue":[g[4]||(g[4]=C=>p.status=C),t],options:x,placeholder:"All Status"},null,8,["modelValue"])]),e("div",xt,[o(n(N),{modelValue:p.dateFrom,"onUpdate:modelValue":[g[5]||(g[5]=C=>p.dateFrom=C),t],type:"date",placeholder:"From date"},null,8,["modelValue"])]),e("div",yt,[o(n(N),{modelValue:p.dateTo,"onUpdate:modelValue":[g[6]||(g[6]=C=>p.dateTo=C),t],type:"date",placeholder:"To date"},null,8,["modelValue"])]),e("div",bt,[y.value?(h(),q(n(I),{key:0,variant:"outline",onClick:L},{prefix:b(()=>[o(n(le),{class:"h-4 w-4"})]),default:b(()=>[g[15]||(g[15]=F(" Clear ",-1))]),_:1})):j("",!0),o(n(I),{variant:"outline",onClick:g[7]||(g[7]=C=>V.$emit("refresh"))},{prefix:b(()=>[o(n(Ke),{class:"h-4 w-4"})]),default:b(()=>[g[16]||(g[16]=F(" Refresh ",-1))]),_:1}),o(n(I),{variant:"solid",onClick:g[8]||(g[8]=C=>V.$emit("create"))},{prefix:b(()=>[o(n(_e),{class:"h-4 w-4"})]),default:b(()=>[g[17]||(g[17]=F(" New Execution ",-1))]),_:1})])]),y.value?(h(),P("div",ht,[g[18]||(g[18]=e("span",{class:"text-xs text-gray-500"},"Active filters:",-1)),p.search?(h(),q(n(W),{key:0,theme:"blue",class:"cursor-pointer",onClick:g[9]||(g[9]=C=>$("search"))},{default:b(()=>[F(' Search: "'+c(p.search)+'" ',1),o(n(le),{class:"h-3 w-3 ml-1"})]),_:1})):j("",!0),p.testLibrary?(h(),q(n(W),{key:1,theme:"purple",class:"cursor-pointer",onClick:g[10]||(g[10]=C=>$("testLibrary"))},{default:b(()=>[F(" Test: "+c(p.testLibrary)+" ",1),o(n(le),{class:"h-3 w-3 ml-1"})]),_:1})):j("",!0),p.executionType?(h(),q(n(W),{key:2,theme:"indigo",class:"cursor-pointer",onClick:g[11]||(g[11]=C=>$("executionType"))},{default:b(()=>[F(" Type: "+c(p.executionType)+" ",1),o(n(le),{class:"h-3 w-3 ml-1"})]),_:1})):j("",!0),p.priority?(h(),q(n(W),{key:3,theme:"orange",class:"cursor-pointer",onClick:g[12]||(g[12]=C=>$("priority"))},{default:b(()=>[F(" Priority: "+c(p.priority)+" ",1),o(n(le),{class:"h-3 w-3 ml-1"})]),_:1})):j("",!0),p.status?(h(),q(n(W),{key:4,theme:"green",class:"cursor-pointer",onClick:g[13]||(g[13]=C=>$("status"))},{default:b(()=>[F(" Status: "+c(p.status)+" ",1),o(n(le),{class:"h-3 w-3 ml-1"})]),_:1})):j("",!0),p.dateFrom||p.dateTo?(h(),q(n(W),{key:5,theme:"gray",class:"cursor-pointer",onClick:g[14]||(g[14]=C=>$("dateRange"))},{default:b(()=>[F(" Date: "+c(p.dateFrom||"*")+" - "+c(p.dateTo||"*")+" ",1),o(n(le),{class:"h-3 w-3 ml-1"})]),_:1})):j("",!0)])):j("",!0)]))}},$t={class:"space-y-4"},Ct={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4"},Tt=["onClick"],Et={class:"flex items-center gap-3"},Vt={class:"text-2xl font-bold text-gray-900"},kt={class:"text-xs text-gray-500"},St={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ft={class:"bg-white rounded-xl border p-4"},Pt={class:"space-y-3"},Dt=["onClick"],Rt={class:"flex-1 text-sm text-gray-600"},Lt={class:"text-sm font-medium text-gray-700"},Ut={class:"w-20 bg-gray-100 rounded-full h-2"},At={class:"bg-white rounded-xl border p-4"},Mt={class:"flex items-center justify-center"},Bt={class:"relative h-40 w-40"},Nt={viewBox:"0 0 36 36",class:"transform -rotate-90"},Ot=["stroke-dasharray"],It=["stroke-dasharray","stroke-dashoffset"],jt={class:"absolute inset-0 flex flex-col items-center justify-center"},Qt={class:"text-2xl font-bold text-gray-900"},zt={class:"flex justify-center gap-6 mt-4"},qt={class:"flex items-center gap-2"},Kt={class:"text-sm text-gray-600"},Ht={class:"flex items-center gap-2"},Gt={class:"text-sm text-gray-600"},Wt={class:"flex items-center gap-2"},Xt={class:"text-sm text-gray-600"},Zt={class:"bg-white rounded-xl border p-4"},Jt={class:"space-y-4"},Yt={class:"flex items-center justify-between"},es={class:"flex items-center gap-2"},ts={class:"text-sm font-semibold text-gray-900"},ss={class:"flex items-center justify-between"},ls={class:"flex items-center gap-2"},as={class:"text-sm font-semibold text-gray-900"},os={class:"flex items-center justify-between"},ns={class:"flex items-center gap-2"},is={class:"text-sm font-semibold text-red-600"},rs={class:"flex items-center justify-between"},ds={class:"flex items-center gap-2"},us={class:"text-sm font-semibold text-gray-900"},cs={class:"bg-white rounded-xl border p-4"},ps={class:"flex items-center gap-2 overflow-x-auto pb-2"},ms=["onClick"],gs={class:"flex items-center justify-between mb-2"},vs={class:"text-xs text-gray-500"},fs={class:"text-sm font-medium text-gray-800 truncate"},_s={class:"text-xs text-gray-500 mt-1"},xs={key:0,class:"text-sm text-gray-500 py-4"},ys={__name:"ExecutionStats",props:{executions:{type:Array,default:()=>[]},activeFilter:{type:String,default:""}},emits:["filter","select"],setup(S){const m=S,w=E(()=>{const d=m.executions,u=d.length,f=d.filter(B=>B.status==="Pending").length,U=d.filter(B=>B.status==="Running").length,M=d.filter(B=>B.status==="Completed").length,X=d.filter(B=>B.status==="Failed").length,K=d.filter(B=>B.status==="Queued").length,H=d.filter(B=>B.status==="Paused").length;return[{label:"Total",value:u,icon:_e,bgColor:"bg-blue-100",iconColor:"text-blue-600",filterKey:null,filterValue:null},{label:"Pending",value:f,icon:ye,bgColor:"bg-gray-100",iconColor:"text-gray-600",filterKey:"status",filterValue:"Pending",active:m.activeFilter==="Pending"},{label:"Queued",value:K,icon:He,bgColor:"bg-indigo-100",iconColor:"text-indigo-600",filterKey:"status",filterValue:"Queued",active:m.activeFilter==="Queued"},{label:"Running",value:U,icon:_e,bgColor:"bg-blue-100",iconColor:"text-blue-600",filterKey:"status",filterValue:"Running",active:m.activeFilter==="Running"},{label:"Completed",value:M,icon:Ge,bgColor:"bg-green-100",iconColor:"text-green-600",filterKey:"status",filterValue:"Completed",active:m.activeFilter==="Completed"},{label:"Failed",value:X,icon:We,bgColor:"bg-red-100",iconColor:"text-red-600",filterKey:"status",filterValue:"Failed",active:m.activeFilter==="Failed"},{label:"Paused",value:H,icon:Xe,bgColor:"bg-yellow-100",iconColor:"text-yellow-600",filterKey:"status",filterValue:"Paused",active:m.activeFilter==="Paused"}]}),O=E(()=>{const d=m.executions,u=d.length||1,f=["Pending","Queued","Running","Completed","Failed","Cancelled","Paused"],U={Pending:{dot:"bg-gray-400",bar:"bg-gray-400"},Queued:{dot:"bg-indigo-400",bar:"bg-indigo-400"},Running:{dot:"bg-blue-500",bar:"bg-blue-500"},Completed:{dot:"bg-green-500",bar:"bg-green-500"},Failed:{dot:"bg-red-500",bar:"bg-red-500"},Cancelled:{dot:"bg-gray-500",bar:"bg-gray-500"},Paused:{dot:"bg-yellow-500",bar:"bg-yellow-500"}};return f.map(M=>{var X,K;return{name:M,count:d.filter(H=>H.status===M).length,percentage:Math.round(d.filter(H=>H.status===M).length/u*100),dotColor:((X=U[M])==null?void 0:X.dot)||"bg-gray-400",barColor:((K=U[M])==null?void 0:K.bar)||"bg-gray-400"}}).filter(M=>M.count>0)}),p=E(()=>m.executions.reduce((d,u)=>d+(u.total_tests||0),0)),A=E(()=>m.executions.reduce((d,u)=>d+(u.passed_tests||0),0)),R=E(()=>m.executions.reduce((d,u)=>d+(u.failed_tests||0),0)),x=E(()=>m.executions.reduce((d,u)=>d+(u.warning_tests||0),0)),y=E(()=>p.value?Math.round(A.value/p.value*100):0),t=E(()=>p.value?Math.round(R.value/p.value*100):0),$=E(()=>{const d=m.executions.filter(f=>f.execution_time_ms);if(!d.length)return"0ms";const u=d.reduce((f,U)=>f+U.execution_time_ms,0)/d.length;return u<1e3?`${Math.round(u)}ms`:u<6e4?`${(u/1e3).toFixed(1)}s`:`${(u/6e4).toFixed(1)}m`}),L=E(()=>{const d=m.executions.filter(u=>u.records_per_second);return d.length?Math.round(d.reduce((u,f)=>u+f.records_per_second,0)/d.length):0}),V=E(()=>m.executions.reduce((d,u)=>d+(u.exceptions_found||0),0)),g=E(()=>m.executions.reduce((d,u)=>d+(u.total_records_processed||0),0)),C=E(()=>[...m.executions].sort((d,u)=>new Date(u.creation)-new Date(d.creation)).slice(0,5));function ee(d){return d>=1e6?`${(d/1e6).toFixed(1)}M`:d>=1e3?`${(d/1e3).toFixed(1)}K`:d.toString()}function Q(d){return d?new Date(d).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}function ae(d){return{Pending:"gray",Queued:"blue",Running:"blue",Completed:"green",Failed:"red",Cancelled:"gray",Paused:"orange"}[d]||"gray"}function J(d){return{Pending:"bg-gray-50 border-gray-200",Queued:"bg-indigo-50 border-indigo-200",Running:"bg-blue-50 border-blue-200",Completed:"bg-green-50 border-green-200",Failed:"bg-red-50 border-red-200",Cancelled:"bg-gray-50 border-gray-200",Paused:"bg-yellow-50 border-yellow-200"}[d]||"bg-gray-50 border-gray-200"}return(d,u)=>(h(),P("div",$t,[e("div",Ct,[(h(!0),P(pe,null,me(w.value,f=>(h(),P("div",{key:f.label,class:Z(["bg-white rounded-xl border p-4 hover:shadow-md transition-shadow cursor-pointer",f.active?"ring-2 ring-blue-500":""]),onClick:U=>d.$emit("filter",f.filterKey,f.filterValue)},[e("div",Et,[e("div",{class:Z(["p-2 rounded-lg",f.bgColor])},[(h(),q(Me(f.icon),{class:Z(["h-5 w-5",f.iconColor])},null,8,["class"]))],2),e("div",null,[e("div",Vt,c(f.value),1),e("div",kt,c(f.label),1)])])],10,Tt))),128))]),e("div",St,[e("div",Ft,[u[0]||(u[0]=e("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"Status Distribution",-1)),e("div",Pt,[(h(!0),P(pe,null,me(O.value,f=>(h(),P("div",{key:f.name,class:"flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-1 rounded",onClick:U=>d.$emit("filter","status",f.name)},[e("div",{class:Z(["w-3 h-3 rounded-full",f.dotColor])},null,2),e("div",Rt,c(f.name),1),e("div",Lt,c(f.count),1),e("div",Ut,[e("div",{class:Z(["h-2 rounded-full",f.barColor]),style:be({width:`${f.percentage}%`})},null,6)])],8,Dt))),128))])]),e("div",At,[u[6]||(u[6]=e("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"Test Results Summary",-1)),e("div",Mt,[e("div",Bt,[(h(),P("svg",Nt,[u[1]||(u[1]=e("circle",{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:"#E5E7EB","stroke-width":"3"},null,-1)),e("circle",{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:"#22C55E","stroke-width":"3","stroke-dasharray":`${y.value} ${100-y.value}`,"stroke-linecap":"round"},null,8,Ot),e("circle",{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:"#EF4444","stroke-width":"3","stroke-dasharray":`${t.value} ${100-t.value}`,"stroke-dashoffset":`${-y.value}`,"stroke-linecap":"round"},null,8,It)])),e("div",jt,[e("div",Qt,c(p.value),1),u[2]||(u[2]=e("div",{class:"text-xs text-gray-500"},"Total Tests",-1))])])]),e("div",zt,[e("div",qt,[u[3]||(u[3]=e("div",{class:"w-3 h-3 rounded-full bg-green-500"},null,-1)),e("span",Kt,"Pass: "+c(A.value),1)]),e("div",Ht,[u[4]||(u[4]=e("div",{class:"w-3 h-3 rounded-full bg-red-500"},null,-1)),e("span",Gt,"Fail: "+c(R.value),1)]),e("div",Wt,[u[5]||(u[5]=e("div",{class:"w-3 h-3 rounded-full bg-yellow-500"},null,-1)),e("span",Xt,"Warn: "+c(x.value),1)])])]),e("div",Zt,[u[11]||(u[11]=e("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"Performance Overview",-1)),e("div",Jt,[e("div",Yt,[e("div",es,[o(n(ye),{class:"h-4 w-4 text-gray-400"}),u[7]||(u[7]=e("span",{class:"text-sm text-gray-600"},"Avg Duration",-1))]),e("span",ts,c($.value),1)]),e("div",ss,[e("div",ls,[o(n(De),{class:"h-4 w-4 text-gray-400"}),u[8]||(u[8]=e("span",{class:"text-sm text-gray-600"},"Throughput",-1))]),e("span",as,c(L.value)+" rec/s",1)]),e("div",os,[e("div",ns,[o(n(Ze),{class:"h-4 w-4 text-gray-400"}),u[9]||(u[9]=e("span",{class:"text-sm text-gray-600"},"Total Exceptions",-1))]),e("span",is,c(V.value),1)]),e("div",rs,[e("div",ds,[o(n(Re),{class:"h-4 w-4 text-gray-400"}),u[10]||(u[10]=e("span",{class:"text-sm text-gray-600"},"Records Processed",-1))]),e("span",us,c(ee(g.value)),1)])])])]),e("div",cs,[u[12]||(u[12]=e("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"Recent Executions",-1)),e("div",ps,[(h(!0),P(pe,null,me(C.value,f=>(h(),P("div",{key:f.name,class:Z(["flex-shrink-0 p-3 rounded-lg border cursor-pointer hover:shadow-sm transition-shadow min-w-[200px]",J(f.status)]),onClick:U=>d.$emit("select",f)},[e("div",gs,[o(n(W),{theme:ae(f.status)},{default:b(()=>[F(c(f.status),1)]),_:2},1032,["theme"]),e("span",vs,c(Q(f.creation)),1)]),e("div",fs,c(f.execution_name),1),e("div",_s,c(f.test_library_reference),1)],10,ms))),128)),C.value.length?j("",!0):(h(),P("div",xs," No recent executions "))])])]))}},bs={class:"flex h-[75vh]"},hs={class:"w-56 border-r bg-gray-50 p-4 flex flex-col"},ws={class:"space-y-1 flex-1"},$s=["onClick"],Cs={class:"text-sm"},Ts={class:"mt-4 pt-4 border-t"},Es={class:"text-xs text-gray-500 mb-2"},Vs={class:"w-full bg-gray-200 rounded-full h-2"},ks={class:"flex-1 flex flex-col overflow-hidden"},Ss={class:"flex-1 overflow-y-auto p-6"},Fs={class:"space-y-4"},Ps={class:"grid grid-cols-3 gap-4"},Ds={class:"grid grid-cols-3 gap-4"},Rs={class:"space-y-4"},Ls={class:"grid grid-cols-2 gap-4"},Us={class:"grid grid-cols-2 gap-4"},As={class:"grid grid-cols-2 gap-4"},Ms={class:"flex items-center gap-3"},Bs={class:"flex-1 bg-gray-200 rounded-full h-3"},Ns={class:"text-sm font-medium"},Os={class:"space-y-4"},Is={class:"space-y-4"},js={class:"grid grid-cols-4 gap-4"},Qs={class:"p-4 bg-blue-50 rounded-lg border border-blue-200"},zs={class:"text-2xl font-bold text-blue-700"},qs={class:"p-4 bg-green-50 rounded-lg border border-green-200"},Ks={class:"text-2xl font-bold text-green-700"},Hs={class:"p-4 bg-red-50 rounded-lg border border-red-200"},Gs={class:"text-2xl font-bold text-red-700"},Ws={class:"p-4 bg-yellow-50 rounded-lg border border-yellow-200"},Xs={class:"text-2xl font-bold text-yellow-700"},Zs={class:"grid grid-cols-3 gap-4"},Js={class:"mt-6"},Ys={class:"space-y-4"},el={class:"mt-4"},tl={class:"space-y-4"},sl={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},ll={class:"flex items-start gap-3"},al={class:"grid grid-cols-3 gap-4"},ol={class:"p-4 bg-white rounded-lg border"},nl={class:"flex items-center gap-2 mb-2"},il={class:"text-2xl font-bold text-gray-900"},rl={class:"p-4 bg-white rounded-lg border"},dl={class:"flex items-center gap-2 mb-2"},ul={class:"text-2xl font-bold text-gray-900"},cl={class:"p-4 bg-white rounded-lg border"},pl={class:"flex items-center gap-2 mb-2"},ml={class:"text-2xl font-bold text-gray-900"},gl={class:"grid grid-cols-2 gap-4"},vl={class:"p-4 bg-white rounded-lg border"},fl={class:"flex items-center gap-2 mb-2"},_l={class:"text-2xl font-bold text-gray-900"},xl={class:"p-4 bg-white rounded-lg border"},yl={class:"flex items-center gap-2 mb-2"},bl={class:"text-2xl font-bold text-gray-900"},hl={class:"space-y-4"},wl={class:"grid grid-cols-2 gap-4"},$l={class:"grid grid-cols-2 gap-4"},Cl={class:"grid grid-cols-2 gap-4"},Tl={class:"border-t bg-gray-50 px-6 py-4 flex items-center justify-between"},El={class:"flex items-center gap-2"},Vl={__name:"TestExecutionForm",props:{show:{type:Boolean,default:!1},execution:{type:Object,default:null}},emits:["update:show","saved"],setup(S,{emit:m}){const w=S,O=m,p=E({get:()=>w.show,set:_=>O("update:show",_)}),A=E(()=>{var _;return!!((_=w.execution)!=null&&_.name)}),R=T(!1),x=T(0),y=[{id:"basic",title:"Basic Information",icon:Je,description:"Execution identification and configuration"},{id:"schedule",title:"Schedule",icon:Ye,description:"Execution timing and progress"},{id:"parameters",title:"Parameters",icon:et,description:"Test execution parameters"},{id:"results",title:"Results",icon:tt,description:"Test results and findings"},{id:"logs",title:"Logs",icon:st,description:"Execution logs and errors"},{id:"performance",title:"Performance",icon:Ve,description:"Performance metrics"},{id:"audit",title:"Audit Trail",icon:lt,description:"Audit information and notes"}],t=Ae({execution_id:"",execution_name:"",test_library_reference:"",execution_type:"Manual",priority:"Medium",status:"Pending",scheduled_start_date:"",scheduled_end_date:"",actual_start_date:"",actual_end_date:"",duration_seconds:0,progress_percentage:0,execution_parameters:[],test_results:[],result_summary:!0,total_tests:0,passed_tests:0,failed_tests:0,warning_tests:0,total_records_processed:0,exceptions_found:0,critical_findings:0,execution_logs:[],error_details:"",performance_metrics:!0,execution_time_ms:0,memory_usage_mb:0,cpu_usage_percent:0,records_per_second:0,queries_executed:0,created_by:"",creation_date:"",approved_by:"",approval_date:"",last_modified_by:"",last_modified_date:"",notes:""}),$=[{label:"Manual",value:"Manual"},{label:"Scheduled",value:"Scheduled"},{label:"Batch",value:"Batch"},{label:"API",value:"API"}],L=[{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],V=[{label:"Pending",value:"Pending"},{label:"Queued",value:"Queued"},{label:"Running",value:"Running"},{label:"Completed",value:"Completed"},{label:"Failed",value:"Failed"},{label:"Cancelled",value:"Cancelled"},{label:"Paused",value:"Paused"}],g=[{label:"String",value:"String"},{label:"Integer",value:"Integer"},{label:"Float",value:"Float"},{label:"Date",value:"Date"},{label:"Boolean",value:"Boolean"}],C=[{label:"DEBUG",value:"DEBUG"},{label:"INFO",value:"INFO"},{label:"WARNING",value:"WARNING"},{label:"ERROR",value:"ERROR"},{label:"SUCCESS",value:"SUCCESS"}],ee=[{key:"parameter_name",label:"Parameter Name",fieldType:"text",width:"150px",required:!0},{key:"parameter_value",label:"Value",fieldType:"text",width:"120px",required:!0},{key:"parameter_type",label:"Type",fieldType:"select",width:"100px",options:g,required:!0},{key:"description",label:"Description",fieldType:"text",width:"200px"}],Q=[{key:"test_name",label:"Test Name",fieldType:"text",width:"150px",required:!0},{key:"status",label:"Status",fieldType:"select",width:"100px",options:resultStatusOptions,required:!0},{key:"exception_count",label:"Exceptions",fieldType:"int",width:"100px"},{key:"message",label:"Message",fieldType:"text",width:"200px"}],ae=[{key:"timestamp",label:"Timestamp",fieldType:"datetime",width:"150px",required:!0},{key:"level",label:"Level",fieldType:"select",width:"100px",options:C,required:!0},{key:"message",label:"Message",fieldType:"text",width:"250px",required:!0}];he(()=>w.execution,_=>{_?Object.keys(t).forEach(l=>{_[l]!==void 0&&(t[l]=_[l])}):re()},{immediate:!0});const J=E(()=>[!!(t.execution_name&&t.test_library_reference&&t.execution_type&&t.status),!0,!0,!0,!0,!0,!0]),d=E(()=>J.value.filter(Boolean).length),u=E(()=>Math.round(d.value/y.length*100));function f(_){return J.value[_]}function U(_){return x.value===_?"text-blue-600":f(_)?"text-green-500":"text-gray-400"}function M(_){x.value=_}function X(){x.value<y.length-1&&x.value++}function K(){x.value>0&&x.value--}function H(_){return _>=100?"bg-green-500":_>=50?"bg-blue-500":_>0?"bg-yellow-500":"bg-gray-300"}function B(_){return _?_<1e3?`${_}ms`:_<6e4?`${(_/1e3).toFixed(2)}s`:`${(_/6e4).toFixed(2)}m`:"0ms"}function re(){Object.keys(t).forEach(_=>{Array.isArray(t[_])?t[_]=[]:typeof t[_]=="number"?t[_]=0:typeof t[_]=="boolean"?t[_]=!0:t[_]=""}),t.execution_type="Manual",t.priority="Medium",t.status="Pending",x.value=0}function de(){O("update:show",!1),re()}function ue(){return D(this,null,function*(){R.value=!0;try{console.log("Saving execution:",t),O("saved",fe({},t)),de()}catch(_){console.error("Error saving execution:",_)}finally{R.value=!1}})}return(_,l)=>(h(),q(n(Pe),{modelValue:p.value,"onUpdate:modelValue":l[25]||(l[25]=te=>p.value=te),options:{title:A.value?"Edit Test Execution":"New Test Execution",size:"7xl"}},{"body-content":b(()=>{var te,se,oe;return[e("div",bs,[e("div",hs,[e("div",ws,[(h(),P(pe,null,me(y,(a,s)=>e("button",{key:a.id,onClick:v=>M(s),class:Z(["w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors",x.value===s?"bg-blue-100 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-100"])},[(h(),q(Me(a.icon),{class:Z(["h-4 w-4",U(s)])},null,8,["class"])),e("span",Cs,c(a.title),1),f(s)?(h(),q(n(at),{key:0,class:"h-4 w-4 ml-auto text-green-500"})):j("",!0)],10,$s)),64))]),e("div",Ts,[e("div",Es," Progress: "+c(d.value)+"/"+c(y.length)+" sections ",1),e("div",Vs,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all",style:be({width:`${u.value}%`})},null,4)])])]),e("div",ks,[o(Ie,{icon:(te=y[x.value])==null?void 0:te.icon,title:(se=y[x.value])==null?void 0:se.title,description:(oe=y[x.value])==null?void 0:oe.description},null,8,["icon","title","description"]),e("div",Ss,[ne(e("div",Fs,[e("div",Ps,[o(n(N),{modelValue:t.execution_id,"onUpdate:modelValue":l[0]||(l[0]=a=>t.execution_id=a),label:"Execution ID",type:"text",placeholder:"Auto-generated",disabled:""},null,8,["modelValue"]),o(n(N),{modelValue:t.execution_name,"onUpdate:modelValue":l[1]||(l[1]=a=>t.execution_name=a),label:"Execution Name *",type:"text",placeholder:"Enter execution name"},null,8,["modelValue"]),e("div",null,[l[26]||(l[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Test Library *",-1)),o(ve,{modelValue:t.test_library_reference,"onUpdate:modelValue":l[2]||(l[2]=a=>t.test_library_reference=a),doctype:"Audit Test Library",placeholder:"Select test"},null,8,["modelValue"])])]),e("div",Ds,[e("div",null,[l[27]||(l[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Execution Type *",-1)),o(n(ce),{modelValue:t.execution_type,"onUpdate:modelValue":l[3]||(l[3]=a=>t.execution_type=a),options:$,placeholder:"Select type"},null,8,["modelValue"])]),e("div",null,[l[28]||(l[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),o(n(ce),{modelValue:t.priority,"onUpdate:modelValue":l[4]||(l[4]=a=>t.priority=a),options:L,placeholder:"Select priority"},null,8,["modelValue"])]),e("div",null,[l[29]||(l[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status *",-1)),o(n(ce),{modelValue:t.status,"onUpdate:modelValue":l[5]||(l[5]=a=>t.status=a),options:V,placeholder:"Select status"},null,8,["modelValue"])])])],512),[[ie,x.value===0]]),ne(e("div",Rs,[e("div",Ls,[o(n(N),{modelValue:t.scheduled_start_date,"onUpdate:modelValue":l[6]||(l[6]=a=>t.scheduled_start_date=a),label:"Scheduled Start Date",type:"datetime-local"},null,8,["modelValue"]),o(n(N),{modelValue:t.scheduled_end_date,"onUpdate:modelValue":l[7]||(l[7]=a=>t.scheduled_end_date=a),label:"Scheduled End Date",type:"datetime-local"},null,8,["modelValue"])]),e("div",Us,[o(n(N),{modelValue:t.actual_start_date,"onUpdate:modelValue":l[8]||(l[8]=a=>t.actual_start_date=a),label:"Actual Start Date",type:"datetime-local",disabled:""},null,8,["modelValue"]),o(n(N),{modelValue:t.actual_end_date,"onUpdate:modelValue":l[9]||(l[9]=a=>t.actual_end_date=a),label:"Actual End Date",type:"datetime-local",disabled:""},null,8,["modelValue"])]),e("div",As,[o(n(N),{modelValue:t.duration_seconds,"onUpdate:modelValue":l[10]||(l[10]=a=>t.duration_seconds=a),label:"Duration (Seconds)",type:"number",disabled:""},null,8,["modelValue"]),e("div",null,[l[30]||(l[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Progress",-1)),e("div",Ms,[e("div",Bs,[e("div",{class:Z(["h-3 rounded-full transition-all",H(t.progress_percentage)]),style:be({width:`${t.progress_percentage||0}%`})},null,6)]),e("span",Ns,c(t.progress_percentage||0)+"%",1)])])])],512),[[ie,x.value===1]]),ne(e("div",Os,[o(xe,{modelValue:t.execution_parameters,"onUpdate:modelValue":l[11]||(l[11]=a=>t.execution_parameters=a),title:"Execution Parameters",modalTitle:"Parameter",columns:ee,autoAddRow:!1},null,8,["modelValue"])],512),[[ie,x.value===2]]),ne(e("div",Is,[e("div",js,[e("div",Qs,[e("div",zs,c(t.total_tests||0),1),l[31]||(l[31]=e("div",{class:"text-sm text-blue-600"},"Total Tests",-1))]),e("div",qs,[e("div",Ks,c(t.passed_tests||0),1),l[32]||(l[32]=e("div",{class:"text-sm text-green-600"},"Passed",-1))]),e("div",Hs,[e("div",Gs,c(t.failed_tests||0),1),l[33]||(l[33]=e("div",{class:"text-sm text-red-600"},"Failed",-1))]),e("div",Ws,[e("div",Xs,c(t.warning_tests||0),1),l[34]||(l[34]=e("div",{class:"text-sm text-yellow-600"},"Warnings",-1))])]),e("div",Zs,[o(n(N),{modelValue:t.total_records_processed,"onUpdate:modelValue":l[12]||(l[12]=a=>t.total_records_processed=a),label:"Records Processed",type:"number",disabled:""},null,8,["modelValue"]),o(n(N),{modelValue:t.exceptions_found,"onUpdate:modelValue":l[13]||(l[13]=a=>t.exceptions_found=a),label:"Exceptions Found",type:"number",disabled:""},null,8,["modelValue"]),o(n(N),{modelValue:t.critical_findings,"onUpdate:modelValue":l[14]||(l[14]=a=>t.critical_findings=a),label:"Critical Findings",type:"number",disabled:""},null,8,["modelValue"])]),e("div",Js,[o(xe,{modelValue:t.test_results,"onUpdate:modelValue":l[15]||(l[15]=a=>t.test_results=a),title:"Detailed Results",modalTitle:"Test Result",columns:Q,autoAddRow:!1},null,8,["modelValue"])])],512),[[ie,x.value===3]]),ne(e("div",Ys,[o(xe,{modelValue:t.execution_logs,"onUpdate:modelValue":l[16]||(l[16]=a=>t.execution_logs=a),title:"Execution Logs",modalTitle:"Log Entry",columns:ae,autoAddRow:!1},null,8,["modelValue"]),e("div",el,[l[35]||(l[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Error Details",-1)),o(n(Te),{modelValue:t.error_details,"onUpdate:modelValue":l[17]||(l[17]=a=>t.error_details=a),content:t.error_details,placeholder:"Error details will appear here if any errors occur...","editor-class":"prose-sm max-w-none min-h-[100px]",bubbleMenu:!0},null,8,["modelValue","content"])])],512),[[ie,x.value===4]]),ne(e("div",tl,[e("div",sl,[e("div",ll,[o(n(Ve),{class:"h-5 w-5 text-blue-600 mt-0.5"}),l[36]||(l[36]=e("div",{class:"text-sm text-blue-700"},[e("p",{class:"font-medium"},"Performance Metrics"),e("p",null,"These metrics are automatically captured during test execution.")],-1))])]),e("div",al,[e("div",ol,[e("div",nl,[o(n(ye),{class:"h-5 w-5 text-gray-400"}),l[37]||(l[37]=e("span",{class:"text-sm text-gray-600"},"Execution Time",-1))]),e("div",il,c(B(t.execution_time_ms)),1)]),e("div",rl,[e("div",dl,[o(n(ot),{class:"h-5 w-5 text-gray-400"}),l[38]||(l[38]=e("span",{class:"text-sm text-gray-600"},"Memory Usage",-1))]),e("div",ul,c(t.memory_usage_mb||0)+" MB ",1)]),e("div",cl,[e("div",pl,[o(n(nt),{class:"h-5 w-5 text-gray-400"}),l[39]||(l[39]=e("span",{class:"text-sm text-gray-600"},"CPU Usage",-1))]),e("div",ml,c(t.cpu_usage_percent||0)+"% ",1)])]),e("div",gl,[e("div",vl,[e("div",fl,[o(n(De),{class:"h-5 w-5 text-gray-400"}),l[40]||(l[40]=e("span",{class:"text-sm text-gray-600"},"Throughput",-1))]),e("div",_l,[F(c(t.records_per_second||0)+" ",1),l[41]||(l[41]=e("span",{class:"text-sm font-normal text-gray-500"},"records/sec",-1))])]),e("div",xl,[e("div",yl,[o(n(Re),{class:"h-5 w-5 text-gray-400"}),l[42]||(l[42]=e("span",{class:"text-sm text-gray-600"},"Queries Executed",-1))]),e("div",bl,c(t.queries_executed||0),1)])])],512),[[ie,x.value===5]]),ne(e("div",hl,[e("div",wl,[e("div",null,[l[43]||(l[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Created By",-1)),o(ve,{modelValue:t.created_by,"onUpdate:modelValue":l[18]||(l[18]=a=>t.created_by=a),doctype:"User",placeholder:"Auto-filled",disabled:""},null,8,["modelValue"])]),o(n(N),{modelValue:t.creation_date,"onUpdate:modelValue":l[19]||(l[19]=a=>t.creation_date=a),label:"Creation Date",type:"datetime-local",disabled:""},null,8,["modelValue"])]),e("div",$l,[e("div",null,[l[44]||(l[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Approved By",-1)),o(ve,{modelValue:t.approved_by,"onUpdate:modelValue":l[20]||(l[20]=a=>t.approved_by=a),doctype:"User",placeholder:"Select approver"},null,8,["modelValue"])]),o(n(N),{modelValue:t.approval_date,"onUpdate:modelValue":l[21]||(l[21]=a=>t.approval_date=a),label:"Approval Date",type:"datetime-local"},null,8,["modelValue"])]),e("div",Cl,[e("div",null,[l[45]||(l[45]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Last Modified By",-1)),o(ve,{modelValue:t.last_modified_by,"onUpdate:modelValue":l[22]||(l[22]=a=>t.last_modified_by=a),doctype:"User",placeholder:"Auto-filled",disabled:""},null,8,["modelValue"])]),o(n(N),{modelValue:t.last_modified_date,"onUpdate:modelValue":l[23]||(l[23]=a=>t.last_modified_date=a),label:"Last Modified Date",type:"datetime-local",disabled:""},null,8,["modelValue"])]),e("div",null,[l[46]||(l[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),o(n(Te),{modelValue:t.notes,"onUpdate:modelValue":l[24]||(l[24]=a=>t.notes=a),content:t.notes,placeholder:"Additional notes...","editor-class":"prose-sm max-w-none min-h-[120px]",bubbleMenu:!0},null,8,["modelValue","content"])])],512),[[ie,x.value===6]])]),e("div",Tl,[o(n(I),{variant:"outline",onClick:K,disabled:x.value===0},{prefix:b(()=>[o(n(Le),{class:"h-4 w-4"})]),default:b(()=>[l[47]||(l[47]=F(" Previous ",-1))]),_:1},8,["disabled"]),e("div",El,[o(n(I),{variant:"outline",onClick:de},{default:b(()=>[...l[48]||(l[48]=[F("Cancel",-1)])]),_:1}),x.value<y.length-1?(h(),q(n(I),{key:0,variant:"solid",onClick:X},{suffix:b(()=>[o(n(Ue),{class:"h-4 w-4"})]),default:b(()=>[l[49]||(l[49]=F(" Next ",-1))]),_:1})):(h(),q(n(I),{key:1,variant:"solid",theme:"green",onClick:ue,loading:R.value},{prefix:b(()=>[o(n(it),{class:"h-4 w-4"})]),default:b(()=>[F(" "+c(A.value?"Update Execution":"Create Execution"),1)]),_:1},8,["loading"]))])])])])]}),_:1},8,["modelValue","options"]))}},kl=je("testExecution",()=>{const S=T([]),m=T([]),w=T([]),O=T([]),p=T([]),A=T(null),R=T(!1),x=T(""),y=T([]),t=T([]),$=T({status:"",testLibrary:"",executionType:"",priority:"",dateFrom:"",dateTo:""}),L=T({pending:0,running:0,completed:0,failed:0,cancelled:0}),V=E(()=>S.value.filter(r=>r.execution_status==="Running"||r.execution_status==="Pending")),g=E(()=>S.value.filter(r=>r.execution_status==="Completed")),C=E(()=>S.value.filter(r=>r.execution_status==="Failed")),ee=E(()=>{const r={};return S.value.forEach(i=>{const k=i.execution_status||"Unknown";r[k]||(r[k]=[]),r[k].push(i)}),r}),Q=E(()=>{if(!A.value)return 0;const r=A.value.total_tests||1,i=A.value.completed_tests||0;return Math.round(i/r*100)}),ae=E(()=>{let r=S.value;if(x.value){const i=x.value.toLowerCase();r=r.filter(k=>{var Y,ge,we;return((Y=k.execution_name)==null?void 0:Y.toLowerCase().includes(i))||((ge=k.execution_id)==null?void 0:ge.toLowerCase().includes(i))||((we=k.test_library_name)==null?void 0:we.toLowerCase().includes(i))})}return $.value.status&&(r=r.filter(i=>i.execution_status===$.value.status)),$.value.testLibrary&&(r=r.filter(i=>i.test_library_id===$.value.testLibrary)),$.value.executionType&&(r=r.filter(i=>i.execution_type===$.value.executionType)),$.value.priority&&(r=r.filter(i=>i.priority_level===$.value.priority)),$.value.dateFrom&&(r=r.filter(i=>new Date(i.creation)>=new Date($.value.dateFrom))),$.value.dateTo&&(r=r.filter(i=>new Date(i.creation)<=new Date($.value.dateTo))),r}),J=r=>{x.value=r},d=()=>{x.value=""},u=r=>{Object.assign($.value,r)},f=()=>{$.value={status:"",testLibrary:"",executionType:"",priority:"",dateFrom:"",dateTo:""}},U=(...i)=>D(void 0,[...i],function*(r={}){R.value=!0;try{const k=yield z({url:"frappe.client.get_list",params:{doctype:"Test Execution",fields:["name","execution_id","execution_name","test_library_reference","execution_type","priority","status","actual_start_date","actual_end_date","duration_seconds","progress_percentage","total_tests","passed_tests","failed_tests","warning_tests","total_records_processed","exceptions_found","critical_findings","created_by","creation","modified"],filters:r,limit_page_length:1e3,order_by:"actual_start_date desc"}}).fetch();S.value=k||[],oe()}catch(k){console.error("Error fetching test executions:",k),S.value=[]}finally{R.value=!1}}),M=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.get",params:{doctype:"Test Execution",name:r}}).fetch();return A.value=i,i}catch(i){return console.error("Error fetching test execution details:",i),null}}),X=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.insert",params:{doc:fe({doctype:"Test Execution"},r)}}).fetch();return yield U(),i}catch(i){throw console.error("Error creating test execution:",i),i}}),K=(r,i)=>D(void 0,null,function*(){try{const k=yield z({url:"frappe.client.set_value",params:{doctype:"Test Execution",name:r,fieldname:i}}).fetch();return yield U(),k}catch(k){throw console.error("Error updating test execution:",k),k}}),H=r=>D(void 0,null,function*(){try{const i=yield z({url:"mkaguzi.api.test_execution.start_execution",params:{execution_id:r}}).fetch();return yield M(r),yield U(),i}catch(i){throw console.error("Error starting test execution:",i),i}}),B=r=>D(void 0,null,function*(){try{const i=yield z({url:"mkaguzi.api.test_execution.stop_execution",params:{execution_id:r}}).fetch();return yield M(r),yield U(),i}catch(i){throw console.error("Error stopping test execution:",i),i}}),re=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.get_list",params:{doctype:"Test Result",filters:{test_execution:r},fields:["name","test_id","test_name","result_status","actual_value","expected_value","variance","threshold_met","exception_count","result_summary","execution_time","started_at","completed_at"],limit_page_length:1e3,order_by:"started_at desc"}}).fetch();return m.value=i||[],i}catch(i){return console.error("Error fetching test results:",i),m.value=[],[]}}),de=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.get_list",params:{doctype:"Test Parameter",filters:{parent:r,parenttype:"Audit Test Library"},fields:["name","parameter_name","parameter_type","default_value","is_required","description","validation_rule"],limit_page_length:1e3}}).fetch();return w.value=i||[],i}catch(i){return console.error("Error fetching test parameters:",i),w.value=[],[]}}),ue=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.get_list",params:{doctype:"Test Threshold",filters:{parent:r,parenttype:"Audit Test Library"},fields:["name","threshold_name","threshold_type","operator","threshold_value","warning_threshold","critical_threshold","description"],limit_page_length:1e3}}).fetch();return O.value=i||[],i}catch(i){return console.error("Error fetching test thresholds:",i),O.value=[],[]}}),_=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.get_list",params:{doctype:"Execution Log",filters:{parent:r,parenttype:"Test Execution"},fields:["name","timestamp","log_level","message","step_name","duration_ms"],limit_page_length:1e3,order_by:"timestamp desc"}}).fetch();return p.value=i||[],i}catch(i){return console.error("Error fetching execution logs:",i),p.value=[],[]}}),l=r=>D(void 0,null,function*(){try{const i=yield z({url:"frappe.client.get_list",params:{doctype:"Analytical Procedure Result",filters:{test_execution:r},fields:["name","procedure_name","procedure_type","current_value","prior_value","budget_value","variance_amount","variance_percentage","significance_level","investigation_required","conclusion","completed_at"],limit_page_length:1e3}}).fetch();return t.value=i||[],i}catch(i){return console.error("Error fetching analytical procedure results:",i),t.value=[],[]}}),te=r=>D(void 0,null,function*(){try{return yield z({url:"mkaguzi.api.test_execution.run_analytical_procedure",params:r}).fetch()}catch(i){throw console.error("Error running analytical procedure:",i),i}}),se=(r,i="excel")=>D(void 0,null,function*(){try{return yield z({url:"mkaguzi.api.test_execution.export_results",params:{execution_id:r,format:i}}).fetch()}catch(k){throw console.error("Error exporting test results:",k),k}}),oe=()=>{const r={pending:0,running:0,completed:0,failed:0,cancelled:0};S.value.forEach(i=>{var Y;const k=((Y=i.status)==null?void 0:Y.toLowerCase())||"pending";r.hasOwnProperty(k)&&r[k]++}),L.value=r};return{testExecutions:S,testResults:m,testParameters:w,testThresholds:O,executionLogs:p,currentExecution:A,loading:R,searchQuery:x,filters:$,testLibraryTests:y,analyticalProcedures:t,executionStatuses:L,activeExecutions:V,completedExecutions:g,failedExecutions:C,executionsByStatus:ee,executionProgress:Q,filteredExecutions:ae,setSearchQuery:J,clearSearchQuery:d,setFilters:u,clearFilters:f,fetchTestExecutions:U,fetchTestExecutionDetails:M,createTestExecution:X,updateTestExecution:K,startTestExecution:H,stopTestExecution:B,fetchTestResults:re,fetchTestParameters:de,fetchTestThresholds:ue,fetchExecutionLogs:_,fetchAnalyticalProcedureResults:l,runAnalyticalProcedure:te,exportTestResults:se,getExecutionById:r=>S.value.find(i=>i.name===r),getExecutionsByEngagement:r=>S.value.filter(i=>i.audit_engagement===r),clearCurrentExecution:()=>{A.value=null,m.value=[],p.value=[],t.value=[]},calculateExecutionMetrics:r=>{if(!r)return null;const i=r.total_tests||0,k=r.completed_tests||0,Y=r.failed_tests||0,ge=k-Y;return{totalTests:i,completedTests:k,failedTests:Y,successfulTests:ge,successRate:i>0?Math.round(ge/i*100):0,completionRate:i>0?Math.round(k/i*100):0,failureRate:k>0?Math.round(Y/k*100):0}}}}),Sl={class:"test-execution-page"},Fl={class:"page-header"},Pl={class:"header-content"},Dl={class:"page-title"},Rl={class:"my-6"},Ll={class:"executions-section"},Ul={class:"table-container"},Al={class:"executions-table"},Ml={class:"checkbox-column"},Bl={class:"checkbox-column"},Nl={class:"execution-id"},Ol={class:"test-name"},Il={class:"category"},jl={class:"status"},Ql={class:"start-time"},zl={class:"duration"},ql={class:"executed-by"},Kl={class:"actions"},Hl={class:"action-buttons"},Gl={key:0,class:"empty-state"},Wl={key:1,class:"loading-state"},Xl={key:0,class:"pagination-section"},Zl={class:"pagination-info"},Jl={class:"pagination-controls"},Yl={class:"page-indicator"},ea={key:0,class:"execution-details"},ta={class:"details-grid"},sa={class:"detail-section"},la={class:"detail-rows"},aa={class:"detail-row"},oa={class:"detail-value"},na={class:"detail-row"},ia={class:"detail-value"},ra={class:"detail-row"},da={class:"detail-row"},ua={class:"detail-value"},ca={class:"detail-row"},pa={class:"detail-value"},ma={class:"detail-row"},ga={class:"detail-value"},va={class:"detail-row"},fa={class:"detail-value"},_a={class:"detail-section"},xa={key:0,class:"results-list"},ya={class:"result-header"},ba={class:"result-description"},ha={key:0,class:"result-error"},wa={key:1,class:"no-results"},$a={__name:"TestExecution",setup(S){const m=kl();ze();const w=T([]),O=T([]),p=T(!1);T(!1);const A=T(!1),R=T(!1),x=T(!1),y=T(null),t=T(null),$=T([]),L=T({status:"",search:"",testLibrary:"",executionType:"",priority:"",dateFrom:"",dateTo:""});T({type:"Manual",scheduleTime:"",priority:"Normal"});const V=T(1),g=T(20),C=T(0),ee=T(0);E(()=>({running:m.executionStatuses.running,completed:m.executionStatuses.completed,failed:m.executionStatuses.failed,total:m.testExecutions.length}));const Q=E(()=>{let a=m.testExecutions;if(L.value.status&&(a=a.filter(s=>s.status===L.value.status)),L.value.category&&(a=a.filter(s=>s.execution_type===L.value.category)),L.value.search){const s=L.value.search.toLowerCase();a=a.filter(v=>{var G,r;return((G=v.execution_name)==null?void 0:G.toLowerCase().includes(s))||((r=v.execution_id)==null?void 0:r.toLowerCase().includes(s))})}return a}),ae=E(()=>m.testLibraryTests);E(()=>ae.value.filter(a=>O.value.includes(a.name)));const J=E(()=>m.loading),d=()=>D(this,null,function*(){yield m.fetchTestExecutions()}),u=()=>D(this,null,function*(){console.log("Loading available tests...")}),f=a=>{Object.assign(L.value,a),V.value=1,d()},U=(a,s)=>{a&&s&&(L.value[a]=s,V.value=1,d())},M=a=>D(this,null,function*(){var s;try{(s=t.value)!=null&&s.name?yield m.updateTestExecution(t.value.name,a):yield m.createTestExecution(a),x.value=!1,t.value=null,yield d()}catch(v){console.error("Failed to save execution:",v)}}),X=()=>{p.value?w.value=Q.value.map(a=>a.name):w.value=[]},K=a=>D(this,null,function*(){y.value=a,R.value=!0;try{const s=yield m.fetchTestResults(a.name);$.value=s,yield m.fetchExecutionLogs(a.name)}catch(s){console.error("Failed to load execution results:",s),$.value=[]}}),H=a=>D(this,null,function*(){try{yield m.stopTestExecution(a.name)}catch(s){console.error("Failed to cancel execution:",s)}}),B=a=>D(this,null,function*(){try{const s=yield m.exportTestResults(a.name,"excel");s.download_url&&window.open(s.download_url,"_blank")}catch(s){console.error("Failed to download results:",s)}}),re=()=>{console.log("Download detailed results")},de=()=>D(this,null,function*(){yield d()}),ue=a=>{V.value=a,d()},_=a=>({Pending:"secondary",Running:"info",Completed:"success",Failed:"danger",Cancelled:"secondary"})[a]||"secondary",l=a=>({"Financial Controls":"blue","Operational Controls":"green",Compliance:"orange","Data Integrity":"purple",Performance:"cyan"})[a]||"gray",te=a=>({Passed:"green",Failed:"red",Warning:"orange"})[a]||"gray",se=a=>a?new Date(a).toLocaleString():"N/A",oe=a=>{if(!a.actual_start_date)return"N/A";const s=new Date(a.actual_start_date),G=(a.actual_end_date?new Date(a.actual_end_date):new Date)-s,r=Math.floor(G/6e4),i=Math.floor(G%6e4/1e3);return r>0?`${r}m ${i}s`:`${i}s`};return he(w,()=>{p.value=w.value.length===Q.value.length&&Q.value.length>0}),ut(()=>D(this,null,function*(){yield Promise.all([d(),u()])})),(a,s)=>(h(),P("div",Sl,[e("div",Fl,[e("div",Pl,[e("h1",Dl,[o(n(rt),{class:"title-icon"}),s[9]||(s[9]=F(" Test Execution ",-1))]),s[10]||(s[10]=e("p",{class:"page-description"}," Execute and monitor audit tests with real-time results and detailed reporting ",-1))])]),o(wt,{filters:L.value,"onUpdate:filters":f,onRefresh:de,onCreate:s[0]||(s[0]=v=>x.value=!0)},null,8,["filters"]),e("div",Rl,[o(ys,{executions:Q.value,activeFilter:L.value.status,onFilter:U,onSelect:K},null,8,["executions","activeFilter"])]),e("div",Ll,[e("div",Ul,[e("table",Al,[e("thead",null,[e("tr",null,[e("th",Ml,[o(n(Ee),{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=v=>p.value=v),onChange:X},null,8,["modelValue"])]),s[11]||(s[11]=e("th",null,"Execution ID",-1)),s[12]||(s[12]=e("th",null,"Test Name",-1)),s[13]||(s[13]=e("th",null,"Category",-1)),s[14]||(s[14]=e("th",null,"Status",-1)),s[15]||(s[15]=e("th",null,"Start Time",-1)),s[16]||(s[16]=e("th",null,"Duration",-1)),s[17]||(s[17]=e("th",null,"Executed By",-1)),s[18]||(s[18]=e("th",null,"Actions",-1))])]),e("tbody",null,[(h(!0),P(pe,null,me(Q.value,v=>(h(),P("tr",{key:v.name,class:Z({"selected-row":w.value.includes(v.name)})},[e("td",Bl,[o(n(Ee),{modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]=G=>w.value=G),value:v.name},null,8,["modelValue","value"])]),e("td",Nl,c(v.execution_id),1),e("td",Ol,c(v.execution_name),1),e("td",Il,[o(n(W),{variant:l(v.execution_type)},{default:b(()=>[F(c(v.execution_type),1)]),_:2},1032,["variant"])]),e("td",jl,[o(n(W),{variant:_(v.status)},{default:b(()=>[F(c(v.status),1)]),_:2},1032,["variant"])]),e("td",Ql,c(se(v.actual_start_date)),1),e("td",zl,c(oe(v)),1),e("td",ql,c(v.created_by),1),e("td",Kl,[e("div",Hl,[o(n(I),{variant:"ghost",size:"sm",onClick:G=>K(v),title:"View Details"},{default:b(()=>[o(n(ke))]),_:1},8,["onClick"]),o(n(I),{variant:"ghost",size:"sm",onClick:G=>B(v),disabled:v.status!=="Completed",title:"Download Results"},{default:b(()=>[o(n(Se))]),_:1},8,["onClick","disabled"]),o(n(I),{variant:"ghost",size:"sm",onClick:G=>H(v),disabled:v.status!=="Running",title:"Cancel Execution"},{default:b(()=>[o(n(le))]),_:1},8,["onClick","disabled"])])])],2))),128))])]),!Q.value.length&&!J.value?(h(),P("div",Gl,[o(n(Fe),{class:"empty-icon"}),s[20]||(s[20]=e("h3",null,"No Test Executions Found",-1)),s[21]||(s[21]=e("p",null,"Execute some tests to see results here.",-1)),o(n(I),{variant:"solid",onClick:s[3]||(s[3]=v=>A.value=!0)},{default:b(()=>[o(n(_e)),s[19]||(s[19]=F(" Execute Tests ",-1))]),_:1})])):j("",!0),J.value?(h(),P("div",Wl,[o(n(dt),{class:"loading-icon"}),s[22]||(s[22]=e("p",null,"Loading test executions...",-1))])):j("",!0)]),Q.value.length?(h(),P("div",Xl,[e("div",Zl," Showing "+c((V.value-1)*g.value+1)+" to "+c(Math.min(V.value*g.value,C.value))+" of "+c(C.value)+" executions ",1),e("div",Jl,[o(n(I),{variant:"outline",size:"sm",disabled:V.value===1,onClick:s[4]||(s[4]=v=>ue(V.value-1))},{default:b(()=>[o(n(Le)),s[23]||(s[23]=F(" Previous ",-1))]),_:1},8,["disabled"]),e("span",Yl,"Page "+c(V.value)+" of "+c(ee.value),1),o(n(I),{variant:"outline",size:"sm",disabled:V.value===ee.value,onClick:s[5]||(s[5]=v=>ue(V.value+1))},{default:b(()=>[s[24]||(s[24]=F(" Next ",-1)),o(n(Ue))]),_:1},8,["disabled"])])])):j("",!0)]),o(n(Pe),{modelValue:R.value,"onUpdate:modelValue":s[7]||(s[7]=v=>R.value=v),size:"large"},{title:b(()=>{var v;return[o(n(ke)),F(" Execution Details: "+c((v=y.value)==null?void 0:v.execution_id),1)]}),actions:b(()=>[o(n(I),{variant:"outline",onClick:s[6]||(s[6]=v=>R.value=!1)},{default:b(()=>[...s[35]||(s[35]=[F(" Close ",-1)])]),_:1}),o(n(I),{variant:"solid",onClick:re,disabled:!$.value.length},{default:b(()=>[o(n(Se)),s[36]||(s[36]=F(" Download Results ",-1))]),_:1},8,["disabled"])]),default:b(()=>[y.value?(h(),P("div",ea,[e("div",ta,[e("div",sa,[s[32]||(s[32]=e("h4",null,"Execution Information",-1)),e("div",la,[e("div",aa,[s[25]||(s[25]=e("span",{class:"detail-label"},"Test Name:",-1)),e("span",oa,c(y.value.execution_name),1)]),e("div",na,[s[26]||(s[26]=e("span",{class:"detail-label"},"Category:",-1)),e("span",ia,c(y.value.execution_type),1)]),e("div",ra,[s[27]||(s[27]=e("span",{class:"detail-label"},"Status:",-1)),o(n(W),{variant:_(y.value.status)},{default:b(()=>[F(c(y.value.status),1)]),_:1},8,["variant"])]),e("div",da,[s[28]||(s[28]=e("span",{class:"detail-label"},"Start Time:",-1)),e("span",ua,c(se(y.value.actual_start_date)),1)]),e("div",ca,[s[29]||(s[29]=e("span",{class:"detail-label"},"End Time:",-1)),e("span",pa,c(se(y.value.actual_end_date)),1)]),e("div",ma,[s[30]||(s[30]=e("span",{class:"detail-label"},"Duration:",-1)),e("span",ga,c(oe(y.value)),1)]),e("div",va,[s[31]||(s[31]=e("span",{class:"detail-label"},"Executed By:",-1)),e("span",fa,c(y.value.created_by),1)])])]),e("div",_a,[s[34]||(s[34]=e("h4",null,"Test Results",-1)),$.value.length?(h(),P("div",xa,[(h(!0),P(pe,null,me($.value,v=>(h(),P("div",{key:v.name,class:"result-item"},[e("div",ya,[o(n(W),{variant:te(v.status)},{default:b(()=>[F(c(v.status),1)]),_:2},1032,["variant"]),e("span",ba,c(v.description),1)]),v.error_message?(h(),P("div",ha,c(v.error_message),1)):j("",!0)]))),128))])):(h(),P("div",wa,[o(n(Fe)),s[33]||(s[33]=e("span",null,"No results available",-1))]))])])])):j("",!0)]),_:1},8,["modelValue"]),o(Vl,{show:x.value,execution:t.value,"onUpdate:show":s[8]||(s[8]=v=>x.value=v),onSaved:M},null,8,["show","execution"])]))}},Fa=Qe($a,[["__scopeId","data-v-b1b9d317"]]);export{Fa as default};
//# sourceMappingURL=TestExecution-B9yhM9kV.js.map
