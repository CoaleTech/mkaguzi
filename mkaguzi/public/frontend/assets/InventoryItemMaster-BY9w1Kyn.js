var oe=Object.defineProperty;var L=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var H=(x,r,a)=>r in x?oe(x,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):x[r]=a,O=(x,r)=>{for(var a in r||(r={}))ie.call(r,a)&&H(x,a,r[a]);if(L)for(var a of L(r))ne.call(r,a)&&H(x,a,r[a]);return x};var _=(x,r,a)=>new Promise((C,k)=>{var w=m=>{try{u(a.next(m))}catch(c){k(c)}},I=m=>{try{u(a.throw(m))}catch(c){k(c)}},u=m=>m.done?C(m.value):Promise.resolve(m.value).then(w,I);u((a=a.apply(x,r)).next())});import{ab as re,r as b,j as M,Q as ue,l as p,p as v,q as e,s as i,u as d,v as n,z as g,ac as B,ah as de,ao as $,F,x as P,A as o,H as U,a6 as q,B as Q}from"./vue-DciwFjI_.js";import{p as me,a as y,c as G,D as ce}from"./index-qIC3Tfxg.js";import{$ as pe,a0 as ve,U as ge,N as fe,bq as xe,v as ye}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const be={class:"p-6"},we={class:"flex justify-between items-center mb-6"},he={class:"flex gap-2"},_e={class:"bg-white rounded-lg border p-4 mb-6"},Ce={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ke=["value"],Ie={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},Ve={class:"bg-white rounded-lg border p-4"},Ae={class:"text-2xl font-bold"},Se={class:"bg-white rounded-lg border p-4"},Me={class:"text-2xl font-bold text-green-600"},Ue={class:"bg-white rounded-lg border p-4"},ze={class:"text-2xl font-bold text-blue-600"},Be={class:"bg-white rounded-lg border p-4"},$e={class:"text-2xl font-bold text-red-600"},Fe={class:"bg-white rounded-lg border shadow-sm"},Pe={class:"overflow-x-auto"},Re={class:"min-w-full divide-y divide-gray-200"},Te={class:"bg-white divide-y divide-gray-200"},De=["onClick"],Ne={class:"px-4 py-3 whitespace-nowrap"},Ee={class:"font-medium text-gray-900"},je={class:"px-4 py-3"},Le={class:"text-gray-600 line-clamp-1"},He={class:"px-4 py-3 whitespace-nowrap text-gray-500"},Oe={class:"px-4 py-3 whitespace-nowrap text-gray-500"},qe={class:"px-4 py-3 whitespace-nowrap text-right text-gray-900"},Qe={class:"px-4 py-3 whitespace-nowrap text-gray-500"},Ge={class:"px-4 py-3 whitespace-nowrap"},Ke={class:"px-4 py-3 whitespace-nowrap"},We={class:"px-4 py-3 whitespace-nowrap text-right"},Je={key:0,class:"p-12 text-center text-gray-500"},Xe={key:1,class:"px-4 py-3 border-t flex items-center justify-between"},Ye={class:"text-sm text-gray-500"},Ze={class:"flex gap-2"},et={class:"space-y-4"},tt={class:"text-sm text-gray-600 mb-4"},st={key:0,class:"mt-2 text-sm text-yellow-700"},lt={class:"font-medium"},at={class:"list-disc list-inside mt-1"},ot={key:0},ct={__name:"InventoryItemMaster",setup(x){const r=re(),a=me(),C=b(!1),k=b(!1),w=b(!1),I=b(null),u=b(null),m=b(""),c=b({category:"",abc_classification:"",is_active:""}),K=b(["Electronics","Raw Materials","Finished Goods","Consumables","Packaging"]),A=M(()=>a.items),z=M(()=>a.itemsTotalCount),h=M(()=>a.itemsPage),S=M(()=>a.itemsPageSize),R=M(()=>Math.ceil(z.value/S.value));ue(()=>_(this,null,function*(){yield V()}));function V(){return _(this,null,function*(){C.value=!0;try{const l=O({},c.value);m.value&&(l.search=m.value),Object.keys(l).forEach(t=>{l[t]===""&&delete l[t]}),yield a.loadItems(l,h.value,S.value)}finally{C.value=!1}})}function W(){return _(this,null,function*(){m.value="",c.value={category:"",abc_classification:"",is_active:""},yield V()})}let T=null;function J(){clearTimeout(T),T=setTimeout(()=>{V()},300)}function D(l){return _(this,null,function*(){yield a.loadItems(c.value,l,S.value)})}function N(){return _(this,null,function*(){try{const l=yield a.getItemImportTemplate(),t=new Blob([l.content],{type:"text/csv"}),s=URL.createObjectURL(t),f=document.createElement("a");f.href=s,f.download=l.filename,f.click(),URL.revokeObjectURL(s)}catch(l){console.error("Error downloading template:",l)}})}function X(l){I.value=l.target.files[0],u.value=null}function Y(){return _(this,null,function*(){var l;if(I.value){k.value=!0;try{const t=yield I.value.text();u.value=yield a.importItemsFromCSV(t),(l=u.value.errors)!=null&&l.length||(w.value=!1)}catch(t){console.error("Error importing items:",t)}finally{k.value=!1}}})}function E(){r.push("/inventory-audit/items/new")}function Z(l){r.push(`/inventory-audit/items/${l}`)}function ee(l){r.push(`/inventory-audit/items/${l.name}/edit`)}function te(l){return new Intl.NumberFormat("en-US",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(l||0)}function se(l){return l!=null&&l.includes("A")?"red":l!=null&&l.includes("B")?"yellow":"gray"}return(l,t)=>(v(),p("div",be,[e("div",we,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-2xl font-bold"},"Inventory Item Master"),e("p",{class:"text-gray-600"},"Manage inventory items for stock take audits")],-1)),e("div",he,[i(n(y),{onClick:W,loading:C.value,variant:"outline",size:"sm"},{default:d(()=>[i(n(pe),{class:"w-4 h-4"})]),_:1},8,["loading"]),i(n(y),{onClick:N,variant:"outline",size:"sm"},{default:d(()=>[i(n(ve),{class:"w-4 h-4 mr-2"}),t[9]||(t[9]=g(" Template ",-1))]),_:1}),i(n(y),{onClick:t[0]||(t[0]=s=>w.value=!0),variant:"outline",size:"sm"},{default:d(()=>[i(n(ge),{class:"w-4 h-4 mr-2"}),t[10]||(t[10]=g(" Import ",-1))]),_:1}),i(n(y),{onClick:E},{default:d(()=>[i(n(fe),{class:"w-4 h-4 mr-2"}),t[11]||(t[11]=g(" New Item ",-1))]),_:1})])]),e("div",_e,[e("div",Ce,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),B(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),type:"text",placeholder:"Search by item code...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onInput:J},null,544),[[de,m.value]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),B(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>c.value.category=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:V},[t[14]||(t[14]=e("option",{value:""},"All Categories",-1)),(v(!0),p(F,null,P(K.value,s=>(v(),p("option",{key:s,value:s},o(s),9,ke))),128))],544),[[$,c.value.category]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ABC Class",-1)),B(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>c.value.abc_classification=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:V},[...t[16]||(t[16]=[e("option",{value:""},"All Classes",-1),e("option",{value:"A - High Value"},"A - High Value",-1),e("option",{value:"B - Medium Value"},"B - Medium Value",-1),e("option",{value:"C - Low Value"},"C - Low Value",-1)])],544),[[$,c.value.abc_classification]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),B(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>c.value.is_active=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:V},[...t[18]||(t[18]=[e("option",{value:""},"All",-1),e("option",{value:1},"Active",-1),e("option",{value:0},"Inactive",-1)])],544),[[$,c.value.is_active]])])])]),e("div",Ie,[e("div",Ve,[t[20]||(t[20]=e("p",{class:"text-sm text-gray-500"},"Total Items",-1)),e("p",Ae,o(z.value),1)]),e("div",Se,[t[21]||(t[21]=e("p",{class:"text-sm text-gray-500"},"Active Items",-1)),e("p",Me,o(A.value.filter(s=>s.is_active).length),1)]),e("div",Ue,[t[22]||(t[22]=e("p",{class:"text-sm text-gray-500"},"A-Class Items",-1)),e("p",ze,o(A.value.filter(s=>s.abc_classification==="A - High Value").length),1)]),e("div",Be,[t[23]||(t[23]=e("p",{class:"text-sm text-gray-500"},"High Risk",-1)),e("p",$e,o(A.value.filter(s=>s.risk_classification==="High Risk").length),1)])]),e("div",Fe,[e("div",Pe,[e("table",Re,[t[24]||(t[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Item Code"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Category"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"UOM"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Valuation"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Warehouse"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"ABC"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),e("tbody",Te,[(v(!0),p(F,null,P(A.value,s=>(v(),p("tr",{key:s.name,class:"hover:bg-gray-50 cursor-pointer",onClick:f=>Z(s.name)},[e("td",Ne,[e("span",Ee,o(s.item_code),1)]),e("td",je,[e("span",Le,o(s.item_description),1)]),e("td",He,o(s.category),1),e("td",Oe,o(s.unit_of_measure),1),e("td",qe,o(te(s.valuation_rate)),1),e("td",Qe,o(s.warehouse),1),e("td",Ge,[i(n(G),{variant:se(s.abc_classification)},{default:d(()=>{var f;return[g(o(((f=s.abc_classification)==null?void 0:f.charAt(0))||"-"),1)]}),_:2},1032,["variant"])]),e("td",Ke,[i(n(G),{variant:s.is_active?"green":"gray"},{default:d(()=>[g(o(s.is_active?"Active":"Inactive"),1)]),_:2},1032,["variant"])]),e("td",We,[i(n(y),{variant:"ghost",size:"sm",onClick:q(f=>ee(s),["stop"])},{default:d(()=>[i(n(xe),{class:"w-4 h-4"})]),_:1},8,["onClick"])])],8,De))),128))])])]),A.value.length===0&&!C.value?(v(),p("div",Je,[i(n(ye),{class:"w-12 h-12 mx-auto mb-3 text-gray-300"}),t[26]||(t[26]=e("p",null,"No items found",-1)),i(n(y),{variant:"outline",size:"sm",class:"mt-2",onClick:E},{default:d(()=>[...t[25]||(t[25]=[g(" Add First Item ",-1)])]),_:1})])):U("",!0),R.value>1?(v(),p("div",Xe,[e("p",Ye," Showing "+o((h.value-1)*S.value+1)+" - "+o(Math.min(h.value*S.value,z.value))+" of "+o(z.value),1),e("div",Ze,[i(n(y),{variant:"outline",size:"sm",disabled:h.value===1,onClick:t[5]||(t[5]=s=>D(h.value-1))},{default:d(()=>[...t[27]||(t[27]=[g(" Previous ",-1)])]),_:1},8,["disabled"]),i(n(y),{variant:"outline",size:"sm",disabled:h.value===R.value,onClick:t[6]||(t[6]=s=>D(h.value+1))},{default:d(()=>[...t[28]||(t[28]=[g(" Next ",-1)])]),_:1},8,["disabled"])])])):U("",!0)]),i(n(ce),{modelValue:w.value,"onUpdate:modelValue":t[8]||(t[8]=s=>w.value=s),options:{title:"Import Items from CSV"}},{"body-content":d(()=>{var s,f,j;return[e("div",et,[e("div",null,[e("p",tt,[t[29]||(t[29]=g(" Upload a CSV file with your inventory items. ",-1)),e("a",{href:"#",onClick:q(N,["prevent"]),class:"text-blue-600 hover:underline"}," Download the template "),t[30]||(t[30]=g(" to see the required format. ",-1))])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CSV File",-1)),e("input",{type:"file",accept:".csv",onChange:X,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32)]),u.value?(v(),p("div",{key:0,class:Q(["p-4 rounded-lg",(s=u.value.errors)!=null&&s.length?"bg-yellow-50":"bg-green-50"])},[e("p",{class:Q(["font-medium",(f=u.value.errors)!=null&&f.length?"text-yellow-800":"text-green-800"])},o(u.value.imported)+" items imported successfully ",3),(j=u.value.errors)!=null&&j.length?(v(),p("div",st,[e("p",lt,"Errors ("+o(u.value.total_errors)+"):",1),e("ul",at,[(v(!0),p(F,null,P(u.value.errors.slice(0,5),(le,ae)=>(v(),p("li",{key:ae},o(le),1))),128)),u.value.errors.length>5?(v(),p("li",ot,"...and "+o(u.value.errors.length-5)+" more",1)):U("",!0)])])):U("",!0)],2)):U("",!0)])]}),actions:d(()=>[i(n(y),{variant:"outline",onClick:t[7]||(t[7]=s=>w.value=!1)},{default:d(()=>[...t[32]||(t[32]=[g("Cancel",-1)])]),_:1}),i(n(y),{onClick:Y,loading:k.value,disabled:!I.value},{default:d(()=>[...t[33]||(t[33]=[g("Import",-1)])]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])]))}};export{ct as default};
//# sourceMappingURL=InventoryItemMaster-BY9w1Kyn.js.map
