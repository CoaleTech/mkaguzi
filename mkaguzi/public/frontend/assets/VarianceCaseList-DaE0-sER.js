var J=Object.defineProperty;var I=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var R=(v,l,o)=>l in v?J(v,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):v[l]=o,$=(v,l)=>{for(var o in l||(l={}))W.call(l,o)&&R(v,o,l[o]);if(I)for(var o of I(l))X.call(l,o)&&R(v,o,l[o]);return v};var k=(v,l,o)=>new Promise((b,w)=>{var r=i=>{try{y(o.next(i))}catch(p){w(p)}},x=i=>{try{y(o.throw(i))}catch(p){w(p)}},y=i=>i.done?b(i.value):Promise.resolve(i.value).then(r,x);y((o=o.apply(v,l)).next())});import{ab as Y,r as S,j as h,Q as Z,l as g,p as d,q as t,s as m,u as C,v as u,ac as V,ao as N,am as D,F as z,x as j,A as n,ah as ee,aq as te,H as _,y as se,z as c,B as P}from"./vue-DciwFjI_.js";import{p as ae,a as U,c as L}from"./index-qIC3Tfxg.js";import{$ as oe,T as ne,v as ie,a6 as le,O as re,n as de}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const ue={class:"p-6"},ge={class:"flex justify-between items-center mb-6"},me={class:"flex gap-2"},ce={class:"bg-white rounded-lg border p-4 mb-6"},ve={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},pe=["value"],xe={class:"flex items-end"},ye={class:"flex items-center gap-2"},fe={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},_e={class:"bg-white rounded-lg border p-4"},be={class:"text-2xl font-bold"},we={class:"bg-white rounded-lg border p-4"},he={class:"text-2xl font-bold text-blue-600"},Ce={class:"bg-white rounded-lg border p-4"},ke={class:"text-2xl font-bold text-yellow-600"},Ve={class:"bg-white rounded-lg border p-4"},Se={class:"text-2xl font-bold text-red-600"},Ne={class:"bg-white rounded-lg border p-4"},Pe={class:"text-2xl font-bold text-orange-600"},Ue={class:"bg-white rounded-lg border shadow-sm"},Le={key:0,class:"divide-y divide-gray-200"},Me=["onClick"],Ae={class:"flex items-start justify-between"},Te={class:"flex-1"},Be={class:"flex items-center gap-3 mb-2"},Ie={class:"font-medium text-gray-900"},Re={class:"text-sm text-gray-600 mb-2"},$e={class:"flex items-center gap-6 text-sm text-gray-500"},De={class:"flex items-center gap-1"},ze={key:0,class:"line-clamp-1"},je={class:"flex items-center gap-6 mt-3 text-sm"},Fe={class:"text-gray-700"},qe={class:"text-gray-700"},Oe={class:"text-gray-700"},He={class:"flex items-center gap-6 mt-3 text-sm"},Ee={key:0,class:"flex items-center gap-1 text-purple-600"},Qe={key:1,class:"flex items-center gap-1 text-gray-500"},Ke={class:"text-right"},Ge={key:0,class:"text-xs text-gray-500"},Je={key:1,class:"p-12 text-center text-gray-500"},We={key:2,class:"px-4 py-3 border-t flex items-center justify-between"},Xe={class:"text-sm text-gray-500"},Ye={class:"flex gap-2"},it={__name:"VarianceCaseList",setup(v){const l=Y(),o=ae(),b=S(!1),w=S(!1),r=S({status:"",priority:"",root_cause:"",investigator:""}),x=h(()=>o.varianceCases),y=h(()=>o.varianceCasesTotalCount),i=h(()=>o.varianceCasesPage),p=h(()=>o.varianceCasesPageSize),M=h(()=>Math.ceil(y.value/p.value)),F=h(()=>x.value.reduce((a,e)=>a+Math.abs(e.variance_value||0),0));Z(()=>k(this,null,function*(){yield f()}));function f(){return k(this,null,function*(){b.value=!0;try{const a=$({},r.value);Object.keys(a).forEach(e=>{a[e]||delete a[e]}),yield o.loadVarianceCases(a,i.value,p.value)}finally{b.value=!1}})}function q(){return k(this,null,function*(){r.value={status:"",priority:"",root_cause:"",investigator:""},w.value=!1,yield f()})}let A=null;function O(){clearTimeout(A),A=setTimeout(()=>f(),300)}function T(a){return k(this,null,function*(){yield o.loadVarianceCases(r.value,a,p.value)})}function H(a){l.push(`/inventory-audit/variance-cases/${a}`)}function E(a){return{New:"blue","Under Investigation":"yellow","Resolution Proposed":"orange",Resolved:"green",Closed:"gray","No Variance":"gray"}[a]||"gray"}function Q(a){return{Critical:"red",High:"orange",Medium:"yellow",Low:"blue"}[a]||"gray"}function K(a){return a.is_sla_breached?"text-red-600":a.sla_days_remaining!==void 0&&a.sla_days_remaining<=2?"text-orange-600":"text-gray-900"}function G(a){return a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}function B(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(a||0)}return(a,e)=>(d(),g("div",ue,[t("div",ge,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"Variance Reconciliation Cases"),t("p",{class:"text-gray-600"},"Investigate and resolve inventory discrepancies")],-1)),t("div",me,[m(u(U),{onClick:q,loading:b.value,variant:"outline",size:"sm"},{default:C(()=>[m(u(oe),{class:"w-4 h-4"})]),_:1},8,["loading"])])]),t("div",ce,[t("div",ve,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),V(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:f},[...e[8]||(e[8]=[D('<option value="">All Statuses</option><option value="New">New</option><option value="Under Investigation">Under Investigation</option><option value="Resolution Proposed">Resolution Proposed</option><option value="Resolved">Resolved</option><option value="Closed">Closed</option>',6)])],544),[[N,r.value.status]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),V(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.priority=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:f},[...e[10]||(e[10]=[D('<option value="">All Priorities</option><option value="Critical">Critical</option><option value="High">High</option><option value="Medium">Medium</option><option value="Low">Low</option>',5)])],544),[[N,r.value.priority]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Root Cause",-1)),V(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.root_cause=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:f},[e[12]||(e[12]=t("option",{value:""},"All Causes",-1)),(d(!0),g(z,null,j(u(o).rootCauseOptions,s=>(d(),g("option",{key:s.value,value:s.value},n(s.label),9,pe))),128))],544),[[N,r.value.root_cause]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Investigator",-1)),V(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.investigator=s),type:"text",placeholder:"Filter by investigator",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onInput:O},null,544),[[ee,r.value.investigator]])]),t("div",xe,[t("label",ye,[V(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=s=>w.value=s),onChange:f,class:"rounded border-gray-300"},null,544),[[te,w.value]]),e[15]||(e[15]=t("span",{class:"text-sm text-gray-700"},"SLA Breached Only",-1))])])])]),t("div",fe,[t("div",_e,[e[16]||(e[16]=t("p",{class:"text-sm text-gray-500"},"Total Cases",-1)),t("p",be,n(y.value),1)]),t("div",we,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-500"},"New",-1)),t("p",he,n(x.value.filter(s=>s.status==="New").length),1)]),t("div",Ce,[e[18]||(e[18]=t("p",{class:"text-sm text-gray-500"},"Under Investigation",-1)),t("p",ke,n(x.value.filter(s=>s.status==="Under Investigation").length),1)]),t("div",Ve,[e[19]||(e[19]=t("p",{class:"text-sm text-gray-500"},"SLA Breached",-1)),t("p",Se,n(x.value.filter(s=>s.is_sla_breached).length),1)]),t("div",Ne,[e[20]||(e[20]=t("p",{class:"text-sm text-gray-500"},"Total Variance Value",-1)),t("p",Pe,n(B(F.value)),1)])]),t("div",Ue,[x.value.length>0?(d(),g("div",Le,[(d(!0),g(z,null,j(x.value,s=>(d(),g("div",{key:s.name,class:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:Ze=>H(s.name)},[t("div",Ae,[t("div",Te,[t("div",Be,[t("h4",Ie,n(s.case_title||s.item_code),1),m(u(L),{variant:E(s.status)},{default:C(()=>[c(n(s.status),1)]),_:2},1032,["variant"]),m(u(L),{variant:Q(s.priority)},{default:C(()=>[c(n(s.priority),1)]),_:2},1032,["variant"]),s.is_sla_breached?(d(),se(u(L),{key:0,variant:"red"},{default:C(()=>[m(u(ne),{class:"w-3 h-3 mr-1"}),e[21]||(e[21]=c(" SLA Breached ",-1))]),_:1})):_("",!0)]),t("p",Re,n(s.case_id),1),t("div",$e,[t("span",De,[m(u(ie),{class:"w-4 h-4"}),c(" "+n(s.item_code),1)]),s.item_description?(d(),g("span",ze,n(s.item_description),1)):_("",!0)]),t("div",je,[t("span",Fe,[e[22]||(e[22]=c(" Qty Variance: ",-1)),t("strong",{class:P(s.variance_quantity>0?"text-green-600":"text-red-600")},n(s.variance_quantity>0?"+":"")+n(s.variance_quantity),3)]),t("span",qe,[e[23]||(e[23]=c(" Value: ",-1)),t("strong",{class:P(s.variance_value>0?"text-green-600":"text-red-600")},n(B(s.variance_value)),3)]),t("span",Oe,[e[24]||(e[24]=c(" Variance %: ",-1)),t("strong",null,n(Math.abs(s.variance_percent||0).toFixed(1))+"%",1)])]),t("div",He,[s.root_cause?(d(),g("span",Ee,[m(u(le),{class:"w-4 h-4"}),c(" "+n(s.root_cause),1)])):_("",!0),s.investigator?(d(),g("span",Qe,[m(u(re),{class:"w-4 h-4"}),c(" "+n(s.investigator),1)])):_("",!0)])]),t("div",Ke,[e[25]||(e[25]=t("p",{class:"text-sm text-gray-500"},"SLA Due",-1)),t("p",{class:P(["font-medium",K(s)])},n(G(s.sla_due_date)),3),s.sla_days_remaining!==void 0?(d(),g("p",Ge,n(s.sla_days_remaining>=0?`${s.sla_days_remaining} days left`:`${Math.abs(s.sla_days_remaining)} days overdue`),1)):_("",!0)])])],8,Me))),128))])):b.value?_("",!0):(d(),g("div",Je,[m(u(de),{class:"w-12 h-12 mx-auto mb-3 text-green-300"}),e[26]||(e[26]=t("p",null,"No variance cases found",-1))])),M.value>1?(d(),g("div",We,[t("p",Xe," Showing "+n((i.value-1)*p.value+1)+" - "+n(Math.min(i.value*p.value,y.value))+" of "+n(y.value),1),t("div",Ye,[m(u(U),{variant:"outline",size:"sm",disabled:i.value===1,onClick:e[5]||(e[5]=s=>T(i.value-1))},{default:C(()=>[...e[27]||(e[27]=[c(" Previous ",-1)])]),_:1},8,["disabled"]),m(u(U),{variant:"outline",size:"sm",disabled:i.value===M.value,onClick:e[6]||(e[6]=s=>T(i.value+1))},{default:C(()=>[...e[28]||(e[28]=[c(" Next ",-1)])]),_:1},8,["disabled"])])])):_("",!0)])]))}};export{it as default};
//# sourceMappingURL=VarianceCaseList-DaE0-sER.js.map
