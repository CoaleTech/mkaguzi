var se=Object.defineProperty,te=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var L=(u,r,n)=>r in u?se(u,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[r]=n,S=(u,r)=>{for(var n in r||(r={}))ne.call(r,n)&&L(u,n,r[n]);if(z)for(var n of z(r))re.call(r,n)&&L(u,n,r[n]);return u},G=(u,r)=>te(u,oe(r));var U=(u,r,n)=>new Promise((_,g)=>{var k=c=>{try{m(n.next(c))}catch(x){g(x)}},C=c=>{try{m(n.throw(c))}catch(x){g(x)}},m=c=>c.done?_(c.value):Promise.resolve(c.value).then(k,C);m((n=n.apply(u,r)).next())});import{r as f,j as E,Q as ie,l as h,p as w,q as l,H as N,s as o,u as d,z as b,v as s,F as q,x as F,A as v,y as I,C as de,B as ue,a6 as B}from"./vue-DciwFjI_.js";import{a as p,h as V,d as j,c as R,i as me}from"./index-qIC3Tfxg.js";import{a0 as ce,N as ve,m as fe,O as pe,aa as ge,bm as xe,n as ye,bn as we,b as be,C as _e,a4 as he}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const ke={class:"space-y-6"},Ce={class:"flex items-center justify-between"},Ue={class:"flex items-center space-x-3"},Ve={class:"bg-white rounded-lg border border-gray-200 p-4"},Ae={class:"flex flex-col sm:flex-row gap-4"},Se={class:"flex-1"},Me={class:"flex gap-2"},Ee={class:"bg-white rounded-lg border border-gray-200 overflow-hidden"},je={class:"overflow-x-auto"},Oe={class:"min-w-full divide-y divide-gray-200"},$e={class:"bg-white divide-y divide-gray-200"},De={class:"px-6 py-4 whitespace-nowrap"},Pe={class:"flex items-center"},ze={class:"flex-shrink-0 h-10 w-10"},Le={class:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center"},Ge={class:"ml-4"},Ne={class:"text-sm font-medium text-gray-900"},qe={class:"text-sm text-gray-500"},Fe={class:"px-6 py-4 whitespace-nowrap"},Ie={class:"text-sm text-gray-900"},Be={class:"px-6 py-4 whitespace-nowrap"},Re={class:"flex flex-wrap gap-1"},Je={class:"px-6 py-4 whitespace-nowrap"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},He={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ke={class:"flex items-center space-x-2"},Te={class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Xe={class:"flex items-center justify-between"},We={class:"text-sm text-gray-700"},Ye={class:"flex items-center space-x-2"},Ze={class:"flex items-center justify-between mb-4"},el={class:"text-lg font-medium text-gray-900"},ll={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},al={key:0},sl={class:"flex items-center space-x-2"},tl={class:"flex justify-end space-x-3 pt-4"},ml={__name:"UserManagement",setup(u){const r=f(""),n=f(""),_=f(""),g=f(1),k=f(10),C=f(!1),m=f(!1),c=f(!1),x=f([]),i=f({name:"",full_name:"",username:"",email:"",role_profile_name:"",password:"",enabled:!0}),O=E(()=>{let t=x.value;if(r.value){const e=r.value.toLowerCase();t=t.filter(a=>{var y,$,D,P;return((y=a.full_name)==null?void 0:y.toLowerCase().includes(e))||(($=a.email)==null?void 0:$.toLowerCase().includes(e))||((D=a.username)==null?void 0:D.toLowerCase().includes(e))||((P=a.roles)==null?void 0:P.some(ae=>ae.toLowerCase().includes(e)))})}if(n.value&&(t=t.filter(e=>{var a;return(a=e.roles)==null?void 0:a.includes(n.value)})),_.value){const e=_.value==="active";t=t.filter(a=>a.enabled===e)}return t}),M=E(()=>O.value.length),J=E(()=>Math.ceil(M.value/k.value)),Q=[{label:"All Roles",value:""},{label:"System Manager",value:"System Manager"},{label:"Audit Manager",value:"Audit Manager"},{label:"Auditor",value:"Auditor"},{label:"Compliance Officer",value:"Compliance Officer"},{label:"Guest",value:"Guest"}],H=[{label:"All Status",value:""},{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],K=[{label:"System Manager",value:"System Manager"},{label:"Audit Manager",value:"Audit Manager"},{label:"Auditor",value:"Auditor"},{label:"Compliance Officer",value:"Compliance Officer"},{label:"Guest",value:"Guest"}],T=()=>U(this,null,function*(){try{x.value=[{name:"Administrator",full_name:"Administrator",username:"Administrator",email:"admin@example.com",roles:["System Manager"],enabled:!0,last_login:new Date().toISOString()},{name:"Guest",full_name:"Guest",username:"Guest",email:"guest@example.com",roles:["Guest"],enabled:!0,last_login:null},{name:"john_doe",full_name:"John Doe",username:"john_doe",email:"john.doe@example.com",roles:["Audit Manager"],enabled:!0,last_login:new Date(Date.now()-864e5).toISOString()},{name:"jane_smith",full_name:"Jane Smith",username:"jane_smith",email:"jane.smith@example.com",roles:["Auditor"],enabled:!0,last_login:new Date(Date.now()-36e5).toISOString()},{name:"mike_johnson",full_name:"Mike Johnson",username:"mike_johnson",email:"mike.johnson@example.com",roles:["Compliance Officer"],enabled:!1,last_login:new Date(Date.now()-6048e5).toISOString()}]}catch(t){console.error("Error fetching users:",t)}}),X=t=>({"System Manager":"destructive","Audit Manager":"default",Auditor:"secondary","Compliance Officer":"outline",Guest:"secondary"})[t]||"secondary",W=t=>{i.value=S({},t),m.value=!0},Y=t=>U(this,null,function*(){try{t.enabled=!t.enabled,console.log(`User ${t.name} ${t.enabled?"enabled":"disabled"}`)}catch(e){console.error("Error toggling user status:",e)}}),Z=t=>U(this,null,function*(){if(confirm(`Are you sure you want to reset the password for ${t.full_name}?`))try{console.log(`Password reset for user ${t.name}`),alert("Password reset email sent successfully!")}catch(e){console.error("Error resetting password:",e),alert("Error resetting password. Please try again.")}}),ee=()=>U(this,null,function*(){c.value=!0;try{if(m.value){const t=x.value.findIndex(e=>e.name===i.value.name);t!==-1&&(x.value[t]=S({},i.value))}else x.value.push(G(S({},i.value),{name:i.value.username,last_login:null}));A(),console.log("User saved successfully")}catch(t){console.error("Error saving user:",t),alert("Error saving user. Please try again.")}finally{c.value=!1}}),A=()=>{C.value=!1,m.value=!1,i.value={name:"",full_name:"",username:"",email:"",role_profile_name:"",password:"",enabled:!0}},le=t=>t?new Date(t).toLocaleString():"Never";return ie(()=>{T()}),(t,e)=>(w(),h("div",ke,[l("div",Ce,[e[15]||(e[15]=l("div",null,[l("h1",{class:"text-2xl font-bold text-gray-900"},"User Management"),l("p",{class:"text-gray-600 mt-1"}," Manage system users, roles, and permissions ")],-1)),l("div",Ue,[o(s(p),{variant:"outline"},{default:d(()=>[o(s(ce),{class:"h-4 w-4 mr-2"}),e[13]||(e[13]=b(" Export Users ",-1))]),_:1}),o(s(p),{onClick:e[0]||(e[0]=a=>C.value=!0)},{default:d(()=>[o(s(ve),{class:"h-4 w-4 mr-2"}),e[14]||(e[14]=b(" Add User ",-1))]),_:1})])]),l("div",Ve,[l("div",Ae,[l("div",Se,[o(s(V),{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value=a),placeholder:"Search users by name, email, or role...",class:"w-full"},{default:d(()=>[o(s(fe),{class:"h-4 w-4 text-gray-400"})]),_:1},8,["modelValue"])]),l("div",Me,[o(s(j),{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value=a),options:Q,placeholder:"All Roles",class:"w-40"},null,8,["modelValue"]),o(s(j),{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=a=>_.value=a),options:H,placeholder:"All Status",class:"w-40"},null,8,["modelValue"])])])]),l("div",Ee,[l("div",je,[l("table",Oe,[e[16]||(e[16]=l("thead",{class:"bg-gray-50"},[l("tr",null,[l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Role "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Last Login "),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),l("tbody",$e,[(w(!0),h(q,null,F(O.value,a=>(w(),h("tr",{key:a.name,class:"hover:bg-gray-50"},[l("td",De,[l("div",Pe,[l("div",ze,[l("div",Le,[o(s(pe),{class:"h-5 w-5 text-white"})])]),l("div",Ge,[l("div",Ne,v(a.full_name||a.name),1),l("div",qe,v(a.username),1)])])]),l("td",Fe,[l("div",Ie,v(a.email),1)]),l("td",Be,[l("div",Re,[(w(!0),h(q,null,F(a.roles,y=>(w(),I(s(R),{key:y,variant:X(y),size:"sm"},{default:d(()=>[b(v(y),1)]),_:2},1032,["variant"]))),128))])]),l("td",Je,[o(s(R),{variant:a.enabled?"success":"secondary"},{default:d(()=>[b(v(a.enabled?"Active":"Inactive"),1)]),_:2},1032,["variant"])]),l("td",Qe,v(le(a.last_login)),1),l("td",He,[l("div",Ke,[o(s(p),{variant:"ghost",size:"sm",onClick:y=>W(a)},{default:d(()=>[o(s(ge),{class:"h-4 w-4"})]),_:1},8,["onClick"]),o(s(p),{variant:"ghost",size:"sm",onClick:y=>Y(a)},{default:d(()=>[(w(),I(de(a.enabled?s(xe):s(ye)),{class:ue(["h-4 w-4",a.enabled?"text-red-500":"text-green-500"])},null,8,["class"]))]),_:2},1032,["onClick"]),o(s(p),{variant:"ghost",size:"sm",onClick:y=>Z(a)},{default:d(()=>[o(s(we),{class:"h-4 w-4"})]),_:1},8,["onClick"])])])]))),128))])])]),l("div",Te,[l("div",Xe,[l("div",We," Showing "+v((g.value-1)*k.value+1)+" to "+v(Math.min(g.value*k.value,M.value))+" of "+v(M.value)+" users ",1),l("div",Ye,[o(s(p),{variant:"outline",size:"sm",disabled:g.value===1,onClick:e[4]||(e[4]=a=>g.value--)},{default:d(()=>[o(s(be),{class:"h-4 w-4"}),e[17]||(e[17]=b(" Previous ",-1))]),_:1},8,["disabled"]),o(s(p),{variant:"outline",size:"sm",disabled:g.value===J.value,onClick:e[5]||(e[5]=a=>g.value++)},{default:d(()=>[e[18]||(e[18]=b(" Next ",-1)),o(s(_e),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])])]),C.value||m.value?(w(),h("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:A},[l("div",{class:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white",onClick:e[12]||(e[12]=B(()=>{},["stop"]))},[l("div",Ze,[l("h3",el,v(m.value?"Edit User":"Add New User"),1),o(s(p),{variant:"ghost",onClick:A},{default:d(()=>[o(s(he),{class:"h-5 w-5"})]),_:1})]),l("form",{onSubmit:B(ee,["prevent"]),class:"space-y-4"},[l("div",ll,[l("div",null,[e[19]||(e[19]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Full Name",-1)),o(s(V),{modelValue:i.value.full_name,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value.full_name=a),placeholder:"Enter full name",required:"",class:"w-full"},null,8,["modelValue"])]),l("div",null,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Username",-1)),o(s(V),{modelValue:i.value.username,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.username=a),placeholder:"Enter username",required:"",class:"w-full"},null,8,["modelValue"])]),l("div",null,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),o(s(V),{modelValue:i.value.email,"onUpdate:modelValue":e[8]||(e[8]=a=>i.value.email=a),type:"email",placeholder:"Enter email address",required:"",class:"w-full"},null,8,["modelValue"])]),l("div",null,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Role",-1)),o(s(j),{modelValue:i.value.role_profile_name,"onUpdate:modelValue":e[9]||(e[9]=a=>i.value.role_profile_name=a),options:K,placeholder:"Select role",required:"",class:"w-full"},null,8,["modelValue"])])]),m.value?N("",!0):(w(),h("div",al,[e[23]||(e[23]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Password",-1)),o(s(V),{modelValue:i.value.password,"onUpdate:modelValue":e[10]||(e[10]=a=>i.value.password=a),type:"password",placeholder:"Enter password",required:"",class:"w-full"},null,8,["modelValue"])])),l("div",sl,[o(s(me),{modelValue:i.value.enabled,"onUpdate:modelValue":e[11]||(e[11]=a=>i.value.enabled=a)},null,8,["modelValue"]),e[24]||(e[24]=l("label",{class:"text-sm text-gray-700"},"User is active",-1))]),l("div",tl,[o(s(p),{variant:"outline",onClick:A},{default:d(()=>[...e[25]||(e[25]=[b(" Cancel ",-1)])]),_:1}),o(s(p),{type:"submit",loading:c.value},{default:d(()=>[b(v(m.value?"Update User":"Create User"),1)]),_:1},8,["loading"])])],32)])])):N("",!0)]))}};export{ml as default};
//# sourceMappingURL=UserManagement-CTH5rqFS.js.map
