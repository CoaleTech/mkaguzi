import{j as p,l as o,p as n,q as e,H as y,A as l,y as x,u as g,s as f,z as w,v as c,F as R,x as P,B as v,ac as m,ah as _,ao as G,am as K}from"./vue-DciwFjI_.js";import{a as V,c as Z}from"./index-qIC3Tfxg.js";import{N as O,t as H,v as L,T as W,K as J}from"./icons-CtLkBOsu.js";const X={class:"physical-count-table"},Y={class:"flex items-center justify-between mb-3"},tt={class:"text-sm font-medium text-gray-700"},et={class:"text-xs text-gray-500"},at={class:"flex items-center gap-2"},st={key:0,class:"grid grid-cols-4 gap-3 mb-4"},nt={class:"bg-blue-50 rounded-lg p-3"},ot={class:"text-lg font-bold text-blue-700"},rt={class:"bg-green-50 rounded-lg p-3"},lt={class:"text-lg font-bold text-green-700"},it={class:"bg-yellow-50 rounded-lg p-3"},dt={class:"text-lg font-bold text-yellow-700"},ut={class:"bg-red-50 rounded-lg p-3"},ct={class:"text-lg font-bold text-red-700"},yt={key:1,class:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg"},pt={key:2,class:"overflow-x-auto border rounded-lg"},mt={class:"min-w-full divide-y divide-gray-200"},xt={class:"bg-gray-50"},gt={key:0,class:"px-3 py-2 w-10"},ft={class:"bg-white divide-y divide-gray-200"},vt={class:"px-3 py-2 text-sm text-gray-500"},_t={class:"px-3 py-2"},ht=["onUpdate:modelValue"],bt={key:1,class:"text-sm font-medium text-gray-900"},kt={class:"px-3 py-2"},wt=["onUpdate:modelValue"],Vt={key:1,class:"text-sm text-gray-600"},Ct={class:"px-3 py-2 text-right"},qt=["onUpdate:modelValue","onChange"],It={key:1,class:"text-sm text-gray-900"},Nt={class:"px-3 py-2 text-right"},Ut=["onUpdate:modelValue","onChange"],Mt={key:1,class:"text-sm font-medium text-gray-900"},Tt={class:"px-3 py-2 text-right"},Ft={class:"px-3 py-2 text-right"},St={class:"px-3 py-2 text-center"},Dt=["onUpdate:modelValue"],zt={class:"px-3 py-2"},Et=["onUpdate:modelValue"],At={key:1,class:"text-sm text-gray-600"},Bt={key:0,class:"px-3 py-2 text-center"},Qt={key:3,class:"mt-3 flex items-center justify-end gap-6 text-sm"},Pt={__name:"PhysicalCountTable",props:{modelValue:{type:Array,default:()=>[]},readonly:{type:Boolean,default:!1},title:{type:String,default:"Count Items"},materialityThreshold:{type:Object,default:()=>({qty:0,amount:0,percent:5})},valuationRates:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(u,{emit:T}){const C=u,h=T,i=p({get:()=>C.modelValue||[],set:a=>h("update:modelValue",a)}),I=p(()=>i.value.filter(a=>a.variance_qty&&a.variance_qty!==0).length),F=p(()=>i.value.filter(a=>!a.variance_qty||a.variance_qty===0).length),S=p(()=>i.value.filter(a=>a.is_material).length),N=p(()=>i.value.reduce((a,t)=>a+(t.variance_qty||0),0)),U=p(()=>i.value.reduce((a,t)=>a+(t.variance_value||0),0));function M(){const a=[...i.value,{item_code:"",item_description:"",barcode:"",batch_no:"",serial_no:"",system_qty:0,counted_qty:0,variance_qty:0,variance_percent:0,variance_value:0,is_material:!1,condition:"",photo_attachment:"",remarks:""}];h("update:modelValue",a)}function D(a){const t=i.value.filter((s,d)=>d!==a);h("update:modelValue",t)}function q(a){const t=[...i.value],s=t[a],d=s.system_qty||0,r=s.counted_qty||0;s.variance_qty=r-d,d!==0?s.variance_percent=(r-d)/d*100:s.variance_percent=r!==0?100:0;const j=C.valuationRates[s.item_code]||0;s.variance_value=s.variance_qty*j,s.is_material=E(s),h("update:modelValue",t)}function z(){i.value.forEach((a,t)=>q(t))}function E(a){const{qty:t,amount:s,percent:d}=C.materialityThreshold;return!!(t&&Math.abs(a.variance_qty||0)>=t||s&&Math.abs(a.variance_value||0)>=s||d&&Math.abs(a.variance_percent||0)>=d)}function A(a){return a.is_material?"bg-red-50":a.variance_qty&&a.variance_qty!==0?"bg-yellow-50":""}function b(a){return!a||a===0?"text-gray-600":a>0?"text-green-600":"text-red-600"}function B(a){return{Good:"green",Damaged:"red",Expired:"red",Misplaced:"yellow","Zero Stock":"gray","Not Found":"red"}[a]||"gray"}function k(a){return a==null?"-":new Intl.NumberFormat().format(a)}function Q(a){return a==null?"-":`${a.toFixed(1)}%`}function $(a){return a==null?"-":new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(a)}return(a,t)=>(n(),o("div",X,[e("div",Y,[e("div",null,[e("h4",tt,l(u.title||"Count Items"),1),e("p",et,l(i.value.length)+" items â€¢ "+l(I.value)+" with variance",1)]),e("div",at,[u.readonly?y("",!0):(n(),x(c(V),{key:0,size:"sm",variant:"outline",onClick:M},{default:g(()=>[f(c(O),{class:"w-4 h-4 mr-1"}),t[0]||(t[0]=w(" Add Item ",-1))]),_:1})),!u.readonly&&i.value.length>0?(n(),x(c(V),{key:1,size:"sm",variant:"outline",onClick:z},{default:g(()=>[f(c(H),{class:"w-4 h-4 mr-1"}),t[1]||(t[1]=w(" Calculate Variances ",-1))]),_:1})):y("",!0)])]),i.value.length>0?(n(),o("div",st,[e("div",nt,[t[2]||(t[2]=e("p",{class:"text-xs text-blue-600"},"Total Items",-1)),e("p",ot,l(i.value.length),1)]),e("div",rt,[t[3]||(t[3]=e("p",{class:"text-xs text-green-600"},"No Variance",-1)),e("p",lt,l(F.value),1)]),e("div",it,[t[4]||(t[4]=e("p",{class:"text-xs text-yellow-600"},"With Variance",-1)),e("p",dt,l(I.value),1)]),e("div",ut,[t[5]||(t[5]=e("p",{class:"text-xs text-red-600"},"Material Variance",-1)),e("p",ct,l(S.value),1)])])):y("",!0),i.value.length===0?(n(),o("div",yt,[f(c(L),{class:"w-10 h-10 mx-auto mb-2 text-gray-300"}),t[7]||(t[7]=e("p",{class:"text-sm"},"No count items added",-1)),u.readonly?y("",!0):(n(),x(c(V),{key:0,size:"sm",variant:"ghost",class:"mt-2",onClick:M},{default:g(()=>[...t[6]||(t[6]=[w(" Add First Item ",-1)])]),_:1}))])):(n(),o("div",pt,[e("table",mt,[e("thead",xt,[e("tr",null,[t[8]||(t[8]=e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-8"},"#",-1)),t[9]||(t[9]=e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item Code",-1)),t[10]||(t[10]=e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description",-1)),t[11]||(t[11]=e("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-24"},"System Qty",-1)),t[12]||(t[12]=e("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-24"},"Counted Qty",-1)),t[13]||(t[13]=e("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-24"},"Variance",-1)),t[14]||(t[14]=e("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-20"},"Var %",-1)),t[15]||(t[15]=e("th",{class:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-24"},"Condition",-1)),t[16]||(t[16]=e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Remarks",-1)),u.readonly?y("",!0):(n(),o("th",gt))])]),e("tbody",ft,[(n(!0),o(R,null,P(i.value,(s,d)=>(n(),o("tr",{key:d,class:v(A(s))},[e("td",vt,l(d+1),1),e("td",_t,[u.readonly?(n(),o("span",bt,l(s.item_code),1)):m((n(),o("input",{key:0,type:"text","onUpdate:modelValue":r=>s.item_code=r,class:"w-full px-2 py-1 text-sm border rounded focus:ring-1 focus:ring-blue-500",placeholder:"Item code"},null,8,ht)),[[_,s.item_code]])]),e("td",kt,[u.readonly?(n(),o("span",Vt,l(s.item_description),1)):m((n(),o("input",{key:0,type:"text","onUpdate:modelValue":r=>s.item_description=r,class:"w-full px-2 py-1 text-sm border rounded focus:ring-1 focus:ring-blue-500",placeholder:"Description"},null,8,wt)),[[_,s.item_description]])]),e("td",Ct,[u.readonly?(n(),o("span",It,l(k(s.system_qty)),1)):m((n(),o("input",{key:0,type:"number","onUpdate:modelValue":r=>s.system_qty=r,class:"w-full px-2 py-1 text-sm text-right border rounded focus:ring-1 focus:ring-blue-500",onChange:r=>q(d)},null,40,qt)),[[_,s.system_qty,void 0,{number:!0}]])]),e("td",Nt,[u.readonly?(n(),o("span",Mt,l(k(s.counted_qty)),1)):m((n(),o("input",{key:0,type:"number","onUpdate:modelValue":r=>s.counted_qty=r,class:"w-full px-2 py-1 text-sm text-right border rounded focus:ring-1 focus:ring-blue-500 font-medium",onChange:r=>q(d)},null,40,Ut)),[[_,s.counted_qty,void 0,{number:!0}]])]),e("td",Tt,[e("span",{class:v(["text-sm font-medium",b(s.variance_qty)])},l(k(s.variance_qty)),3)]),e("td",Ft,[e("span",{class:v(["text-sm",b(s.variance_percent)])},l(Q(s.variance_percent)),3),s.is_material?(n(),x(c(W),{key:0,class:"inline w-4 h-4 ml-1 text-red-500",title:"Material Variance"})):y("",!0)]),e("td",St,[u.readonly?s.condition?(n(),x(c(Z),{key:1,variant:B(s.condition),size:"sm"},{default:g(()=>[w(l(s.condition),1)]),_:2},1032,["variant"])):y("",!0):m((n(),o("select",{key:0,"onUpdate:modelValue":r=>s.condition=r,class:"px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500"},[...t[17]||(t[17]=[K('<option value="">-</option><option value="Good">Good</option><option value="Damaged">Damaged</option><option value="Expired">Expired</option><option value="Misplaced">Misplaced</option><option value="Zero Stock">Zero Stock</option><option value="Not Found">Not Found</option>',7)])],8,Dt)),[[G,s.condition]])]),e("td",zt,[u.readonly?(n(),o("span",At,l(s.remarks),1)):m((n(),o("input",{key:0,type:"text","onUpdate:modelValue":r=>s.remarks=r,class:"w-full px-2 py-1 text-sm border rounded focus:ring-1 focus:ring-blue-500",placeholder:"Remarks"},null,8,Et)),[[_,s.remarks]])]),u.readonly?y("",!0):(n(),o("td",Bt,[f(c(V),{size:"sm",variant:"ghost",onClick:r=>D(d)},{default:g(()=>[f(c(J),{class:"w-4 h-4 text-red-500"})]),_:1},8,["onClick"])]))],2))),128))])])])),i.value.length>0?(n(),o("div",Qt,[e("div",null,[t[18]||(t[18]=e("span",{class:"text-gray-500"},"Total Variance Qty:",-1)),e("span",{class:v(["ml-2 font-medium",b(N.value)])},l(k(N.value)),3)]),e("div",null,[t[19]||(t[19]=e("span",{class:"text-gray-500"},"Total Variance Value:",-1)),e("span",{class:v(["ml-2 font-medium",b(U.value)])},l($(U.value)),3)])])):y("",!0)]))}};export{Pt as _};
//# sourceMappingURL=PhysicalCountTable-B26Ly8gS.js.map
