var J=Object.defineProperty;var A=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var F=(v,n,l)=>n in v?J(v,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):v[n]=l,M=(v,n)=>{for(var l in n||(n={}))X.call(n,l)&&F(v,l,n[l]);if(A)for(var l of A(n))Y.call(n,l)&&F(v,l,n[l]);return v};var S=(v,n,l)=>new Promise((y,u)=>{var x=c=>{try{p(l.next(c))}catch(h){u(h)}},w=c=>{try{p(l.throw(c))}catch(h){u(h)}},p=c=>c.done?y(c.value):Promise.resolve(c.value).then(x,w);p((l=l.apply(v,n)).next())});import{ab as Z,r as $,j as _,Q as tt,l as r,p as i,q as e,s as m,u as b,v as d,z as g,ac as P,ao as j,am as et,F as D,x as U,A as o,ah as B,H as f,B as T}from"./vue-DciwFjI_.js";import{p as st,a as C,c as L}from"./index-qIC3Tfxg.js";import{$ as at,N as ot,b5 as lt,o as nt,T as rt,v as it}from"./icons-CtLkBOsu.js";import"./charts-DlPBe6v3.js";import"./utils-Bcd7wHeW.js";const ut={class:"p-6"},dt={class:"flex justify-between items-center mb-6"},ct={class:"flex gap-2"},mt={class:"bg-white rounded-lg border p-4 mb-6"},gt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},pt=["value"],vt={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},ft={class:"bg-white rounded-lg border p-4"},xt={class:"text-2xl font-bold"},_t={class:"bg-white rounded-lg border p-4"},bt={class:"text-2xl font-bold text-yellow-600"},yt={class:"bg-white rounded-lg border p-4"},wt={class:"text-2xl font-bold text-orange-600"},ht={class:"bg-white rounded-lg border p-4"},kt={class:"text-2xl font-bold text-blue-600"},St={class:"bg-white rounded-lg border p-4"},Ct={class:"text-2xl font-bold text-red-600"},Pt={class:"bg-white rounded-lg border shadow-sm"},Tt={key:0,class:"divide-y divide-gray-200"},Vt=["onClick"],It={class:"flex items-start justify-between"},Nt={class:"flex-1"},zt={class:"flex items-center gap-3 mb-2"},At={class:"font-medium text-gray-900"},Ft={class:"text-sm text-gray-600 mb-2"},Mt={class:"flex items-center gap-6 text-sm text-gray-500"},$t={key:0,class:"flex items-center gap-1"},jt={key:1,class:"flex items-center gap-1"},Dt={class:"flex items-center gap-6 mt-3 text-sm"},Ut={class:"text-gray-500"},Bt={key:0,class:"text-orange-600"},Lt={key:1,class:"text-red-600"},Et={key:2,class:"text-red-700 font-medium"},Ot={class:"flex items-center gap-4 mt-3"},Rt={class:"text-right"},qt={key:1,class:"text-sm text-gray-500"},Ht={key:1,class:"p-12 text-center text-gray-500"},Kt={key:2,class:"px-4 py-3 border-t flex items-center justify-between"},Qt={class:"text-sm text-gray-500"},Wt={class:"flex gap-2"},se={__name:"StockTakeSessionList",setup(v){const n=Z(),l=st(),y=$(!1),u=$({status:"",count_type:"",audit_plan:"",warehouse:""}),x=_(()=>l.sessions),w=_(()=>l.sessionsTotalCount),p=_(()=>l.sessionsPage),c=_(()=>l.sessionsPageSize),h=_(()=>Math.ceil(w.value/c.value)),E=_(()=>x.value.filter(a=>a.status==="Completed"&&(!a.team_signoff||!a.supervisor_signoff||!a.auditor_signoff)).length),O=_(()=>x.value.reduce((a,t)=>a+(t.total_items_counted||0),0)),R=_(()=>x.value.reduce((a,t)=>a+(t.items_with_variance||0),0));tt(()=>S(this,null,function*(){yield k()}));function k(){return S(this,null,function*(){y.value=!0;try{const a=M({},u.value);Object.keys(a).forEach(t=>{a[t]||delete a[t]}),yield l.loadSessions(a,p.value,c.value)}finally{y.value=!1}})}function q(){return S(this,null,function*(){u.value={status:"",count_type:"",audit_plan:"",warehouse:""},yield k()})}let V=null;function I(){clearTimeout(V),V=setTimeout(()=>k(),300)}function N(a){return S(this,null,function*(){yield l.loadSessions(u.value,a,c.value)})}function z(){n.push("/inventory-audit/sessions/new")}function H(a){n.push(`/inventory-audit/sessions/${a}`)}function K(a){return{Planned:"blue","In Progress":"yellow",Completed:"green",Cancelled:"red"}[a]||"gray"}function Q(a){return a>=90?"text-green-600":a>=70?"text-yellow-600":"text-red-600"}function W(a){return a?new Date(a).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function G(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(a||0)}return(a,t)=>(i(),r("div",ut,[e("div",dt,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-2xl font-bold"},"Stock Take Sessions"),e("p",{class:"text-gray-600"},"Manage physical count sessions and count teams")],-1)),e("div",ct,[m(d(C),{onClick:q,loading:y.value,variant:"outline",size:"sm"},{default:b(()=>[m(d(at),{class:"w-4 h-4"})]),_:1},8,["loading"]),m(d(C),{onClick:z},{default:b(()=>[m(d(ot),{class:"w-4 h-4 mr-2"}),t[6]||(t[6]=g(" New Session ",-1))]),_:1})])]),e("div",mt,[e("div",gt,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),P(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:k},[...t[8]||(t[8]=[et('<option value="">All Statuses</option><option value="Planned">Planned</option><option value="In Progress">In Progress</option><option value="Completed">Completed</option><option value="Cancelled">Cancelled</option>',5)])],544),[[j,u.value.status]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Count Type",-1)),P(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.value.count_type=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:k},[t[10]||(t[10]=e("option",{value:""},"All Types",-1)),(i(!0),r(D,null,U(d(l).countTypeOptions,s=>(i(),r("option",{key:s.value,value:s.value},o(s.label),9,pt))),128))],544),[[j,u.value.count_type]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Audit Plan",-1)),P(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>u.value.audit_plan=s),type:"text",placeholder:"Filter by plan",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onInput:I},null,544),[[B,u.value.audit_plan]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Warehouse",-1)),P(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>u.value.warehouse=s),type:"text",placeholder:"Filter by warehouse",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onInput:I},null,544),[[B,u.value.warehouse]])])])]),e("div",vt,[e("div",ft,[t[14]||(t[14]=e("p",{class:"text-sm text-gray-500"},"Total Sessions",-1)),e("p",xt,o(w.value),1)]),e("div",_t,[t[15]||(t[15]=e("p",{class:"text-sm text-gray-500"},"In Progress",-1)),e("p",bt,o(x.value.filter(s=>s.status==="In Progress").length),1)]),e("div",yt,[t[16]||(t[16]=e("p",{class:"text-sm text-gray-500"},"Pending Signoff",-1)),e("p",wt,o(E.value),1)]),e("div",ht,[t[17]||(t[17]=e("p",{class:"text-sm text-gray-500"},"Total Items Counted",-1)),e("p",kt,o(O.value),1)]),e("div",St,[t[18]||(t[18]=e("p",{class:"text-sm text-gray-500"},"Items w/ Variance",-1)),e("p",Ct,o(R.value),1)])]),e("div",Pt,[x.value.length>0?(i(),r("div",Tt,[(i(!0),r(D,null,U(x.value,s=>(i(),r("div",{key:s.name,class:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:Gt=>H(s.name)},[e("div",It,[e("div",Nt,[e("div",zt,[e("h4",At,o(s.session_title),1),m(d(L),{variant:K(s.status)},{default:b(()=>[g(o(s.status),1)]),_:2},1032,["variant"]),m(d(L),{variant:"gray"},{default:b(()=>[g(o(s.count_type),1)]),_:2},1024)]),e("p",Ft,o(s.session_id),1),e("div",Mt,[s.warehouse?(i(),r("span",$t,[m(d(lt),{class:"w-4 h-4"}),g(" "+o(s.warehouse),1)])):f("",!0),s.start_datetime?(i(),r("span",jt,[m(d(nt),{class:"w-4 h-4"}),g(" "+o(W(s.start_datetime)),1)])):f("",!0)]),e("div",Dt,[e("span",Ut,[t[19]||(t[19]=g(" Items: ",-1)),e("strong",null,o(s.total_items_counted||0),1)]),s.items_with_variance?(i(),r("span",Bt,[t[20]||(t[20]=g(" Variances: ",-1)),e("strong",null,o(s.items_with_variance),1)])):f("",!0),s.total_variance_value?(i(),r("span",Lt,[t[21]||(t[21]=g(" Value: ",-1)),e("strong",null,o(G(s.total_variance_value)),1)])):f("",!0),s.materiality_breaches?(i(),r("span",Et,[m(d(rt),{class:"w-4 h-4 inline"}),g(" "+o(s.materiality_breaches)+" material ",1)])):f("",!0)]),e("div",Ot,[e("span",{class:T(["text-xs px-2 py-1 rounded-full",s.team_signoff?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"])},o(s.team_signoff?"✓":"○")+" Team ",3),e("span",{class:T(["text-xs px-2 py-1 rounded-full",s.supervisor_signoff?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"])},o(s.supervisor_signoff?"✓":"○")+" Supervisor ",3),e("span",{class:T(["text-xs px-2 py-1 rounded-full",s.auditor_signoff?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"])},o(s.auditor_signoff?"✓":"○")+" Auditor ",3)])]),e("div",Rt,[s.session_compliance_score?(i(),r("p",{key:0,class:T(["text-lg font-bold",Q(s.session_compliance_score)])},o(s.session_compliance_score)+"% ",3)):f("",!0),s.variance_rate?(i(),r("p",qt," Variance: "+o(s.variance_rate)+"% ",1)):f("",!0)])])],8,Vt))),128))])):y.value?f("",!0):(i(),r("div",Ht,[m(d(it),{class:"w-12 h-12 mx-auto mb-3 text-gray-300"}),t[23]||(t[23]=e("p",null,"No stock take sessions found",-1)),m(d(C),{variant:"outline",size:"sm",class:"mt-2",onClick:z},{default:b(()=>[...t[22]||(t[22]=[g(" Start First Session ",-1)])]),_:1})])),h.value>1?(i(),r("div",Kt,[e("p",Qt," Showing "+o((p.value-1)*c.value+1)+" - "+o(Math.min(p.value*c.value,w.value))+" of "+o(w.value),1),e("div",Wt,[m(d(C),{variant:"outline",size:"sm",disabled:p.value===1,onClick:t[4]||(t[4]=s=>N(p.value-1))},{default:b(()=>[...t[24]||(t[24]=[g(" Previous ",-1)])]),_:1},8,["disabled"]),m(d(C),{variant:"outline",size:"sm",disabled:p.value===h.value,onClick:t[5]||(t[5]=s=>N(p.value+1))},{default:b(()=>[...t[25]||(t[25]=[g(" Next ",-1)])]),_:1},8,["disabled"])])])):f("",!0)])]))}};export{se as default};
//# sourceMappingURL=StockTakeSessionList-DV_pjHur.js.map
